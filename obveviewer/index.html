<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OpenBVE Mesh Viewer</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Outfit:wght@400;700&display=swap"
        rel="stylesheet">
    <!-- Load Three.js 0.145.0 (Last version with easy non-module support) -->
    <script src="https://unpkg.com/three@0.145.0/build/three.min.js"></script>
    <script src="https://unpkg.com/three@0.145.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://unpkg.com/three@0.145.0/examples/js/controls/TransformControls.js"></script>
</head>

<body>
    <div id="app">
        <!-- Splash Screen -->
        <div id="splash-screen">
            <div class="splash-content">
                <div class="splash-logo">PROGRESSIVE ADDON</div>
                <div class="splash-title">OpenBVE <span>Viewer</span></div>
                <div class="splash-loader"></div>
            </div>
        </div>

        <canvas id="viewer-canvas"></canvas>

        <div id="ui-overlay">
            <header>
                <h1>OpenBVE <span>Viewer</span></h1>
                <p class="subtitle" data-i18n="subtitle">B3D & CSV 3D Mesh Preview</p>
                <p class="subtitle"> Made with ‚ù§Ô∏è by Progressive Addon</p>
            </header>

            <div class="top-actions">
                <label for="file-input" id="drop-zone">
                    <div class="drop-content">
                        <svg class="icon-upload" width="48" height="48" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                            <polyline points="17 8 12 3 7 8" />
                            <line x1="12" y1="3" x2="12" y2="15" />
                        </svg>
                        <h3 data-i18n="dropTitle">Drop .b3d / .csv files here</h3>
                        <p class="subtitle-small" data-i18n="dropSubtitle">or click to browse files</p>
                    </div>
                </label>

                <div class="actions-container">
                    <label for="folder-input" class="upload-btn secondary" data-tooltip="Load entire folder"
                        data-i18n-tooltip="folderTooltip">
                        <span class="btn-icon">üìÇ</span> <span data-i18n="selectFolder">Select Folder</span>
                    </label>
                </div>
            </div>

            <input type="file" id="file-input" accept=".b3d,.csv,.png,.jpg,.jpeg,.bmp" multiple
                style="position: absolute; opacity: 0; width: 0.1px; height: 0.1px; pointer-events: none;">
            <input type="file" id="folder-input" webkitdirectory directory multiple
                style="position: absolute; opacity: 0; width: 0.1px; height: 0.1px; pointer-events: none;">

            <div id="settings-panel" class="glass-panel hidden">
                <div class="panel-header">
                    <h3>Environment Settings</h3>
                    <button id="close-settings" class="text-btn">√ó</button>
                </div>
                <div class="settings-group">
                    <h4>Directional Light</h4>
                    <div class="settings-row">
                        <label>Azimuth</label>
                        <input type="range" id="light-azimuth" min="0" max="360" value="45">
                    </div>
                    <div class="settings-row">
                        <label>Elevation</label>
                        <input type="range" id="light-elevation" min="0" max="90" value="45">
                    </div>
                    <div class="settings-row">
                        <label>Intensity</label>
                        <input type="range" id="light-intensity" min="0" max="5" step="0.1" value="1.5">
                    </div>
                </div>
                <div class="settings-group">
                    <h4>Rendering</h4>
                    <label class="toggle-switch">
                        <input type="checkbox" id="toggle-shadows" checked>
                        <span class="slider round"></span>
                        <span class="label-text">Shadows</span>
                    </label>
                </div>
            </div>

            <div id="mesh-list" class="glass-panel hidden">
                <button id="toggle-list-btn" class="glass-btn icon-only" aria-label="Toggle Mesh List">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 6h16M4 12h16M4 18h16" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </button>
                <div class="list-container">
                    <div class="list-header">
                        <h3 data-i18n="loadedMeshes">Loaded Meshes</h3>
                        <button id="unload-all" class="text-btn danger" data-i18n="unloadAll">Unload All</button>
                    </div>
                    <div id="mesh-items">
                        <!-- Dynamic mesh items go here -->
                    </div>
                </div>
            </div>

            <div id="loading-overlay" class="hidden">
                <div class="loader"></div>
                <p data-i18n="parsing">Parsing Mesh...</p>
            </div>

            <div id="transform-toolbar" class="glass-panel hidden">
                <h3>Transform Tools</h3>
                <div class="transform-buttons">
                    <button id="translate-btn" class="transform-btn active" title="Move (G)">Move</button>
                    <button id="rotate-btn" class="transform-btn" title="Rotate (R)">Rotate</button>
                    <button id="scale-btn" class="transform-btn" title="Scale (S)">Scale</button>
                </div>
                <div class="transform-toggles">
                    <label class="toggle-switch">
                        <input type="checkbox" id="local-space-toggle">
                        <span class="slider round"></span>
                        <span class="label-text">Local Space</span>
                    </label>
                </div>
                <p class="hint">Click mesh to select ‚Ä¢ ESC to deselect</p>
            </div>

            <div id="debug-box" class="glass-panel hidden">
                <div class="debug-header">
                    <h3>Debug Log</h3>
                    <button id="close-debug" class="text-btn" aria-label="Close Debug">√ó</button>
                </div>
                <div id="debug-log"></div>
            </div>

            <button id="reset-cam" class="glass-btn" data-i18n="resetCamera">Reset Camera</button>

            <!-- Selection Box -->
            <div id="selection-box" class="hidden"></div>

            <!-- Mobile Transform Sliders -->
            <div id="mobile-transform-ui" class="glass-panel hidden">
                <div class="slider-row">
                    <span class="axis-label x-axis">X</span>
                    <input type="range" id="slider-x" min="-50" max="50" value="0" step="0.1">
                </div>
                <div class="slider-row">
                    <span class="axis-label y-axis">Y</span>
                    <input type="range" id="slider-y" min="-50" max="50" value="0" step="0.1">
                </div>
                <div class="slider-row">
                    <span class="axis-label z-axis">Z</span>
                    <input type="range" id="slider-z" min="-50" max="50" value="0" step="0.1">
                </div>
                <p class="hint-mobile">Drag sliders to adjust</p>
            </div>

            <div id="info-modal" class="glass-panel hidden">
                <h3>Texture Import Info</h3>
                <p>Textures must be imported manually along with mesh files.</p>
                <p><strong>Tip:</strong> Use the "Select Folder" button to import all files (mesh + textures) at once
                    automatically.</p>
                <button id="close-info" class="upload-btn primary" style="margin-top: 1rem;">Got it</button>
            </div>
        </div>

        <div id="top-bar">
            <span id="app-version">v1.0.1 alpha</span>
            <div id="camera-coords">Cam: 0, 5, 5</div>
            <div id="object-coords" class="hidden">Obj: 0, 0, 0</div>
        </div>

        <!-- Floating Tool Stack (Center Right) -->
        <div class="tool-stack">
            <button id="toggle-debug-btn" class="glass-btn icon-only" title="Toggle Debug Log">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="2" y="3" width="20" height="18" rx="2" />
                    <path d="M7 8h10M7 12h10M7 16h6" />
                </svg>
            </button>

            <button id="info-btn" class="glass-btn icon-only" aria-label="Info">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10" />
                    <line x1="12" y1="16" x2="12" y2="12" />
                    <line x1="12" y1="8" x2="12.01" y2="8" />
                </svg>
            </button>

            <button id="box-select-btn" class="glass-btn icon-only" title="Box Selection Mode (B)"
                aria-label="Box Select">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" stroke-dasharray="4 2" />
                    <line x1="12" y1="8" x2="12" y2="16" />
                    <line x1="8" y1="12" x2="16" y2="12" />
                </svg>
            </button>

            <button id="mobile-transform-btn" class="glass-btn icon-only" title="Toggle Transform Mode">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M5 9l-3 3 3 3M9 5l3-3 3 3M15 19l3-3-3-3M19 9l3 3-3 3" />
                    <circle cx="12" cy="12" r="3" />
                </svg>
            </button>

            <button id="settings-btn" class="glass-btn icon-only" title="Settings">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path
                        d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                    <circle cx="12" cy="12" r="3" />
                </svg>
            </button>

            <button id="camera-toggle-btn" class="glass-btn icon-only" title="Toggle Perspective/Ortho">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z" />
                    <circle cx="12" cy="13" r="4" />
                </svg>
            </button>
        </div>


        <div id="view-gizmo-container"></div>
    </div>

    <script>
        (function () {
            var s = document.createElement('style');
            s.innerHTML = atob("OnJvb3R7LS1iZy1jb2xvcjojMGQwZjE0Oy0tYWNjZW50LWNvbG9yOiMzYjgyZjY7LS1hY2NlbnQtZ2xvdzpyZ2JhKDU5LCAxMzAsIDI0NiwgMC41KTstLXRleHQtcHJpbWFyeTojZjhmYWZjOy0tdGV4dC1zZWNvbmRhcnk6Izk0YTNiODstLWdsYXNzLWJnOnJnYmEoMjMsIDI4LCA0MSwgMC43NSk7LS1nbGFzcy1ib3JkZXI6cmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpOy0tcGFuZWwtcmFkaXVzOjE2cHh9KnttYXJnaW46MDtwYWRkaW5nOjA7Ym94LXNpemluZzpib3JkZXItYm94Oy13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvcjp0cmFuc3BhcmVudH1ib2R5e2ZvbnQtZmFtaWx5OidJbnRlcicsIHNhbnMtc2VyaWY7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1iZy1jb2xvcik7Y29sb3I6dmFyKC0tdGV4dC1wcmltYXJ5KTtvdmVyZmxvdzpoaWRkZW47aGVpZ2h0OjEwMHZoO3dpZHRoOjEwMHZ3fSNhcHB7cG9zaXRpb246cmVsYXRpdmU7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJX0jdmlld2VyLWNhbnZhc3twb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTt6LWluZGV4OjF9I3VpLW92ZXJsYXl7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7cG9pbnRlci1ldmVudHM6bm9uZTt6LWluZGV4OjEwO3BhZGRpbmc6MnJlbTtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2dhcDoycmVtO3RyYW5zaXRpb246YWxsIDAuNXMgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKX0jdWktb3ZlcmxheS5sb2FkZWR7YWxpZ24taXRlbXM6ZmxleC1zdGFydDtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1zdGFydH1AbWVkaWEgKG1heC13aWR0aDo3NjhweCl7I3VpLW92ZXJsYXkubG9hZGVkIGhlYWRlciAuc3VidGl0bGV7ZGlzcGxheTpub25lfSN1aS1vdmVybGF5LmxvYWRlZCBoZWFkZXJ7dGV4dC1hbGlnbjpsZWZ0O21hcmdpbi1sZWZ0OjA7d2lkdGg6MTAwJTtwYWRkaW5nLWxlZnQ6MC41cmVtfSN1aS1vdmVybGF5LmxvYWRlZCBoZWFkZXIgaDF7bWFyZ2luLWxlZnQ6MH19QG1lZGlhIChtaW4td2lkdGg6NzY5cHgpeyN1aS1vdmVybGF5LmxvYWRlZCAudG9wLWFjdGlvbnN7cG9zaXRpb246YWJzb2x1dGU7bGVmdDoycmVtO3RvcDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTUwJSk7d2lkdGg6YXV0bzthbGlnbi1pdGVtczpmbGV4LXN0YXJ0O3otaW5kZXg6MjB9I3VpLW92ZXJsYXkubG9hZGVkIGhlYWRlcntwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MnJlbTtsZWZ0OjJyZW07dGV4dC1hbGlnbjpsZWZ0fX1oZWFkZXJ7cG9pbnRlci1ldmVudHM6YXV0bzt0ZXh0LWFsaWduOmNlbnRlcn1oZWFkZXIgaDF7Zm9udC1mYW1pbHk6J091dGZpdCcsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjEuOHJlbTtmb250LXdlaWdodDo3MDA7bWFyZ2luLWJvdHRvbTowLjFyZW07bGV0dGVyLXNwYWNpbmc6LTFweH1AbWVkaWEgKG1heC13aWR0aDo3NjhweCl7aGVhZGVyIGgxe2ZvbnQtc2l6ZToxLjRyZW19aGVhZGVyIHAuc3VidGl0bGV7Zm9udC1zaXplOjAuNjVyZW07b3BhY2l0eTowLjh9aGVhZGVye3RleHQtYWxpZ246Y2VudGVyO3dpZHRoOjEwMCU7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjthbGlnbi1pdGVtczpjZW50ZXJ9fWhlYWRlciBoMSBzcGFue2NvbG9yOnZhcigtLWFjY2VudC1jb2xvcik7dGV4dC1zaGFkb3c6MCAwIDIwcHggdmFyKC0tYWNjZW50LWdsb3cpfS5zdWJ0aXRsZXtjb2xvcjp2YXIoLS10ZXh0LXNlY29uZGFyeSk7Zm9udC1zaXplOjAuOXJlbTt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bGV0dGVyLXNwYWNpbmc6MnB4fS5nbGFzcy1wYW5lbHtwb2ludGVyLWV2ZW50czphdXRvO2JhY2tncm91bmQ6dmFyKC0tZ2xhc3MtYmcpO2JhY2tkcm9wLWZpbHRlcjpibHVyKDE2cHgpOy13ZWJraXQtYmFja2Ryb3AtZmlsdGVyOmJsdXIoMTZweCk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpO2JvcmRlci1yYWRpdXM6dmFyKC0tcGFuZWwtcmFkaXVzKTtwYWRkaW5nOjJyZW07Ym94LXNoYWRvdzowIDEycHggNDhweCByZ2JhKDAsIDAsIDAsIDAuNSk7dHJhbnNpdGlvbjphbGwgMC4zcyBjdWJpYy1iZXppZXIoMC40LCAwLCAwLjIsIDEpfS5nbGFzcy1idG57YXBwZWFyYW5jZTpub25lO2JvcmRlcjpub25lO2JhY2tncm91bmQ6dmFyKC0tZ2xhc3MtYmcpO2JhY2tkcm9wLWZpbHRlcjpibHVyKDE2cHgpOy13ZWJraXQtYmFja2Ryb3AtZmlsdGVyOmJsdXIoMTZweCk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpO2NvbG9yOnZhcigtLXRleHQtcHJpbWFyeSk7cGFkZGluZzoxMHB4IDIwcHg7Ym9yZGVyLXJhZGl1czoxMnB4O2ZvbnQtd2VpZ2h0OjYwMDtjdXJzb3I6cG9pbnRlcjtwb2ludGVyLWV2ZW50czphdXRvICFpbXBvcnRhbnQ7ei1pbmRleDoxMDA7dHJhbnNpdGlvbjphbGwgMC4zcyBlYXNlO2Rpc3BsYXk6aW5saW5lLWZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7Z2FwOjAuNXJlbTtmb250LXNpemU6MC45cmVtfS5nbGFzcy1idG46aG92ZXJ7YmFja2dyb3VuZDpyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7Ym9yZGVyLWNvbG9yOnJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMnB4KTtib3gtc2hhZG93OjAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjIpfS5nbGFzcy1idG4uaWNvbi1vbmx5e3BhZGRpbmc6MDt3aWR0aDo0NHB4O2hlaWdodDo0NHB4O2JvcmRlci1yYWRpdXM6NTAlfSN0b2dnbGUtbGlzdC1idG57ZGlzcGxheTpub25lfS50b3AtYWN0aW9uc3tkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6MS41cmVtO3dpZHRoOjEwMCV9I2Ryb3Atem9uZXt3aWR0aDozMjBweDtoZWlnaHQ6YXV0bzttaW4taGVpZ2h0OjE4MHB4O2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt0ZXh0LWFsaWduOmNlbnRlcjtjdXJzb3I6cG9pbnRlcjtib3JkZXI6MnB4IGRhc2hlZCB2YXIoLS1nbGFzcy1ib3JkZXIpO3RyYW5zaXRpb246YWxsIDAuM3MgZWFzZTtwYWRkaW5nOjJyZW07cG9pbnRlci1ldmVudHM6YXV0byAhaW1wb3J0YW50fSN1aS1vdmVybGF5LmxvYWRlZCAjZHJvcC16b25le3dpZHRoOjIwMHB4O2hlaWdodDo4MHB4O21pbi1oZWlnaHQ6MDtwYWRkaW5nOjAuNXJlbX0jdWktb3ZlcmxheS5sb2FkZWQgI2Ryb3Atem9uZSAuaWNvbi11cGxvYWQsICN1aS1vdmVybGF5LmxvYWRlZCAjZHJvcC16b25lIGgzLCAjdWktb3ZlcmxheS5sb2FkZWQgI2Ryb3Atem9uZSAuc3VidGl0bGUtc21hbGx7ZGlzcGxheTpub25lfSN1aS1vdmVybGF5LmxvYWRlZCAjZHJvcC16b25lOjphZnRlcntjb250ZW50OnZhcigtLXRleHQtbG9hZC1tb3JlLCAiTG9hZCBNb3JlIEZpbGVzIik7Zm9udC1zaXplOjAuOHJlbTtmb250LXdlaWdodDo2MDA7Y29sb3I6dmFyKC0tYWNjZW50LWNvbG9yKX0uc3VidGl0bGUtc21hbGx7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpO2ZvbnQtc2l6ZTowLjhyZW07bWFyZ2luLXRvcDowLjVyZW07b3BhY2l0eTowLjd9LmV4dGVybmFsLWFjdGlvbnN7cG9pbnRlci1ldmVudHM6YXV0bzt3aWR0aDozMjBweDtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmNlbnRlcn0jdWktb3ZlcmxheS5sb2FkZWQgLmV4dGVybmFsLWFjdGlvbnN7ZGlzcGxheTpub25lfSN1aS1vdmVybGF5LmxvYWRlZCAjZHJvcC16b25lIC5kcm9wLWNvbnRlbnQgc3Zne3dpZHRoOjI0cHg7aGVpZ2h0OjI0cHh9I3VpLW92ZXJsYXkubG9hZGVkICNkcm9wLXpvbmUgLmRyb3AtY29udGVudCBwe2ZvbnQtc2l6ZTowLjhyZW19I3VpLW92ZXJsYXkubG9hZGVkICNkcm9wLXpvbmUgLmRyb3AtY29udGVudCBzbWFsbHtkaXNwbGF5Om5vbmV9I2Ryb3Atem9uZTpob3ZlciwgI2Ryb3Atem9uZS5kcmFnb3Zlcntib3JkZXItY29sb3I6dmFyKC0tYWNjZW50LWNvbG9yKTtiYWNrZ3JvdW5kOnJnYmEoNTksIDEzMCwgMjQ2LCAwLjEpfS5kcm9wLWNvbnRlbnR7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjAuNzVyZW07cG9pbnRlci1ldmVudHM6bm9uZX0uZHJvcC1jb250ZW50IHN2Z3tjb2xvcjp2YXIoLS10ZXh0LXNlY29uZGFyeSk7dHJhbnNpdGlvbjpjb2xvciAwLjNzIGVhc2V9I2Ryb3Atem9uZTpob3ZlciBzdmd7Y29sb3I6dmFyKC0tYWNjZW50LWNvbG9yKX0uZHJvcC1jb250ZW50IHB7Zm9udC13ZWlnaHQ6NjAwfS5kcm9wLWNvbnRlbnQgc21hbGx7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpfSNtZXNoLWxpc3R7d2lkdGg6MzIwcHg7bWF4LWhlaWdodDo0MDBweDtvdmVyZmxvdy15OmF1dG87ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtnYXA6MXJlbTtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MTUwcHg7cmlnaHQ6MnJlbX0jbWVzaC1pdGVtc3ttYXgtaGVpZ2h0OjMwMHB4O292ZXJmbG93LXk6YXV0bztkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDowLjhyZW07cGFkZGluZy1yaWdodDowLjVyZW19I21lc2gtaXRlbXM6Oi13ZWJraXQtc2Nyb2xsYmFye3dpZHRoOjZweH0jbWVzaC1pdGVtczo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2t7YmFja2dyb3VuZDpyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDUpO2JvcmRlci1yYWRpdXM6M3B4fSNtZXNoLWl0ZW1zOjotd2Via2l0LXNjcm9sbGJhci10aHVtYntiYWNrZ3JvdW5kOnJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTtib3JkZXItcmFkaXVzOjNweH0jbWVzaC1pdGVtczo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXJ7YmFja2dyb3VuZDpyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMyl9LnRleHQtYnRue2JhY2tncm91bmQ6bm9uZTtib3JkZXI6bm9uZTtmb250LXNpemU6MC43NXJlbTtmb250LXdlaWdodDo2MDA7Y3Vyc29yOnBvaW50ZXI7dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlO2xldHRlci1zcGFjaW5nOjAuNXB4O3BhZGRpbmc6NHB4IDhweDtib3JkZXItcmFkaXVzOjRweDtwb2ludGVyLWV2ZW50czphdXRvICFpbXBvcnRhbnQ7dHJhbnNpdGlvbjphbGwgMC4yc30udGV4dC1idG4uZGFuZ2Vye2NvbG9yOiNmODcxNzE7YmFja2dyb3VuZDpyZ2JhKDIzOSwgNjgsIDY4LCAwLjEpfS50ZXh0LWJ0bi5kYW5nZXI6aG92ZXJ7YmFja2dyb3VuZDpyZ2JhKDIzOSwgNjgsIDY4LCAwLjIpfS5saXN0LWhlYWRlcntib3JkZXItYm90dG9tOjFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpO3BhZGRpbmctYm90dG9tOjAuNXJlbTtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyfS5saXN0LWhlYWRlciBoM3tmb250LXNpemU6MC45cmVtO3RleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTtsZXR0ZXItc3BhY2luZzoxcHg7Y29sb3I6dmFyKC0tYWNjZW50LWNvbG9yKX0ubWVzaC1pdGVte2JhY2tncm91bmQ6cmdiYSgyNTUsIDI1NSwgMjU1LCAwLjAzKTtib3JkZXItcmFkaXVzOjhweDtwYWRkaW5nOjAuNzVyZW07ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtnYXA6MC41cmVtO3Bvc2l0aW9uOnJlbGF0aXZlO2JvcmRlcjoxcHggc29saWQgdHJhbnNwYXJlbnQ7dHJhbnNpdGlvbjpib3JkZXItY29sb3IgMC4zcyBlYXNlfS5tZXNoLWl0ZW06aG92ZXJ7Ym9yZGVyLWNvbG9yOnJnYmEoNTksIDEzMCwgMjQ2LCAwLjMpfS5tZXNoLWl0ZW0taGVhZGVye2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjthbGlnbi1pdGVtczpjZW50ZXJ9Lm1lc2gtaXRlbS1uYW1le2ZvbnQtd2VpZ2h0OjYwMDtmb250LXNpemU6MC44NXJlbTt3aGl0ZS1zcGFjZTpub3dyYXA7b3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7bWF4LXdpZHRoOjIwMHB4fS5tZXNoLWNvbnRyb2xze2Rpc3BsYXk6ZmxleDtnYXA6MC41cmVtO21hcmdpbi10b3A6MC4yNXJlbX0ubWVzaC1jb250cm9scyAudGV4dC1idG57cGFkZGluZzoycHggOHB4O2ZvbnQtc2l6ZTowLjY1cmVtO2JhY2tncm91bmQ6cmdiYSg1OSwgMTMwLCAyNDYsIDAuMSk7Y29sb3I6IzYwYTVmYTtib3JkZXI6MXB4IHNvbGlkIHJnYmEoNTksIDEzMCwgMjQ2LCAwLjIpfS5tZXNoLWNvbnRyb2xzIC50ZXh0LWJ0bjpob3ZlcntiYWNrZ3JvdW5kOnJnYmEoNTksIDEzMCwgMjQ2LCAwLjIpO2JvcmRlci1jb2xvcjpyZ2JhKDU5LCAxMzAsIDI0NiwgMC40KX0ubWVzaC1pdGVtLXN0YXRze2Rpc3BsYXk6ZmxleDtnYXA6MXJlbTtmb250LXNpemU6MC43cmVtO2NvbG9yOnZhcigtLXRleHQtc2Vjb25kYXJ5KX0jbG9hZGluZy1vdmVybGF5e3Bvc2l0aW9uOmZpeGVkO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2JhY2tncm91bmQ6cmdiYSgxMywgMTUsIDIwLCAwLjgpO3otaW5kZXg6MTAwO2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7Z2FwOjEuNXJlbTtwb2ludGVyLWV2ZW50czphdXRvfS5sb2FkZXJ7d2lkdGg6NDhweDtoZWlnaHQ6NDhweDtib3JkZXI6M3B4IHNvbGlkIHZhcigtLWFjY2VudC1jb2xvcik7Ym9yZGVyLWJvdHRvbS1jb2xvcjp0cmFuc3BhcmVudDtib3JkZXItcmFkaXVzOjUwJTthbmltYXRpb246cm90YXRpb24gMXMgbGluZWFyIGluZmluaXRlfUBrZXlmcmFtZXMgcm90YXRpb257MCV7dHJhbnNmb3JtOnJvdGF0ZSgwZGVnKX0xMDAle3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKX19I21vYmlsZS1jb250cm9sc3twb3NpdGlvbjphYnNvbHV0ZTtib3R0b206MnJlbTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTt6LWluZGV4OjIwO2Rpc3BsYXk6bm9uZTtnYXA6MXJlbX1AbWVkaWEgKG1heC13aWR0aDo3NjhweCl7I21vYmlsZS1jb250cm9sc3tkaXNwbGF5OmZsZXh9I2Ryb3Atem9uZXt3aWR0aDoyODBweDttaW4taGVpZ2h0OjIwMHB4fSNkcm9wLXpvbmV7cG9zaXRpb246c3RhdGljICFpbXBvcnRhbnQ7d2lkdGg6MTAwJSAhaW1wb3J0YW50O2hlaWdodDo0OHB4ICFpbXBvcnRhbnQ7bWluLWhlaWdodDp1bnNldCAhaW1wb3J0YW50O21hcmdpbjowICFpbXBvcnRhbnQ7cGFkZGluZzowIDEycHggIWltcG9ydGFudDtkaXNwbGF5OmZsZXggIWltcG9ydGFudDthbGlnbi1pdGVtczpjZW50ZXIgIWltcG9ydGFudDtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyICFpbXBvcnRhbnQ7YmFja2dyb3VuZDp2YXIoLS1nbGFzcy1iZykgIWltcG9ydGFudDtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcikgIWltcG9ydGFudDtib3JkZXItcmFkaXVzOjEycHggIWltcG9ydGFudDt0cmFuc2Zvcm06bm9uZSAhaW1wb3J0YW50O2ZsZXg6bm9uZSAhaW1wb3J0YW50fSNkcm9wLXpvbmUgLmRyb3AtY29udGVudHtmbGV4LWRpcmVjdGlvbjpyb3cgIWltcG9ydGFudDtnYXA6OHB4ICFpbXBvcnRhbnR9I2Ryb3Atem9uZSAuaWNvbi11cGxvYWQsICNkcm9wLXpvbmUgaDMsICNkcm9wLXpvbmUgcHtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH0jZHJvcC16b25lOjphZnRlcntjb250ZW50OiJMb2FkIEZpbGUiO2ZvbnQtc2l6ZTowLjlyZW07Zm9udC13ZWlnaHQ6NjAwO2NvbG9yOnZhcigtLXRleHQtcHJpbWFyeSl9I2Ryb3Atem9uZSAuYnRuLWljb257ZGlzcGxheTpibG9jayAhaW1wb3J0YW50O2ZvbnQtc2l6ZToxLjFyZW0gIWltcG9ydGFudH0udXBsb2FkLWJ0bnt3aWR0aDoxMDAlICFpbXBvcnRhbnQ7aGVpZ2h0OjQ4cHggIWltcG9ydGFudDtwYWRkaW5nOjAgMTJweCAhaW1wb3J0YW50O2ZvbnQtc2l6ZTowLjlyZW0gIWltcG9ydGFudDt3aGl0ZS1zcGFjZTpub3dyYXAgIWltcG9ydGFudDtib3JkZXItcmFkaXVzOjEycHggIWltcG9ydGFudDtmbGV4Om5vbmUgIWltcG9ydGFudH0uYWN0aW9ucy1jb250YWluZXJ7d2lkdGg6MTAwJSAhaW1wb3J0YW50O21hcmdpbi10b3A6MC41cmVtICFpbXBvcnRhbnQ7ZGlzcGxheTpmbGV4ICFpbXBvcnRhbnQ7ZmxleC1kaXJlY3Rpb246Y29sdW1uICFpbXBvcnRhbnQ7Z2FwOjAuOHJlbSAhaW1wb3J0YW50O2FsaWduLWl0ZW1zOmNlbnRlciAhaW1wb3J0YW50O2p1c3RpZnktY29udGVudDpjZW50ZXIgIWltcG9ydGFudH0udG9wLWFjdGlvbnN7ZmxleC1kaXJlY3Rpb246Y29sdW1uICFpbXBvcnRhbnQ7d2lkdGg6MTAwJSAhaW1wb3J0YW50O2FsaWduLWl0ZW1zOmNlbnRlciAhaW1wb3J0YW50fSN1aS1vdmVybGF5LmxvYWRlZCAudG9wLWFjdGlvbnN7ZmxleC1kaXJlY3Rpb246cm93ICFpbXBvcnRhbnQ7anVzdGlmeS1jb250ZW50OmZsZXgtc3RhcnQgIWltcG9ydGFudDtnYXA6MC41cmVtICFpbXBvcnRhbnQ7d2lkdGg6YXV0byAhaW1wb3J0YW50O21hcmdpbi10b3A6MCAhaW1wb3J0YW50fSN1aS1vdmVybGF5LmxvYWRlZCAuYWN0aW9ucy1jb250YWluZXJ7d2lkdGg6YXV0byAhaW1wb3J0YW50O2ZsZXgtZGlyZWN0aW9uOnJvdyAhaW1wb3J0YW50O21hcmdpbi10b3A6MCAhaW1wb3J0YW50O2dhcDowICFpbXBvcnRhbnR9I3VpLW92ZXJsYXkubG9hZGVkICNkcm9wLXpvbmV7d2lkdGg6NDRweCAhaW1wb3J0YW50O2hlaWdodDo0NHB4ICFpbXBvcnRhbnQ7cGFkZGluZzowICFpbXBvcnRhbnQ7Ym9yZGVyLXJhZGl1czoxMnB4ICFpbXBvcnRhbnR9I3VpLW92ZXJsYXkubG9hZGVkICNkcm9wLXpvbmU6OmFmdGVye2NvbnRlbnQ6IisiICFpbXBvcnRhbnQ7Zm9udC1zaXplOjEuNXJlbSAhaW1wb3J0YW50O2ZvbnQtd2VpZ2h0OjQwMCAhaW1wb3J0YW50fSN1aS1vdmVybGF5LmxvYWRlZCAjZHJvcC16b25lIC5idG4taWNvbntkaXNwbGF5Om5vbmUgIWltcG9ydGFudH0jdWktb3ZlcmxheS5sb2FkZWQgLnVwbG9hZC1idG57d2lkdGg6NDRweCAhaW1wb3J0YW50O2hlaWdodDo0NHB4ICFpbXBvcnRhbnQ7cGFkZGluZzowICFpbXBvcnRhbnQ7Ym9yZGVyLXJhZGl1czoxMnB4ICFpbXBvcnRhbnQ7anVzdGlmeS1jb250ZW50OmNlbnRlciAhaW1wb3J0YW50fSN1aS1vdmVybGF5LmxvYWRlZCAudXBsb2FkLWJ0biBzcGFuW2RhdGEtaTE4bj0ic2VsZWN0Rm9sZGVyIl17ZGlzcGxheTpub25lICFpbXBvcnRhbnR9I3VpLW92ZXJsYXkubG9hZGVkIC51cGxvYWQtYnRuIC5idG4taWNvbnttYXJnaW46MCAhaW1wb3J0YW50O2ZvbnQtc2l6ZToxLjJyZW0gIWltcG9ydGFudH0jdWktb3ZlcmxheS5sb2FkZWQgI2Ryb3Atem9uZXtwb3NpdGlvbjpzdGF0aWMgIWltcG9ydGFudDt0b3A6YXV0byAhaW1wb3J0YW50O2xlZnQ6YXV0byAhaW1wb3J0YW50fSNkcm9wLXpvbmUgLmRyb3AtY29udGVudHtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDowLjVyZW19I2Ryb3Atem9uZSAuYnRuLWljb257Zm9udC1zaXplOjEuMnJlbX0jZHJvcC16b25lIGgzLCAjZHJvcC16b25lIHB7ZGlzcGxheTpub25lfS5leHRlcm5hbC1hY3Rpb25ze2Rpc3BsYXk6bm9uZX0jbWVzaC1saXN0e3Bvc2l0aW9uOmZpeGVkO3RvcDoycmVtO3JpZ2h0OjFyZW07d2lkdGg6YXV0bzttYXgtd2lkdGg6OTB2dzttYXgtaGVpZ2h0Ojgwdmg7ei1pbmRleDo1MDtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50O2JvcmRlcjpub25lO2JhY2tkcm9wLWZpbHRlcjpub25lO2JveC1zaGFkb3c6bm9uZTtwYWRkaW5nOjA7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjthbGlnbi1pdGVtczpmbGV4LWVuZH0jdG9nZ2xlLWxpc3QtYnRue2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt3aWR0aDo0NHB4O2hlaWdodDo0NHB4O2JvcmRlci1yYWRpdXM6NTAlO2JhY2tncm91bmQ6dmFyKC0tZ2xhc3MtYmcpO2JhY2tkcm9wLWZpbHRlcjpibHVyKDEycHgpO2JvcmRlcjoxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTtjb2xvcjp2YXIoLS10ZXh0LXByaW1hcnkpO2N1cnNvcjpwb2ludGVyO3otaW5kZXg6NTE7dHJhbnNpdGlvbjphbGwgMC4ycyBlYXNlfSN0b2dnbGUtbGlzdC1idG46aG92ZXJ7YmFja2dyb3VuZDpyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSl9Lmxpc3QtY29udGFpbmVye2Rpc3BsYXk6bm9uZTttYXJnaW4tdG9wOjFyZW07YmFja2dyb3VuZDp2YXIoLS1nbGFzcy1iZyk7YmFja2Ryb3AtZmlsdGVyOmJsdXIoMTJweCk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1nbGFzcy1ib3JkZXIpO2JvcmRlci1yYWRpdXM6MTJweDtwYWRkaW5nOjFyZW07d2lkdGg6MjYwcHg7Ym94LXNoYWRvdzowIDhweCAzMnB4IHJnYmEoMCwgMCwgMCwgMC4zKTtmbGV4LWRpcmVjdGlvbjpjb2x1bW59I21lc2gtbGlzdC5leHBhbmRlZCAubGlzdC1jb250YWluZXJ7ZGlzcGxheTpmbGV4O2FuaW1hdGlvbjpzbGlkZUluIDAuMnMgZWFzZS1vdXR9I21lc2gtbGlzdC5leHBhbmRlZCAjdG9nZ2xlLWxpc3QtYnRue2JhY2tncm91bmQ6dmFyKC0tYWNjZW50LWNvbG9yKTtib3JkZXItY29sb3I6dmFyKC0tYWNjZW50LWNvbG9yKTtjb2xvcjp3aGl0ZX1Aa2V5ZnJhbWVzIHNsaWRlSW57ZnJvbXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpfXRve29wYWNpdHk6MTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgwKX19fS5sb2ctZW50cnl7cGFkZGluZzoycHggMDtib3JkZXItYm90dG9tOjFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDUpfS5sb2ctZXJyb3J7Y29sb3I6I2Y4NzE3MX0ubG9nLWluZm97Y29sb3I6IzYwYTVmYX0uaGlkZGVue2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fUBtZWRpYSAobWF4LXdpZHRoOjc2OHB4KXsjdWktb3ZlcmxheXtwYWRkaW5nOjEuNXJlbTtnYXA6MXJlbX1oZWFkZXIgaDF7Zm9udC1zaXplOjEuOHJlbX0jZHJvcC16b25lLCAjaW5mby1wYW5lbHt3aWR0aDoxMDAlfSNkcm9wLXpvbmV7aGVpZ2h0OjE0MHB4fS5zdWJ0aXRsZXtmb250LXNpemU6MC43cmVtfX1bZGF0YS10b29sdGlwXXtwb3NpdGlvbjpyZWxhdGl2ZX1bZGF0YS10b29sdGlwXTpob3Zlcjo6YWZ0ZXJ7Y29udGVudDphdHRyKGRhdGEtdG9vbHRpcCk7cG9zaXRpb246YWJzb2x1dGU7Ym90dG9tOjEyMCU7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7YmFja2dyb3VuZDpyZ2JhKDEzLCAxNSwgMjAsIDAuOTUpO2JvcmRlcjoxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpO2NvbG9yOnZhcigtLXRleHQtcHJpbWFyeSk7cGFkZGluZzo2cHggMTJweDtib3JkZXItcmFkaXVzOjhweDtmb250LXNpemU6MC44NXJlbTt3aGl0ZS1zcGFjZTpub3dyYXA7YmFja2Ryb3AtZmlsdGVyOmJsdXIoOHB4KTtib3gtc2hhZG93OjAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjQpO3BvaW50ZXItZXZlbnRzOm5vbmU7b3BhY2l0eTowO2FuaW1hdGlvbjp0b29sdGlwRmFkZSAwLjJzIGZvcndhcmRzO3otaW5kZXg6MTAwMH1Aa2V5ZnJhbWVzIHRvb2x0aXBGYWRle3Rve29wYWNpdHk6MTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKSB0cmFuc2xhdGVZKC01cHgpfX0uYWN0aW9ucy1jb250YWluZXJ7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtnYXA6MC44cmVtO3dpZHRoOjEwMCU7bWF4LXdpZHRoOjMyMHB4O21hcmdpbi10b3A6MXJlbX0udXBsb2FkLWJ0bntkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7Z2FwOjAuNnJlbTtwYWRkaW5nOjEycHggMjBweDtiYWNrZ3JvdW5kOnZhcigtLWFjY2VudC1jb2xvcik7Y29sb3I6d2hpdGU7Ym9yZGVyOjFweCBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItcmFkaXVzOjEycHg7Y3Vyc29yOnBvaW50ZXI7Zm9udC13ZWlnaHQ6NjAwO3RleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTtmb250LXNpemU6MC45cmVtO2xldHRlci1zcGFjaW5nOjAuNXB4O3BvaW50ZXItZXZlbnRzOmF1dG8gIWltcG9ydGFudDt6LWluZGV4OjEwMDt0cmFuc2l0aW9uOmFsbCAwLjI1cyBjdWJpYy1iZXppZXIoMC4xOSwgMSwgMC4yMiwgMSk7d2lkdGg6MTAwJTtwb3NpdGlvbjpyZWxhdGl2ZTtvdmVyZmxvdzpoaWRkZW59LnVwbG9hZC1idG4ucHJpbWFyeXtiYWNrZ3JvdW5kOnZhcigtLWFjY2VudC1jb2xvcik7Ym94LXNoYWRvdzowIDRweCAxNXB4IHZhcigtLWFjY2VudC1nbG93KX0udXBsb2FkLWJ0bi5zZWNvbmRhcnl7YmFja2dyb3VuZDpyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDMpO2JvcmRlcjoxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpO2NvbG9yOnZhcigtLXRleHQtc2Vjb25kYXJ5KX0udXBsb2FkLWJ0bjpob3Zlcnt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMnB4KTtjb2xvcjp3aGl0ZX0udXBsb2FkLWJ0bi5wcmltYXJ5OmhvdmVye2JveC1zaGFkb3c6MCA4cHggMjVweCB2YXIoLS1hY2NlbnQtZ2xvdyk7ZmlsdGVyOmJyaWdodG5lc3MoMS4xKX0udXBsb2FkLWJ0bi5zZWNvbmRhcnk6aG92ZXJ7Ym9yZGVyLWNvbG9yOnZhcigtLWFjY2VudC1jb2xvcik7YmFja2dyb3VuZDpyZ2JhKDU5LCAxMzAsIDI0NiwgMC4xKTtib3gtc2hhZG93OjAgNHB4IDE1cHggcmdiYSg1OSwgMTMwLCAyNDYsIDAuMil9LmJ0bi1pY29ue2ZvbnQtc2l6ZToxLjFyZW19I3Jlc2V0LWNhbXtwb3NpdGlvbjphYnNvbHV0ZTtib3R0b206MnJlbTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTt6LWluZGV4OjIwO3BvaW50ZXItZXZlbnRzOmF1dG99QG1lZGlhIChtYXgtd2lkdGg6NzY4cHgpeyNyZXNldC1jYW17Ym90dG9tOjVyZW19fSNpbmZvLWJ0bntwb2ludGVyLWV2ZW50czphdXRvO2N1cnNvcjpwb2ludGVyfSNib3gtc2VsZWN0LWJ0bntwb2ludGVyLWV2ZW50czphdXRvO2N1cnNvcjpwb2ludGVyO3RyYW5zaXRpb246YWxsIDAuM3MgY3ViaWMtYmV6aWVyKDAuMTc1LCAwLjg4NSwgMC4zMiwgMS4yNzUpfSNib3gtc2VsZWN0LWJ0bi5hY3RpdmV7YmFja2dyb3VuZDp2YXIoLS1hY2NlbnQtY29sb3IpO2JvcmRlci1jb2xvcjp2YXIoLS1hY2NlbnQtY29sb3IpO2NvbG9yOndoaXRlO2JveC1zaGFkb3c6MCAwIDE1cHggdmFyKC0tYWNjZW50LWdsb3cpO3RyYW5zZm9ybTpzY2FsZSgxLjEpfSNtb2JpbGUtdHJhbnNmb3JtLWJ0bnt6LWluZGV4OjIwO2Rpc3BsYXk6bm9uZX0udG9vbC1zdGFja3twb3NpdGlvbjphYnNvbHV0ZTt0b3A6NTAlO3JpZ2h0OjEuNXJlbTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtNTAlKTtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDoxcmVtO3otaW5kZXg6MTAwO3BvaW50ZXItZXZlbnRzOmF1dG8gIWltcG9ydGFudH1AbWVkaWEgKG1heC13aWR0aDo3NjhweCl7LnRvb2wtc3RhY2t7cmlnaHQ6MXJlbTtnYXA6MC42cmVtfS50b29sLXN0YWNrIC5nbGFzcy1idG57d2lkdGg6NDRweDtoZWlnaHQ6NDRweH19I21vYmlsZS10cmFuc2Zvcm0tYnRuLmFjdGl2ZS10cmFuc2xhdGV7Y29sb3I6I2Y4NzE3MTtib3JkZXItY29sb3I6I2Y4NzE3MTtiYWNrZ3JvdW5kOnJnYmEoMjQ4LCAxMTMsIDExMywgMC4xKX0jbW9iaWxlLXRyYW5zZm9ybS1idG4uYWN0aXZlLXJvdGF0ZXtjb2xvcjojNGFkZTgwO2JvcmRlci1jb2xvcjojNGFkZTgwO2JhY2tncm91bmQ6cmdiYSg3NCwgMjIyLCAxMjgsIDAuMSl9I21vYmlsZS10cmFuc2Zvcm0tYnRuLmFjdGl2ZS1zY2FsZXtjb2xvcjojNjBhNWZhO2JvcmRlci1jb2xvcjojNjBhNWZhO2JhY2tncm91bmQ6cmdiYSg5NiwgMTY1LCAyNTAsIDAuMSl9QG1lZGlhIChtYXgtd2lkdGg6NzY4cHgpeyN0cmFuc2Zvcm0tdG9vbGJhcntkaXNwbGF5Om5vbmUgIWltcG9ydGFudH0jbW9iaWxlLXRyYW5zZm9ybS1idG57ZGlzcGxheTpmbGV4fSNtb2JpbGUtdHJhbnNmb3JtLXVpe2JvdHRvbToxLjVyZW07bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7d2lkdGg6OTB2dzttYXgtd2lkdGg6MzgwcHg7cGFkZGluZzowLjhyZW07ei1pbmRleDo5MDttYXJnaW4tcmlnaHQ6MH1oZWFkZXJ7bWFyZ2luLWJvdHRvbTowLjVyZW19I3RvcC1iYXJ7ZGlzcGxheTpncmlkICFpbXBvcnRhbnQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOmF1dG8gMWZyIGF1dG8gIWltcG9ydGFudDthbGlnbi1pdGVtczpjZW50ZXIgIWltcG9ydGFudDtwYWRkaW5nOjAuM3JlbSAwLjZyZW0gIWltcG9ydGFudDtmb250LXNpemU6MC42cmVtICFpbXBvcnRhbnQ7d2hpdGUtc3BhY2U6bm93cmFwICFpbXBvcnRhbnQ7Z2FwOjAuNXJlbSAhaW1wb3J0YW50O3RleHQtYWxpZ246Y2VudGVyfSNhcHAtdmVyc2lvbnt0ZXh0LWFsaWduOmxlZnR9I2NhbWVyYS1jb29yZHN7dGV4dC1hbGlnbjpjZW50ZXI7b3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7Zm9udC1zaXplOjAuNTVyZW19I29iamVjdC1jb29yZHN7dGV4dC1hbGlnbjpyaWdodH0jdG9wLWJhcj4qe21hcmdpbjowICFpbXBvcnRhbnQ7cGFkZGluZzowICFpbXBvcnRhbnR9fSN0b3AtYmFye3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDAlO3BhZGRpbmc6MXJlbSAycmVtO2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2dhcDoycmVtO2FsaWduLWl0ZW1zOmNlbnRlcjtwb2ludGVyLWV2ZW50czpub25lO3otaW5kZXg6MTU7Zm9udC1zaXplOjAuOHJlbTtjb2xvcjp2YXIoLS10ZXh0LXNlY29uZGFyeSk7dGV4dC1zaGFkb3c6MCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC41KX0jY2FtZXJhLWNvb3Jkc3tmb250LWZhbWlseTptb25vc3BhY2U7b3BhY2l0eTowLjh9I2luZm8tbW9kYWx7cG9zaXRpb246YWJzb2x1dGU7dG9wOjUwJTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsIC01MCUpO3dpZHRoOjkwJTttYXgtd2lkdGg6NDAwcHg7ei1pbmRleDoxMDA7dGV4dC1hbGlnbjpjZW50ZXI7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtnYXA6MXJlbX0jaW5mby1tb2RhbCBoM3tjb2xvcjp2YXIoLS1hY2NlbnQtY29sb3IpfSNpbmZvLW1vZGFsIHB7Zm9udC1zaXplOjAuOXJlbTtsaW5lLWhlaWdodDoxLjU7Y29sb3I6dmFyKC0tdGV4dC1wcmltYXJ5KX0jaW5mby1tb2RhbCBzdHJvbmd7Y29sb3I6dmFyKC0tYWNjZW50LWNvbG9yKX0udW5sb2FkLWJ0bntiYWNrZ3JvdW5kOnJnYmEoMjM5LCA2OCwgNjgsIDAuMSk7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDIzOSwgNjgsIDY4LCAwLjIpO2NvbG9yOiNmODcxNzE7Zm9udC1zaXplOjAuN3JlbTtwYWRkaW5nOjJweCA4cHg7Ym9yZGVyLXJhZGl1czo0cHg7Y3Vyc29yOnBvaW50ZXI7Zm9udC13ZWlnaHQ6NjAwO3BvaW50ZXItZXZlbnRzOmF1dG8gIWltcG9ydGFudDt0cmFuc2l0aW9uOmFsbCAwLjJzfS51bmxvYWQtYnRuOmhvdmVye2JhY2tncm91bmQ6cmdiYSgyMzksIDY4LCA2OCwgMC4yKTtib3JkZXItY29sb3I6cmdiYSgyMzksIDY4LCA2OCwgMC40KX0jZGVidWctYm94e3Bvc2l0aW9uOmFic29sdXRlO2JvdHRvbToycmVtO2xlZnQ6MnJlbTt3aWR0aDozMDBweDttYXgtaGVpZ2h0OjIwMHB4O3BhZGRpbmc6MXJlbTtmb250LXNpemU6MC43NXJlbTtkaXNwbGF5Om5vbmU7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDowLjVyZW07ei1pbmRleDo1MDtwb2ludGVyLWV2ZW50czphdXRvICFpbXBvcnRhbnR9LmRlYnVnLWhlYWRlcntkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyO21hcmdpbi1ib3R0b206MC41cmVtO2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7cGFkZGluZy1ib3R0b206MC4yNXJlbX0jY2xvc2UtZGVidWd7Zm9udC1zaXplOjEuMnJlbTtsaW5lLWhlaWdodDoxO3BhZGRpbmc6MCA0cHg7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpfSNjbG9zZS1kZWJ1Zzpob3Zlcntjb2xvcjojZjg3MTcxfSNkZWJ1Zy1ib3g6bm90KC5oaWRkZW4pe2Rpc3BsYXk6ZmxleCAhaW1wb3J0YW50fSNkZWJ1Zy1sb2d7b3ZlcmZsb3cteTphdXRvO21heC1oZWlnaHQ6MTQwcHh9LmxvZy1kZWJ1Z3tjb2xvcjp2YXIoLS10ZXh0LXNlY29uZGFyeSk7b3BhY2l0eTowLjc7Zm9udC1zaXplOjAuN3JlbX0jdHJhbnNmb3JtLXRvb2xiYXJ7cG9zaXRpb246Zml4ZWQ7dG9wOjI2MHB4O2xlZnQ6MjBweDtyaWdodDphdXRvO3BhZGRpbmc6MXJlbTttaW4td2lkdGg6MjIwcHg7ei1pbmRleDoxMDB9LnRyYW5zZm9ybS1idXR0b25ze2Rpc3BsYXk6ZmxleDtnYXA6MC41cmVtO21hcmdpbi1ib3R0b206MXJlbX0udHJhbnNmb3JtLWJ0bntmbGV4OjE7cGFkZGluZzowLjVyZW07YmFja2dyb3VuZDpyZ2JhKDU5LCAxMzAsIDI0NiwgMC4xKTtib3JkZXI6MXB4IHNvbGlkIHJnYmEoNTksIDEzMCwgMjQ2LCAwLjMpO2JvcmRlci1yYWRpdXM6NnB4O2NvbG9yOiNjYmQ1ZTE7Y3Vyc29yOnBvaW50ZXI7dHJhbnNpdGlvbjphbGwgMC4ycztmb250LXNpemU6MC45cmVtfS50cmFuc2Zvcm0tYnRuOmhvdmVye2JhY2tncm91bmQ6cmdiYSg1OSwgMTMwLCAyNDYsIDAuMyk7Y29sb3I6I2ZmZn0udHJhbnNmb3JtLWJ0bi5hY3RpdmV7YmFja2dyb3VuZDpyZ2JhKDU5LCAxMzAsIDI0NiwgMC42KTtib3JkZXItY29sb3I6IzNiODJmNjtjb2xvcjojZmZmO2JveC1zaGFkb3c6MCAwIDEwcHggcmdiYSg1OSwgMTMwLCAyNDYsIDAuMyl9LnRyYW5zZm9ybS10b2dnbGVze2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7bWFyZ2luLWJvdHRvbTowLjVyZW19LmhpbnR7Zm9udC1zaXplOjAuNzVyZW07Y29sb3I6Izk0YTNiODt0ZXh0LWFsaWduOmNlbnRlcjttYXJnaW4tdG9wOjAuNXJlbTtib3JkZXItdG9wOjFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7cGFkZGluZy10b3A6MC41cmVtfS50b2dnbGUtc3dpdGNoe3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Y3Vyc29yOnBvaW50ZXI7dXNlci1zZWxlY3Q6bm9uZX0udG9nZ2xlLXN3aXRjaCBpbnB1dHtvcGFjaXR5OjA7d2lkdGg6MDtoZWlnaHQ6MH0uc2xpZGVye3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3dpZHRoOjM2cHg7aGVpZ2h0OjIwcHg7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7dHJhbnNpdGlvbjouNHM7Ym9yZGVyLXJhZGl1czozNHB4O21hcmdpbi1yaWdodDoxMHB4fS5zbGlkZXI6YmVmb3Jle3Bvc2l0aW9uOmFic29sdXRlO2NvbnRlbnQ6IiI7aGVpZ2h0OjE0cHg7d2lkdGg6MTRweDtsZWZ0OjNweDtib3R0b206M3B4O2JhY2tncm91bmQtY29sb3I6d2hpdGU7dHJhbnNpdGlvbjouNHM7Ym9yZGVyLXJhZGl1czo1MCV9aW5wdXQ6Y2hlY2tlZCsuc2xpZGVye2JhY2tncm91bmQtY29sb3I6IzNiODJmNn1pbnB1dDpjaGVja2VkKy5zbGlkZXI6YmVmb3Jle3RyYW5zZm9ybTp0cmFuc2xhdGVYKDE2cHgpfS5sYWJlbC10ZXh0e2ZvbnQtc2l6ZTowLjlyZW07Y29sb3I6I2NiZDVlMX0ubWVzaC1pdGVtLnNlbGVjdGVke2JvcmRlci1sZWZ0OjNweCBzb2xpZCAjM2I4MmY2O2JhY2tncm91bmQ6cmdiYSg1OSwgMTMwLCAyNDYsIDAuMSl9I29iamVjdC1jb29yZHN7Zm9udC1mYW1pbHk6bW9ub3NwYWNlO2NvbG9yOiMzYjgyZjY7Zm9udC13ZWlnaHQ6NjAwO29wYWNpdHk6MC45fSNtb2JpbGUtdHJhbnNmb3JtLXVpe3Bvc2l0aW9uOmZpeGVkO2JvdHRvbTo4MHB4O2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpO3dpZHRoOjkwJTttYXgtd2lkdGg6NDAwcHg7ei1pbmRleDo5MDtkaXNwbGF5Om5vbmU7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDowLjhyZW07cGFkZGluZzoxcmVtfS5zbGlkZXItcm93e2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjFyZW19LmF4aXMtbGFiZWx7Zm9udC13ZWlnaHQ6Ym9sZDtmb250LWZhbWlseTptb25vc3BhY2U7d2lkdGg6MjBweH0ueC1heGlze2NvbG9yOiNmODcxNzF9LnktYXhpc3tjb2xvcjojNGFkZTgwfS56LWF4aXN7Y29sb3I6IzYwYTVmYX0jbW9iaWxlLXRyYW5zZm9ybS11aSBpbnB1dFt0eXBlPXJhbmdlXXtmbGV4OjE7Y3Vyc29yOnBvaW50ZXI7LXdlYmtpdC1hcHBlYXJhbmNlOm5vbmU7YXBwZWFyYW5jZTpub25lO2JhY2tncm91bmQ6dHJhbnNwYXJlbnR9I3NlbGVjdGlvbi1ib3h7cG9zaXRpb246YWJzb2x1dGU7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDU5LCAxMzAsIDI0NiwgMC44KTtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoNTksIDEzMCwgMjQ2LCAwLjEpO3BvaW50ZXItZXZlbnRzOm5vbmU7ei1pbmRleDoxMDAwfSNtb2JpbGUtdHJhbnNmb3JtLXVpIGlucHV0W3R5cGU9cmFuZ2VdOjotd2Via2l0LXNsaWRlci10aHVtYnstd2Via2l0LWFwcGVhcmFuY2U6bm9uZTtoZWlnaHQ6MjBweDt3aWR0aDoyMHB4O2JvcmRlci1yYWRpdXM6NTAlO2JhY2tncm91bmQ6I2ZmZjtjdXJzb3I6cG9pbnRlcjttYXJnaW4tdG9wOi04cHg7Ym94LXNoYWRvdzowIDAgNXB4IHJnYmEoMCwgMCwgMCwgMC41KX0jbW9iaWxlLXRyYW5zZm9ybS11aSBpbnB1dFt0eXBlPXJhbmdlXTo6LXdlYmtpdC1zbGlkZXItcnVubmFibGUtdHJhY2t7d2lkdGg6MTAwJTtoZWlnaHQ6NHB4O2N1cnNvcjpwb2ludGVyO2JhY2tncm91bmQ6cmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpO2JvcmRlci1yYWRpdXM6MnB4fS5oaW50LW1vYmlsZXtmb250LXNpemU6MC43cmVtO2NvbG9yOnZhcigtLXRleHQtc2Vjb25kYXJ5KTt0ZXh0LWFsaWduOmNlbnRlcjttYXJnaW4tdG9wOjAuMnJlbX1AbWVkaWEgKG1heC13aWR0aDo3NjhweCl7I21vYmlsZS10cmFuc2Zvcm0tdWkuYWN0aXZle2Rpc3BsYXk6ZmxleH0jdHJhbnNmb3JtLXRvb2xiYXJ7dG9wOmF1dG87Ym90dG9tOjI0MHB4O2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpO21pbi13aWR0aDo5MCV9fSNzcGxhc2gtc2NyZWVue3Bvc2l0aW9uOmZpeGVkO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDB2dztoZWlnaHQ6MTAwdmg7YmFja2dyb3VuZDp2YXIoLS1iZy1jb2xvcik7ei1pbmRleDo5OTk5O2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt0cmFuc2l0aW9uOm9wYWNpdHkgMC44cyBlYXNlLCB2aXNpYmlsaXR5IDAuOHN9I3NwbGFzaC1zY3JlZW4uZmFkZS1vdXR7b3BhY2l0eTowO3Zpc2liaWxpdHk6aGlkZGVufS5zcGxhc2gtY29udGVudHt0ZXh0LWFsaWduOmNlbnRlcjtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6MS41cmVtfS5zcGxhc2gtbG9nb3tmb250LXNpemU6Mi41cmVtO2ZvbnQtd2VpZ2h0OjcwMDtjb2xvcjp2YXIoLS1hY2NlbnQtY29sb3IpO3RleHQtc2hhZG93OjAgMCAzMHB4IHZhcigtLWFjY2VudC1nbG93KTthbmltYXRpb246cHVsc2UgMnMgaW5maW5pdGUgZWFzZS1pbi1vdXR9LnNwbGFzaC10aXRsZXtmb250LXNpemU6MnJlbTtmb250LWZhbWlseTonT3V0Zml0Jywgc2Fucy1zZXJpZn0uc3BsYXNoLWxvYWRlcnt3aWR0aDoyMDBweDtoZWlnaHQ6M3B4O2JhY2tncm91bmQ6cmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpO2JvcmRlci1yYWRpdXM6MnB4O292ZXJmbG93OmhpZGRlbjtwb3NpdGlvbjpyZWxhdGl2ZX0uc3BsYXNoLWxvYWRlcjo6YWZ0ZXJ7Y29udGVudDoiIjtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0Oi0xMDAlO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7YmFja2dyb3VuZDp2YXIoLS1hY2NlbnQtY29sb3IpO2FuaW1hdGlvbjpzcGxhc2gtbG9hZCAycyBpbmZpbml0ZSBlYXNlLWluLW91dH1Aa2V5ZnJhbWVzIHNwbGFzaC1sb2FkezAle2xlZnQ6LTEwMCV9NTAle2xlZnQ6MH0xMDAle2xlZnQ6MTAwJX19QGtleWZyYW1lcyBwdWxzZXswJSwgMTAwJXt0cmFuc2Zvcm06c2NhbGUoMSk7b3BhY2l0eToxfTUwJXt0cmFuc2Zvcm06c2NhbGUoMS4wNSk7b3BhY2l0eTowLjh9fSNzZXR0aW5ncy1wYW5lbHtwb3NpdGlvbjpmaXhlZDt0b3A6NTAlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGUoLTUwJSwgLTUwJSk7d2lkdGg6MzIwcHg7ei1pbmRleDoxMDB9LnNldHRpbmdzLWdyb3Vwe21hcmdpbi10b3A6MS41cmVtO3BhZGRpbmctdG9wOjFyZW07Ym9yZGVyLXRvcDoxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKX0uc2V0dGluZ3MtZ3JvdXAgaDR7Zm9udC1zaXplOjAuOHJlbTtjb2xvcjp2YXIoLS1hY2NlbnQtY29sb3IpO3RleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTttYXJnaW4tYm90dG9tOjFyZW19LnNldHRpbmdzLXJvd3tkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDowLjVyZW07bWFyZ2luLWJvdHRvbToxcmVtfS5zZXR0aW5ncy1yb3cgbGFiZWx7Zm9udC1zaXplOjAuOHJlbTtjb2xvcjp2YXIoLS10ZXh0LXNlY29uZGFyeSl9LnNldHRpbmdzLXJvdyBpbnB1dFt0eXBlPXJhbmdlXXt3aWR0aDoxMDAlfS5wYW5lbC1oZWFkZXJ7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2FsaWduLWl0ZW1zOmNlbnRlcjttYXJnaW4tYm90dG9tOjFyZW19I3ZpZXctZ2l6bW8tY29udGFpbmVye3Bvc2l0aW9uOmFic29sdXRlO3RvcDoxcmVtO3JpZ2h0OjFyZW07d2lkdGg6MTUwcHg7aGVpZ2h0OjE1MHB4O3otaW5kZXg6MjA7cG9pbnRlci1ldmVudHM6YXV0b30ubWVzaC1maWxlLW5vZGV7bWFyZ2luLWJvdHRvbToxcmVtfS5maWxlLWhlYWRlcntkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDowLjVyZW07cGFkZGluZzowLjVyZW07YmFja2dyb3VuZDpyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDUpO2JvcmRlci1yYWRpdXM6OHB4O2N1cnNvcjpwb2ludGVyO2ZvbnQtd2VpZ2h0OjYwMDtmb250LXNpemU6MC44NXJlbX0uZmlsZS1oZWFkZXI6aG92ZXJ7YmFja2dyb3VuZDpyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSl9LmZpbGUtaWNvbntmb250LXNpemU6MXJlbX0ubWVzaC1jaGlsZHJlbntwYWRkaW5nLWxlZnQ6MS41cmVtO21hcmdpbi10b3A6MC41cmVtO2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47Z2FwOjAuNHJlbX0jbWVzaC1pdGVtc3ttYXgtaGVpZ2h0OjUwMHB4fQ==");
            document.head.appendChild(s);

            var scriptContent = atob("LyoqCiogT3BlbkJWRSBNZXNoIFZpZXdlciAtIE11bHRpLU1lc2ggTWFuYWdlbWVudCAmIFRleHR1cmUgRml4ZXMKKi8KZnVuY3Rpb24gbG9nKG1zZywgdHlwZSA9ICdpbmZvJykgewpjb25zb2xlLmxvZyhgWyR7dHlwZX1dICR7bXNnfWApOwpjb25zdCBib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVidWctYm94Jyk7CmNvbnN0IGxvZ0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RlYnVnLWxvZycpOwppZiAoYm94ICYmIGxvZ0VsKSB7Ci8vIE9ubHkgc2hvdyBpZiBpdCB3YXNuJ3QgZXhwbGljaXRseSBoaWRkZW4gYnkgdGhlIHVzZXIKaWYgKCF3aW5kb3cuZGVidWdFeHBsaWNpdGx5SGlkZGVuKSB7CmJveC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKYm94LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7Cn0KY29uc3QgZW50cnkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKZW50cnkuY2xhc3NOYW1lID0gYGxvZy1lbnRyeSBsb2ctJHt0eXBlfWA7CmNvbnN0IHRpbWUgPSBuZXcgRGF0ZSgpLnRvTG9jYWxlVGltZVN0cmluZygnZW4tVVMnLCB7IGhvdXIxMjogZmFsc2UsIGhvdXI6ICcyLWRpZ2l0JywgbWludXRlOiAnMi1kaWdpdCcsIHNlY29uZDogJzItZGlnaXQnIH0pOwplbnRyeS50ZXh0Q29udGVudCA9IGBbJHt0aW1lfV0gJHttc2d9YDsKbG9nRWwuYXBwZW5kQ2hpbGQoZW50cnkpOwovLyBBdXRvLXNjcm9sbCBsb2dpYwpjb25zdCBpc0F0Qm90dG9tID0gbG9nRWwuc2Nyb2xsSGVpZ2h0IC0gbG9nRWwuc2Nyb2xsVG9wIDw9IGxvZ0VsLmNsaWVudEhlaWdodCArIDUwOwppZiAoaXNBdEJvdHRvbSkgewpsb2dFbC5zY3JvbGxUb3AgPSBsb2dFbC5zY3JvbGxIZWlnaHQ7Cn0KfQp9Ci8vIEdsb2JhbCBFcnJvciBIYW5kbGVyIGZvciB2aXN1YWwgZmVlZGJhY2sKd2luZG93Lm9uZXJyb3IgPSBmdW5jdGlvbiAobXNnLCB1cmwsIGxpbmVObywgY29sdW1uTm8sIGVycm9yKSB7CmxvZyhgR2xvYmFsIEVycm9yOiAke21zZ30gYXQgJHtsaW5lTm99OiR7Y29sdW1uTm99YCwgJ2Vycm9yJyk7CnJldHVybiBmYWxzZTsKfTsKLy8gLS0tIEIzRC9DU1YgUGFyc2VyIENvbXBvbmVudCAtLS0KY2xhc3MgQjNEUGFyc2VyIHsKY29uc3RydWN0b3IoKSB7IHRoaXMucmVzZXQoKTsgfQpyZXNldCgpIHsgdGhpcy5tZXNoZXMgPSBbXTsgdGhpcy5jdXJyZW50TWVzaCA9IG51bGw7IH0KcGFyc2UodGV4dCwgaXNCM0QgPSBmYWxzZSkgewp0aGlzLnJlc2V0KCk7CmNvbnN0IGxpbmVzID0gdGhpcy5zdHJpcENvbW1lbnRzKHRleHQpOwpmb3IgKGxldCBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7CmNvbnN0IGxpbmUgPSBsaW5lc1tpXS50cmltKCk7CmlmICghbGluZSkgY29udGludWU7CmxldCBjbWQsIGFyZ3M7CmlmIChpc0IzRCkgewppZiAobGluZS5zdGFydHNXaXRoKCdbJykgJiYgbGluZS5lbmRzV2l0aCgnXScpKSB7CmNtZCA9IGxpbmUuc2xpY2UoMSwgLTEpLnRvTG93ZXJDYXNlKCk7IGFyZ3MgPSBbXTsKfSBlbHNlIHsKLy8gU3BsaXQgYnkgZmlyc3Qgd2hpdGVzcGFjZSBvbmx5IHRvIHByZXNlcnZlIHNwYWNlcyBpbiBmaWxlbmFtZXMgKG1hdGNoZXMgUHl0aG9uJ3Mgc3BsaXQoTm9uZSwgMSkpCmNvbnN0IG1hdGNoID0gbGluZS5tYXRjaCgvXihcUyspKD86XHMrKC4qKSk/JC8pOwppZiAobWF0Y2gpIHsKY21kID0gbWF0Y2hbMV0udG9Mb3dlckNhc2UoKTsKY29uc3QgYXJnU3RyID0gbWF0Y2hbMl0gfHwgJyc7CmFyZ3MgPSBhcmdTdHIuc3BsaXQoJywnKS5tYXAocyA9PiBzLnRyaW0oKSkuZmlsdGVyKHMgPT4gcyAhPT0gJycpOwp9IGVsc2Ugewpjb250aW51ZTsKfQp9Cn0gZWxzZSB7CmNvbnN0IHBhcnRzID0gbGluZS5zcGxpdCgnLCcpLm1hcChzID0+IHMudHJpbSgpKTsKY21kID0gcGFydHNbMF0udG9Mb3dlckNhc2UoKTsKYXJncyA9IHBhcnRzLnNsaWNlKDEpLmZpbHRlcihzID0+IHMgIT09ICcnKTsKfQp0aGlzLnByb2Nlc3NDb21tYW5kKGNtZCwgYXJncywgaSArIDEpOwp9CmlmICh0aGlzLmN1cnJlbnRNZXNoKSB0aGlzLm1lc2hlcy5wdXNoKHRoaXMuY3VycmVudE1lc2gpOwpyZXR1cm4gdGhpcy5zZXJpYWxpemUoKTsKfQpzdHJpcENvbW1lbnRzKHRleHQpIHsKY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KC9ccj9cbi8pOwpsZXQgaW5CbG9jayA9IGZhbHNlOyBjb25zdCByZXN1bHQgPSBbXTsKZm9yIChsZXQgbGluZSBvZiBsaW5lcykgewppZiAoaW5CbG9jaykgewpjb25zdCBlbmQgPSBsaW5lLmluZGV4T2YoJyovJyk7CmlmIChlbmQgIT09IC0xKSB7IGluQmxvY2sgPSBmYWxzZTsgbGluZSA9IGxpbmUuc2xpY2UoZW5kICsgMik7IH0gZWxzZSB7IHJlc3VsdC5wdXNoKCcnKTsgY29udGludWU7IH0KfQpsZXQgcyA9IGxpbmU7CmNvbnN0IHNlbWkgPSBzLmluZGV4T2YoJzsnKTsgaWYgKHNlbWkgIT09IC0xKSBzID0gcy5zbGljZSgwLCBzZW1pKTsKY29uc3Qgc2xhc2ggPSBzLmluZGV4T2YoJy8vJyk7IGlmIChzbGFzaCAhPT0gLTEgJiYgKHNsYXNoID09PSAwIHx8IHNbc2xhc2ggLSAxXSAhPT0gJzonKSkgcyA9IHMuc2xpY2UoMCwgc2xhc2gpOwpjb25zdCBzdGFydCA9IHMuaW5kZXhPZignLyonKTsKaWYgKHN0YXJ0ICE9PSAtMSkgewpjb25zdCBlbmQgPSBzLmluZGV4T2YoJyovJywgc3RhcnQgKyAyKTsKaWYgKGVuZCAhPT0gLTEpIHMgPSBzLnNsaWNlKDAsIHN0YXJ0KSArIHMuc2xpY2UoZW5kICsgMik7IGVsc2UgeyBpbkJsb2NrID0gdHJ1ZTsgcyA9IHMuc2xpY2UoMCwgc3RhcnQpOyB9Cn0KcmVzdWx0LnB1c2gocyk7Cn0KcmV0dXJuIHJlc3VsdDsKfQpwcm9jZXNzQ29tbWFuZChjbWQsIGFyZ3MsIGxpbmVOdW0pIHsKY29uc3QgYnVpbGRlcktleXMgPSBbJ21lc2hidWlsZGVyJywgJ2NyZWF0ZW1lc2hidWlsZGVyJywgJ1ttZXNoYnVpbGRlcl0nXTsKaWYgKGJ1aWxkZXJLZXlzLmluY2x1ZGVzKGNtZCkpIHsKaWYgKHRoaXMuY3VycmVudE1lc2gpIHRoaXMubWVzaGVzLnB1c2godGhpcy5jdXJyZW50TWVzaCk7CnRoaXMuY3VycmVudE1lc2ggPSB7CnZlcnRpY2VzOiBbXSwKZmFjZXM6IFtdLAp1dnM6IFtdLAptYXRlcmlhbHM6IHsKY29sb3I6IFsyNTUsIDI1NSwgMjU1LCAyNTVdLAp0ZXh0dXJlOiBudWxsLAplbWlzc2l2ZTogWzAsIDAsIDBdLApibGVuZE1vZGU6ICdOb3JtYWwnLAp0cmFuc3BhcmVudENvbG9yOiBbMCwgMCwgMF0KfQp9OwpyZXR1cm47Cn0KaWYgKCF0aGlzLmN1cnJlbnRNZXNoKSByZXR1cm47CnN3aXRjaCAoY21kKSB7CmNhc2UgJ3ZlcnRleCc6IGNhc2UgJ2FkZHZlcnRleCc6CnRoaXMuY3VycmVudE1lc2gudmVydGljZXMucHVzaChwYXJzZUZsb2F0KGFyZ3NbMF0pIHx8IDAsIHBhcnNlRmxvYXQoYXJnc1sxXSkgfHwgMCwgLShwYXJzZUZsb2F0KGFyZ3NbMl0pIHx8IDApKTsgYnJlYWs7CmNhc2UgJ2ZhY2UnOiBjYXNlICdhZGRmYWNlJzogY2FzZSAnZmFjZTInOiBjYXNlICdhZGRmYWNlMic6CmNvbnN0IGYgPSBhcmdzLm1hcChpZHggPT4gcGFyc2VJbnQoaWR4KSkuZmlsdGVyKG4gPT4gIWlzTmFOKG4pKTsKaWYgKGYubGVuZ3RoID49IDMpIHsKdGhpcy5jdXJyZW50TWVzaC5mYWNlcy5wdXNoKGYucmV2ZXJzZSgpKTsKaWYgKGNtZC5lbmRzV2l0aCgnMicpKSB0aGlzLmN1cnJlbnRNZXNoLmZhY2VzLnB1c2goWy4uLmZdLnJldmVyc2UoKSk7Cn0gYnJlYWs7CmNhc2UgJ2N1YmUnOgp0aGlzLmNyZWF0ZUN1YmUodGhpcy5jdXJyZW50TWVzaCwgcGFyc2VGbG9hdChhcmdzWzBdKSB8fCAxLCBwYXJzZUZsb2F0KGFyZ3NbMV0pIHx8IDEsIHBhcnNlRmxvYXQoYXJnc1syXSkgfHwgMSk7IGJyZWFrOwpjYXNlICdjeWxpbmRlcic6CnsKY29uc3QgbiA9IHBhcnNlSW50KGFyZ3NbMF0pIHx8IDg7CmNvbnN0IHIxID0gYXJncy5sZW5ndGggPiAxID8gcGFyc2VGbG9hdChhcmdzWzFdKSA6IDE7CmNvbnN0IHIyID0gYXJncy5sZW5ndGggPiAyID8gcGFyc2VGbG9hdChhcmdzWzJdKSA6IDE7CmNvbnN0IGggPSBhcmdzLmxlbmd0aCA+IDMgPyBwYXJzZUZsb2F0KGFyZ3NbM10pIDogMTsKdGhpcy5jcmVhdGVDeWxpbmRlcih0aGlzLmN1cnJlbnRNZXNoLCBuLCByMSwgcjIsIGgpOwp9IGJyZWFrOwpjYXNlICdjb2xvcic6IGNhc2UgJ3NldGNvbG9yJzoKdGhpcy5jdXJyZW50TWVzaC5tYXRlcmlhbHMuY29sb3IgPSBbcGFyc2VJbnQoYXJnc1swXSkgfHwgMjU1LCBwYXJzZUludChhcmdzWzFdKSB8fCAyNTUsIHBhcnNlSW50KGFyZ3NbMl0pIHx8IDI1NSwgcGFyc2VJbnQoYXJnc1szXSkgfHwgMjU1XTsgYnJlYWs7CmNhc2UgJ2VtaXNzaXZlY29sb3InOiBjYXNlICdzZXRlbWlzc2l2ZWNvbG9yJzoKdGhpcy5jdXJyZW50TWVzaC5tYXRlcmlhbHMuZW1pc3NpdmUgPSBbcGFyc2VJbnQoYXJnc1swXSkgfHwgMCwgcGFyc2VJbnQoYXJnc1sxXSkgfHwgMCwgcGFyc2VJbnQoYXJnc1syXSkgfHwgMF07IGJyZWFrOwpjYXNlICdibGVuZG1vZGUnOiBjYXNlICdibGVuZGluZ21vZGUnOiBjYXNlICdzZXRibGVuZG1vZGUnOgp0aGlzLmN1cnJlbnRNZXNoLm1hdGVyaWFscy5ibGVuZE1vZGUgPSBhcmdzWzBdIHx8ICdOb3JtYWwnOyBicmVhazsKY2FzZSAndHJhbnNwYXJlbnQnOiBjYXNlICdzZXRkZWNhbHRyYW5zcGFyZW50Y29sb3InOgp0aGlzLmN1cnJlbnRNZXNoLm1hdGVyaWFscy50cmFuc3BhcmVudENvbG9yID0gW3BhcnNlSW50KGFyZ3NbMF0pIHx8IDAsIHBhcnNlSW50KGFyZ3NbMV0pIHx8IDAsIHBhcnNlSW50KGFyZ3NbMl0pIHx8IDBdOyBicmVhazsKY2FzZSAnY29vcmRpbmF0ZXMnOiBjYXNlICdzZXR0ZXh0dXJlY29vcmRpbmF0ZXMnOgovLyBPcGVuQlZFIGNvb3JkaW5hdGVzIGFyZSBuYXR1cmFsbHkgaGFuZGxlZCBpZiB0ZXh0dXJlLmZsaXBZID0gZmFsc2UKdGhpcy5jdXJyZW50TWVzaC51dnNbcGFyc2VJbnQoYXJnc1swXSldID0gW3BhcnNlRmxvYXQoYXJnc1sxXSkgfHwgMCwgcGFyc2VGbG9hdChhcmdzWzJdKSB8fCAwXTsKYnJlYWs7CmNhc2UgJ2xvYWQnOiBjYXNlICd0ZXh0dXJlJzogY2FzZSAnbG9hZHRleHR1cmUnOgpsZXQgdGV4ID0gYXJnc1swXSB8fCBudWxsOwppZiAodGV4KSB0ZXggPSB0ZXguc3BsaXQoL1tcXFwvXS8pLnBvcCgpLnRvTG93ZXJDYXNlKCk7CnRoaXMuY3VycmVudE1lc2gubWF0ZXJpYWxzLnRleHR1cmUgPSB0ZXg7CmJyZWFrOwpjYXNlICd0cmFuc2xhdGUnOiBjYXNlICd0cmFuc2xhdGVhbGwnOgp0aGlzLmFwcGx5VHJhbnNsYXRpb24odGhpcy5jdXJyZW50TWVzaCwgcGFyc2VGbG9hdChhcmdzWzBdKSB8fCAwLCBwYXJzZUZsb2F0KGFyZ3NbMV0pIHx8IDAsIHBhcnNlRmxvYXQoYXJnc1syXSkgfHwgMCk7IGJyZWFrOwpjYXNlICdzY2FsZSc6IGNhc2UgJ3NjYWxlYWxsJzoKdGhpcy5hcHBseVNjYWxlKHRoaXMuY3VycmVudE1lc2gsIHBhcnNlRmxvYXQoYXJnc1swXSkgfHwgMSwgcGFyc2VGbG9hdChhcmdzWzFdKSB8fCAxLCBwYXJzZUZsb2F0KGFyZ3NbMl0pIHx8IDEpOyBicmVhazsKY2FzZSAncm90YXRlJzogY2FzZSAncm90YXRlYWxsJzoKdGhpcy5hcHBseVJvdGF0aW9uKHRoaXMuY3VycmVudE1lc2gsIHBhcnNlRmxvYXQoYXJnc1swXSkgfHwgMCwgcGFyc2VGbG9hdChhcmdzWzFdKSB8fCAwLCBwYXJzZUZsb2F0KGFyZ3NbMl0pIHx8IDAsIChwYXJzZUZsb2F0KGFyZ3NbM10pIHx8IDApICogKE1hdGguUEkgLyAxODApKTsgYnJlYWs7CmNhc2UgJ3NoZWFyJzogY2FzZSAnc2hlYXJhbGwnOgp0aGlzLmFwcGx5U2hlYXIodGhpcy5jdXJyZW50TWVzaCwKW3BhcnNlRmxvYXQoYXJnc1swXSkgfHwgMCwgcGFyc2VGbG9hdChhcmdzWzFdKSB8fCAwLCBwYXJzZUZsb2F0KGFyZ3NbMl0pIHx8IDBdLApbcGFyc2VGbG9hdChhcmdzWzNdKSB8fCAwLCBwYXJzZUZsb2F0KGFyZ3NbNF0pIHx8IDAsIHBhcnNlRmxvYXQoYXJnc1s1XSkgfHwgMF0sCnBhcnNlRmxvYXQoYXJnc1s2XSkgfHwgMAopOwpicmVhazsKY2FzZSAnbWlycm9yJzogY2FzZSAnbWlycm9yYWxsJzoKdGhpcy5hcHBseU1pcnJvcih0aGlzLmN1cnJlbnRNZXNoLCAocGFyc2VGbG9hdChhcmdzWzBdKSB8fCAwKSAhPT0gMCwgKHBhcnNlRmxvYXQoYXJnc1sxXSkgfHwgMCkgIT09IDAsIChwYXJzZUZsb2F0KGFyZ3NbMl0pIHx8IDApICE9PSAwKTsKYnJlYWs7Cn0KfQpjcmVhdGVDdWJlKG1lc2gsIHN4LCBzeSwgc3opIHsKY29uc3QgdiA9IG1lc2gudmVydGljZXMubGVuZ3RoIC8gMzsKLy8gVmVydGljZXMKbWVzaC52ZXJ0aWNlcy5wdXNoKHN4LCBzeSwgLXN6KTsKbWVzaC52ZXJ0aWNlcy5wdXNoKHN4LCAtc3ksIC1zeik7Cm1lc2gudmVydGljZXMucHVzaCgtc3gsIC1zeSwgLXN6KTsKbWVzaC52ZXJ0aWNlcy5wdXNoKC1zeCwgc3ksIC1zeik7Cm1lc2gudmVydGljZXMucHVzaChzeCwgc3ksIHN6KTsKbWVzaC52ZXJ0aWNlcy5wdXNoKHN4LCAtc3ksIHN6KTsKbWVzaC52ZXJ0aWNlcy5wdXNoKC1zeCwgLXN5LCBzeik7Cm1lc2gudmVydGljZXMucHVzaCgtc3gsIHN5LCBzeik7Ci8vIEZhY2VzCm1lc2guZmFjZXMucHVzaChbdiArIDMsIHYgKyAyLCB2ICsgMSwgdiArIDBdKTsKbWVzaC5mYWNlcy5wdXNoKFt2ICsgMSwgdiArIDUsIHYgKyA0LCB2ICsgMF0pOwptZXNoLmZhY2VzLnB1c2goW3YgKyA0LCB2ICsgNywgdiArIDMsIHYgKyAwXSk7Cm1lc2guZmFjZXMucHVzaChbdiArIDcsIHYgKyA2LCB2ICsgNSwgdiArIDRdKTsKbWVzaC5mYWNlcy5wdXNoKFt2ICsgMiwgdiArIDMsIHYgKyA3LCB2ICsgNl0pOwptZXNoLmZhY2VzLnB1c2goW3YgKyA1LCB2ICsgNiwgdiArIDIsIHYgKyAxXSk7Cn0KY3JlYXRlQ3lsaW5kZXIobWVzaCwgbiwgcjEsIHIyLCBoKSB7Ci8vIEJhc2VkIG9uIENTVi5weQpjb25zdCB1cHBlcmNhcCA9IHIxID4gMC4wOwpjb25zdCBsb3dlcmNhcCA9IHIyID4gMC4wOwpjb25zdCBtID0gKHVwcGVyY2FwID8gMSA6IDApICsgKGxvd2VyY2FwID8gMSA6IDApOwpyMSA9IE1hdGguYWJzKHIxKTsgcjIgPSBNYXRoLmFicyhyMik7CmNvbnN0IHYgPSBtZXNoLnZlcnRpY2VzLmxlbmd0aCAvIDM7CmNvbnN0IGQgPSAyLjAgKiBNYXRoLlBJIC8gbjsKY29uc3QgZyA9IDAuNSAqIGg7CmxldCB0ID0gMC4wOwovLyBWZXJ0aWNlcwpmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykgewpjb25zdCBkeCA9IE1hdGguY29zKHQpOwpjb25zdCBkeiA9IE1hdGguc2luKHQpOwpjb25zdCBseCA9IGR4ICogcjIsIGx6ID0gZHogKiByMjsKY29uc3QgdXggPSBkeCAqIHIxLCB1eiA9IGR6ICogcjE7Cm1lc2gudmVydGljZXMucHVzaCh1eCwgZywgdXopOwptZXNoLnZlcnRpY2VzLnB1c2gobHgsIC1nLCBseik7CnQgKz0gZDsKfQovLyBGYWNlcyAoU2lkZSkKZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHsKY29uc3QgaTAgPSAoMiAqIGkgKyAyKSAlICgyICogbik7CmNvbnN0IGkxID0gKDIgKiBpICsgMykgJSAoMiAqIG4pOwpjb25zdCBpMiA9IDIgKiBpICsgMTsKY29uc3QgaTMgPSAyICogaTsKbWVzaC5mYWNlcy5wdXNoKFt2ICsgaTMsIHYgKyBpMiwgdiArIGkxLCB2ICsgaTBdKTsKfQovLyBDYXBzCmZvciAobGV0IGkgPSAwOyBpIDwgbTsgaSsrKSB7CmNvbnN0IGZhY2UgPSBbXTsKZm9yIChsZXQgaiA9IDA7IGogPCBuOyBqKyspIHsKaWYgKGkgPT09IDAgJiYgbG93ZXJjYXApIHsKZmFjZS5wdXNoKHYgKyAyICogaiArIDEpOwp9IGVsc2UgewpmYWNlLnB1c2godiArIDIgKiAobiAtIGogLSAxKSk7Cn0KfQptZXNoLmZhY2VzLnB1c2goZmFjZS5yZXZlcnNlKCkpOwp9Cn0KYXBwbHlUcmFuc2xhdGlvbihtLCB4LCB5LCB6KSB7IGZvciAobGV0IGkgPSAwOyBpIDwgbS52ZXJ0aWNlcy5sZW5ndGg7IGkgKz0gMykgeyBtLnZlcnRpY2VzW2ldICs9IHg7IG0udmVydGljZXNbaSArIDFdICs9IHk7IG0udmVydGljZXNbaSArIDJdICs9IHo7IH0gfQphcHBseVNjYWxlKG0sIHgsIHksIHopIHsKZm9yIChsZXQgaSA9IDA7IGkgPCBtLnZlcnRpY2VzLmxlbmd0aDsgaSArPSAzKSB7IG0udmVydGljZXNbaV0gKj0geDsgbS52ZXJ0aWNlc1tpICsgMV0gKj0geTsgbS52ZXJ0aWNlc1tpICsgMl0gKj0gejsgfQppZiAoeCAqIHkgKiB6IDwgMCkgbS5mYWNlcyA9IG0uZmFjZXMubWFwKGYgPT4gZi5yZXZlcnNlKCkpOwp9CmFwcGx5Um90YXRpb24obSwgcngsIHJ5LCByeiwgYW5nbGUpIHsKaWYgKGFuZ2xlID09PSAwKSByZXR1cm47IGNvbnN0IG1hZyA9IE1hdGguc3FydChyeCAqIHJ4ICsgcnkgKiByeSArIHJ6ICogcnopOyBpZiAobWFnID09PSAwKSByZXR1cm47CnJ4IC89IG1hZzsgcnkgLz0gbWFnOyByeiAvPSBtYWc7IGNvbnN0IGNvcyA9IE1hdGguY29zKGFuZ2xlKTsgY29uc3Qgc2luID0gTWF0aC5zaW4oYW5nbGUpOyBjb25zdCBvbWMgPSAxIC0gY29zOwpmb3IgKGxldCBpID0gMDsgaSA8IG0udmVydGljZXMubGVuZ3RoOyBpICs9IDMpIHsKY29uc3QgeCA9IG0udmVydGljZXNbaV07IGNvbnN0IHkgPSBtLnZlcnRpY2VzW2kgKyAxXTsgY29uc3QgeiA9IG0udmVydGljZXNbaSArIDJdOwptLnZlcnRpY2VzW2ldID0gKGNvcyArIHJ4ICogcnggKiBvbWMpICogeCArIChyeCAqIHJ5ICogb21jIC0gcnogKiBzaW4pICogeSArIChyeCAqIHJ6ICogb21jICsgcnkgKiBzaW4pICogejsKbS52ZXJ0aWNlc1tpICsgMV0gPSAocnkgKiByeCAqIG9tYyArIHJ6ICogc2luKSAqIHggKyAoY29zICsgcnkgKiByeSAqIG9tYykgKiB5ICsgKHJ5ICogcnogKiBvbWMgLSByeCAqIHNpbikgKiB6OwptLnZlcnRpY2VzW2kgKyAyXSA9IChyeiAqIHJ4ICogb21jIC0gcnkgKiBzaW4pICogeCArIChyeiAqIHJ5ICogb21jICsgcnggKiBzaW4pICogeSArIChjb3MgKyByeiAqIHJ6ICogb21jKSAqIHo7Cn0KfQphcHBseVNoZWFyKG0sIGQsIHMsIHIpIHsKY29uc3QgbWFnbml0dWRlID0gKHYpID0+IE1hdGguc3FydCh2WzBdICogdlswXSArIHZbMV0gKiB2WzFdICsgdlsyXSAqIHZbMl0pOwpjb25zdCBub3JtYWxpemUgPSAodikgPT4geyBjb25zdCBtYWcgPSBtYWduaXR1ZGUodik7IHJldHVybiBtYWcgPT09IDAgPyB2IDogW3ZbMF0gLyBtYWcsIHZbMV0gLyBtYWcsIHZbMl0gLyBtYWddOyB9OwpkID0gbm9ybWFsaXplKGQpOwpzID0gbm9ybWFsaXplKHMpOwpmb3IgKGxldCBpID0gMDsgaSA8IG0udmVydGljZXMubGVuZ3RoOyBpICs9IDMpIHsKY29uc3QgdnggPSBtLnZlcnRpY2VzW2ldLCB2eSA9IG0udmVydGljZXNbaSArIDFdLCB2eiA9IG0udmVydGljZXNbaSArIDJdOwpjb25zdCBkb3QgPSBkWzBdICogdnggKyBkWzFdICogdnkgKyBkWzJdICogdno7Cm0udmVydGljZXNbaV0gPSB2eCArIHNbMF0gKiByICogZG90OwptLnZlcnRpY2VzW2kgKyAxXSA9IHZ5ICsgc1sxXSAqIHIgKiBkb3Q7Cm0udmVydGljZXNbaSArIDJdID0gdnogKyBzWzJdICogciAqIGRvdDsKfQp9CmFwcGx5TWlycm9yKG0sIHZ4LCB2eSwgdnopIHsKY29uc3QgeG0gPSB2eCA/IC0xLjAgOiAxLjA7CmNvbnN0IHltID0gdnkgPyAtMS4wIDogMS4wOwpjb25zdCB6bSA9IHZ6ID8gLTEuMCA6IDEuMDsKLy8gSW52ZXJ0IHZlcnRpY2VzCmZvciAobGV0IGkgPSAwOyBpIDwgbS52ZXJ0aWNlcy5sZW5ndGg7IGkgKz0gMykgewptLnZlcnRpY2VzW2ldICo9IHhtOwptLnZlcnRpY2VzW2kgKyAxXSAqPSB5bTsKbS52ZXJ0aWNlc1tpICsgMl0gKj0gem07Cn0KLy8gUmV2ZXJzZSBmYWNlcyBpZiBvZGQgbnVtYmVyIG9mIGZsaXBzCmxldCBudW1GbGlwcyA9IDA7CmlmICh2eCkgbnVtRmxpcHMrKzsgaWYgKHZ5KSBudW1GbGlwcysrOyBpZiAodnopIG51bUZsaXBzKys7CmlmIChudW1GbGlwcyAlIDIgIT09IDApIHsKbS5mYWNlcyA9IG0uZmFjZXMubWFwKGYgPT4gZi5yZXZlcnNlKCkpOwp9Cn0Kc2VyaWFsaXplKCkgewpyZXR1cm4gdGhpcy5tZXNoZXMubWFwKG0gPT4gewpjb25zdCB0cmlWZXJ0cyA9IFtdOyBjb25zdCB0cmlVVnMgPSBbXTsKZm9yIChjb25zdCBmYWNlIG9mIG0uZmFjZXMpIHsKZm9yIChsZXQgaSA9IDE7IGkgPCBmYWNlLmxlbmd0aCAtIDE7IGkrKykgewpjb25zdCBpZHhzID0gW2ZhY2VbMF0sIGZhY2VbaV0sIGZhY2VbaSArIDFdXTsKZm9yIChjb25zdCBpZCBvZiBpZHhzKSB7CnRyaVZlcnRzLnB1c2gobS52ZXJ0aWNlc1tpZCAqIDNdLCBtLnZlcnRpY2VzW2lkICogMyArIDFdLCBtLnZlcnRpY2VzW2lkICogMyArIDJdKTsKaWYgKG0udXZzW2lkXSkgdHJpVVZzLnB1c2gobS51dnNbaWRdWzBdLCBtLnV2c1tpZF1bMV0pOyBlbHNlIHRyaVVWcy5wdXNoKDAsIDApOwp9Cn0KfQpyZXR1cm4geyB2ZXJ0aWNlczogbmV3IEZsb2F0MzJBcnJheSh0cmlWZXJ0cyksIHV2czogbmV3IEZsb2F0MzJBcnJheSh0cmlVVnMpLCBtYXRlcmlhbDogbS5tYXRlcmlhbHMgfTsKfSk7Cn0KfQovLyAtLS0gVmlld2VyIENvbXBvbmVudCAtLS0KY2xhc3MgVmlld2VyIHsKY29uc3RydWN0b3IoY2FudmFzSWQpIHsKdGhpcy5jYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjYW52YXNJZCk7CnRoaXMudGV4dHVyZUNhY2hlID0gbmV3IE1hcCgpOwp0aGlzLm1vZGVscyA9IG5ldyBNYXAoKTsgLy8gU3RvcmUgbW9kZWxzIGJ5IElECnRoaXMuZ2l6bW9TaXplID0gMTUwOwp0aGlzLmluaXQoKTsKfQppbml0KCkgewp0aGlzLnNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7CnRoaXMuc2NlbmUuYmFja2dyb3VuZCA9IG5ldyBUSFJFRS5Db2xvcigweDBkMGYxNCk7CnRoaXMuY2FtZXJhID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKDc1LCB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCwgMC4xLCAxMDAwKTsKdGhpcy5jYW1lcmEucG9zaXRpb24uc2V0KDUsIDUsIDUpOwp0aGlzLnJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoeyBjYW52YXM6IHRoaXMuY2FudmFzLCBhbnRpYWxpYXM6IHRydWUsIGFscGhhOiB0cnVlIH0pOwp0aGlzLnJlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7CnRoaXMuY29udHJvbHMgPSBuZXcgVEhSRUUuT3JiaXRDb250cm9scyh0aGlzLmNhbWVyYSwgdGhpcy5yZW5kZXJlci5kb21FbGVtZW50KTsKdGhpcy5jb250cm9scy5lbmFibGVEYW1waW5nID0gdHJ1ZTsKdGhpcy5jb250cm9scy5lbmFibGVQYW4gPSB0cnVlOwp0aGlzLmNvbnRyb2xzLnNjcmVlblNwYWNlUGFubmluZyA9IHRydWU7CnRoaXMuY29udHJvbHMudG91Y2hlcyA9IHsKT05FOiBUSFJFRS5UT1VDSC5ST1RBVEUsClRXTzogVEhSRUUuVE9VQ0guRE9MTFlfUEFOCn07Ci8vIFdpbmRvdyBSZXNpemUgSGFuZGxlcgp3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4gewp0aGlzLmNhbWVyYS5hc3BlY3QgPSB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodDsKdGhpcy5jYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpOwp0aGlzLnJlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7Cn0pOwp0aGlzLmNvbnRyb2xzLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHsKY29uc3QgeCA9IHRoaXMuY2FtZXJhLnBvc2l0aW9uLngudG9GaXhlZCgyKTsKY29uc3QgeSA9IHRoaXMuY2FtZXJhLnBvc2l0aW9uLnkudG9GaXhlZCgyKTsKY29uc3QgeiA9IHRoaXMuY2FtZXJhLnBvc2l0aW9uLnoudG9GaXhlZCgyKTsKY29uc3QgY29vcmRzUGFyYW1zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbWVyYS1jb29yZHMnKTsKaWYgKGNvb3Jkc1BhcmFtcykgY29vcmRzUGFyYW1zLnRleHRDb250ZW50ID0gYENhbTogJHt4fSwgJHt5fSwgJHt6fWA7Cn0pOwp0aGlzLnNjZW5lLmFkZChuZXcgVEhSRUUuQW1iaWVudExpZ2h0KDB4ZmZmZmZmLCAwLjgpKTsKLy8gRGlyZWN0aW9uYWwgTGlnaHQgd2l0aCBTaGFkb3dzCmNvbnN0IGRpckxpZ2h0ID0gbmV3IFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQoMHhmZmZmZmYsIDEuNSk7CmRpckxpZ2h0LnBvc2l0aW9uLnNldCg1LCAxMCwgNy41KTsKZGlyTGlnaHQuY2FzdFNoYWRvdyA9IHRydWU7Ci8vIFNoYWRvdyBtYXAgcmVzb2x1dGlvbgpkaXJMaWdodC5zaGFkb3cubWFwU2l6ZS53aWR0aCA9IDIwNDg7CmRpckxpZ2h0LnNoYWRvdy5tYXBTaXplLmhlaWdodCA9IDIwNDg7Ci8vIFNoYWRvdyBjYW1lcmEgYm91bmRzCmNvbnN0IGQgPSA1MDsKZGlyTGlnaHQuc2hhZG93LmNhbWVyYS5sZWZ0ID0gLWQ7CmRpckxpZ2h0LnNoYWRvdy5jYW1lcmEucmlnaHQgPSBkOwpkaXJMaWdodC5zaGFkb3cuY2FtZXJhLnRvcCA9IGQ7CmRpckxpZ2h0LnNoYWRvdy5jYW1lcmEuYm90dG9tID0gLWQ7CmRpckxpZ2h0LnNoYWRvdy5jYW1lcmEuZmFyID0gMTAwOwp0aGlzLnNjZW5lLmFkZChkaXJMaWdodCk7CnRoaXMuZGlyTGlnaHQgPSBkaXJMaWdodDsKdGhpcy5yZW5kZXJlci5zaGFkb3dNYXAuZW5hYmxlZCA9IHRydWU7CnRoaXMucmVuZGVyZXIuc2hhZG93TWFwLnR5cGUgPSBUSFJFRS5QQ0ZTb2Z0U2hhZG93TWFwOwovLyBJbmZpbml0ZSBHcmlkIEFwcHJveGltYXRpb24KY29uc3QgZ3JpZCA9IG5ldyBUSFJFRS5HcmlkSGVscGVyKDIwMDAsIDIwMDAsIDB4M2I4MmY2LCAweDFlMjkzYik7CmdyaWQucG9zaXRpb24ueSA9IC0wLjU7CmdyaWQubWF0ZXJpYWwudHJhbnNwYXJlbnQgPSB0cnVlOwpncmlkLm1hdGVyaWFsLm9wYWNpdHkgPSAwLjI1OwpncmlkLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwovLyBUcmFuc2Zvcm0gQ29udHJvbHMKdGhpcy50cmFuc2Zvcm1Db250cm9sID0gbmV3IFRIUkVFLlRyYW5zZm9ybUNvbnRyb2xzKHRoaXMuY2FtZXJhLCB0aGlzLnJlbmRlcmVyLmRvbUVsZW1lbnQpOwp0aGlzLnRyYW5zZm9ybUNvbnRyb2wuc2l6ZSA9IDAuNjsgLy8gUmVkdWNlZCBzaXplIHRvIHByZXZlbnQgb3ZlcndoZWxtaW5nIHZpZXcgd2hlbiBjbG9zZQp0aGlzLnRyYW5zZm9ybUNvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2dpbmctY2hhbmdlZCcsIChldmVudCkgPT4gewp0aGlzLmNvbnRyb2xzLmVuYWJsZWQgPSAhZXZlbnQudmFsdWU7Cn0pOwp0aGlzLnNjZW5lLmFkZCh0aGlzLnRyYW5zZm9ybUNvbnRyb2wpOwp0aGlzLnNjZW5lLmFkZChncmlkKTsKLy8gRm9nIGZvciBkZXB0aC9pbmZpbml0ZSBmZWVsCnRoaXMuc2NlbmUuZm9nID0gbmV3IFRIUkVFLkZvZ0V4cDIoMHgwZDBmMTQsIDAuMDAyKTsKY29uc3QgYW5pbWF0ZSA9ICgpID0+IHsKcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpOwp0aGlzLmNvbnRyb2xzLnVwZGF0ZSgpOwp0aGlzLnJlbmRlcmVyLnJlbmRlcih0aGlzLnNjZW5lLCB0aGlzLmNhbWVyYSk7CmlmICh0aGlzLmdpem1vUmVuZGVyZXIpIHRoaXMucmVuZGVyR2l6bW8oKTsKfTsKYW5pbWF0ZSgpOwp0aGlzLmluaXRHaXptbygpOwp9CmluaXRHaXptbygpIHsKY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXctZ2l6bW8tY29udGFpbmVyJyk7CmlmICghY29udGFpbmVyKSByZXR1cm47CnRoaXMuZ2l6bW9TY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpOwp0aGlzLmdpem1vQ2FtZXJhID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKDUwLCAxLCAwLjEsIDEwMCk7CnRoaXMuZ2l6bW9SZW5kZXJlciA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKHsgYW50aWFsaWFzOiB0cnVlLCBhbHBoYTogdHJ1ZSB9KTsKdGhpcy5naXptb1JlbmRlcmVyLnNldFNpemUodGhpcy5naXptb1NpemUsIHRoaXMuZ2l6bW9TaXplKTsKY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuZ2l6bW9SZW5kZXJlci5kb21FbGVtZW50KTsKLy8gR2l6bW8gQXhlcwpjb25zdCBheGVzSGVscGVyID0gbmV3IFRIUkVFLkF4ZXNIZWxwZXIoMik7CnRoaXMuZ2l6bW9TY2VuZS5hZGQoYXhlc0hlbHBlcik7Ci8vIExhYmVscyBmb3IgY2xpY2tpbmcKY29uc3QgZm9udExvYWRlciA9IHsgbG9hZDogKHVybCwgY2IpID0+IGNiKG51bGwpIH07IC8vIFBsYWNlaG9sZGVyIGZvciBsYWJlbHMgaWYgbmVlZGVkLCBvciB1c2Ugc2ltcGxlIHNwcml0ZXMKY29uc3QgY3JlYXRlTGFiZWwgPSAodGV4dCwgcG9zLCBjb2xvcikgPT4gewpjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsKY2FudmFzLndpZHRoID0gNjQ7IGNhbnZhcy5oZWlnaHQgPSA2NDsKY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CmN0eC5maWxsU3R5bGUgPSBjb2xvcjsKY3R4LmJlZ2luUGF0aCgpOwpjdHguYXJjKDMyLCAzMiwgMjgsIDAsIE1hdGguUEkgKiAyKTsKY3R4LmZpbGwoKTsKY3R4LmZpbGxTdHlsZSA9ICd3aGl0ZSc7CmN0eC5mb250ID0gJ2JvbGQgMzJweCBJbnRlcic7CmN0eC50ZXh0QWxpZ24gPSAnY2VudGVyJzsKY3R4LnRleHRCYXNlbGluZSA9ICdtaWRkbGUnOwpjdHguZmlsbFRleHQodGV4dCwgMzIsIDMyKTsKY29uc3QgdGV4ID0gbmV3IFRIUkVFLkNhbnZhc1RleHR1cmUoY2FudmFzKTsKY29uc3QgbWF0ID0gbmV3IFRIUkVFLlNwcml0ZU1hdGVyaWFsKHsgbWFwOiB0ZXggfSk7CmNvbnN0IHNwcml0ZSA9IG5ldyBUSFJFRS5TcHJpdGUobWF0KTsKc3ByaXRlLnBvc2l0aW9uLmNvcHkocG9zKTsKc3ByaXRlLnNjYWxlLnNldCgwLjgsIDAuOCwgMSk7CnNwcml0ZS51c2VyRGF0YSA9IHsgYXhpczogdGV4dC50b0xvd2VyQ2FzZSgpIH07CnJldHVybiBzcHJpdGU7Cn07CnRoaXMuZ2l6bW9TY2VuZS5hZGQoY3JlYXRlTGFiZWwoJ1gnLCBuZXcgVEhSRUUuVmVjdG9yMygyLCAwLCAwKSwgJyNmODcxNzEnKSk7CnRoaXMuZ2l6bW9TY2VuZS5hZGQoY3JlYXRlTGFiZWwoJ1knLCBuZXcgVEhSRUUuVmVjdG9yMygwLCAyLCAwKSwgJyM0YWRlODAnKSk7CnRoaXMuZ2l6bW9TY2VuZS5hZGQoY3JlYXRlTGFiZWwoJ1onLCBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAyKSwgJyM2MGE1ZmEnKSk7Ci8vIEludGVyYWN0aW9uCnRoaXMuZ2l6bW9SZW5kZXJlci5kb21FbGVtZW50Lm9uY2xpY2sgPSAoZSkgPT4gewpjb25zdCByZWN0ID0gdGhpcy5naXptb1JlbmRlcmVyLmRvbUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CmNvbnN0IG1vdXNlID0gbmV3IFRIUkVFLlZlY3RvcjIoCigoZS5jbGllbnRYIC0gcmVjdC5sZWZ0KSAvIHRoaXMuZ2l6bW9TaXplKSAqIDIgLSAxLAotKChlLmNsaWVudFkgLSByZWN0LnRvcCkgLyB0aGlzLmdpem1vU2l6ZSkgKiAyICsgMQopOwpjb25zdCByYXljYXN0ZXIgPSBuZXcgVEhSRUUuUmF5Y2FzdGVyKCk7CnJheWNhc3Rlci5zZXRGcm9tQ2FtZXJhKG1vdXNlLCB0aGlzLmdpem1vQ2FtZXJhKTsKY29uc3QgaW50ZXJzZWN0cyA9IHJheWNhc3Rlci5pbnRlcnNlY3RPYmplY3RzKHRoaXMuZ2l6bW9TY2VuZS5jaGlsZHJlbik7CmlmIChpbnRlcnNlY3RzLmxlbmd0aCA+IDApIHsKY29uc3QgYXhpcyA9IGludGVyc2VjdHNbMF0ub2JqZWN0LnVzZXJEYXRhLmF4aXM7CmlmIChheGlzKSB0aGlzLnNuYXBDYW1lcmEoYXhpcyk7Cn0gZWxzZSB7Ci8vIENsaWNrIGJhY2tncm91bmQgdG8gdG9nZ2xlIG9ydGhvL3BlcnNwCnRoaXMudG9nZ2xlQ2FtZXJhUHJvamVjdGlvbigpOwp9Cn07Cn0KcmVuZGVyR2l6bW8oKSB7CnRoaXMuZ2l6bW9DYW1lcmEucG9zaXRpb24uY29weSh0aGlzLmNhbWVyYS5wb3NpdGlvbikuc3ViKHRoaXMuY29udHJvbHMudGFyZ2V0KS5ub3JtYWxpemUoKS5tdWx0aXBseVNjYWxhcig3KTsKdGhpcy5naXptb0NhbWVyYS5sb29rQXQoMCwgMCwgMCk7CnRoaXMuZ2l6bW9SZW5kZXJlci5yZW5kZXIodGhpcy5naXptb1NjZW5lLCB0aGlzLmdpem1vQ2FtZXJhKTsKfQpzbmFwQ2FtZXJhKGF4aXMpIHsKY29uc3QgZGlzdCA9IHRoaXMuY2FtZXJhLnBvc2l0aW9uLmRpc3RhbmNlVG8odGhpcy5jb250cm9scy50YXJnZXQpOwpjb25zdCBuZXdQb3MgPSB0aGlzLmNvbnRyb2xzLnRhcmdldC5jbG9uZSgpOwpzd2l0Y2ggKGF4aXMpIHsKY2FzZSAneCc6IG5ld1Bvcy54ICs9IGRpc3Q7IGJyZWFrOwpjYXNlICd5JzogbmV3UG9zLnkgKz0gZGlzdDsgYnJlYWs7CmNhc2UgJ3onOiBuZXdQb3MueiArPSBkaXN0OyBicmVhazsKfQp0aGlzLmNhbWVyYS5wb3NpdGlvbi5jb3B5KG5ld1Bvcyk7CnRoaXMuY29udHJvbHMudXBkYXRlKCk7CmxvZyhgU25hcHBlZCBjYW1lcmEgdG8gJHtheGlzLnRvVXBwZXJDYXNlKCl9YCwgJ2luZm8nKTsKfQp0b2dnbGVDYW1lcmFQcm9qZWN0aW9uKCkgewpjb25zdCBpc1BlcnNwID0gdGhpcy5jYW1lcmEuaXNQZXJzcGVjdGl2ZUNhbWVyYTsKY29uc3QgcG9zID0gdGhpcy5jYW1lcmEucG9zaXRpb24uY2xvbmUoKTsKY29uc3QgdGFyZ2V0ID0gdGhpcy5jb250cm9scy50YXJnZXQuY2xvbmUoKTsKaWYgKGlzUGVyc3ApIHsKY29uc3QgYXNwZWN0ID0gd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQ7CmNvbnN0IGRpc3QgPSBwb3MuZGlzdGFuY2VUbyh0YXJnZXQpOwpjb25zdCBmb3YgPSA0NTsKY29uc3QgaGVpZ2h0ID0gZGlzdCAqIE1hdGgudGFuKFRIUkVFLk1hdGhVdGlscy5ERUcyUkFEICogZm92ICogMC41KTsKY29uc3Qgd2lkdGggPSBoZWlnaHQgKiBhc3BlY3Q7CmNvbnN0IG9ydGhvQ2FtID0gbmV3IFRIUkVFLk9ydGhvZ3JhcGhpY0NhbWVyYSgtd2lkdGgsIHdpZHRoLCBoZWlnaHQsIC1oZWlnaHQsIDAuMSwgMjAwMCk7Cm9ydGhvQ2FtLnBvc2l0aW9uLmNvcHkocG9zKTsKb3J0aG9DYW0ubG9va0F0KHRhcmdldCk7CnRoaXMuY2FtZXJhID0gb3J0aG9DYW07Cn0gZWxzZSB7CmNvbnN0IHBlcnNwQ2FtID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKDc1LCB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCwgMC4xLCAxMDAwKTsKcGVyc3BDYW0ucG9zaXRpb24uY29weShwb3MpOwpwZXJzcENhbS5sb29rQXQodGFyZ2V0KTsKdGhpcy5jYW1lcmEgPSBwZXJzcENhbTsKfQp0aGlzLmNvbnRyb2xzLm9iamVjdCA9IHRoaXMuY2FtZXJhOwp0aGlzLmNvbnRyb2xzLnVwZGF0ZSgpOwpsb2coYENhbWVyYSBtb2RlOiAke3RoaXMuY2FtZXJhLmlzUGVyc3BlY3RpdmVDYW1lcmEgPyAnUGVyc3BlY3RpdmUnIDogJ09ydGhvZ3JhcGhpYyd9YCwgJ2luZm8nKTsKfQphZGRUZXh0dXJlKG5hbWUsIHVybCkgewpjb25zdCBsb2FkZXIgPSBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpOwpjb25zdCBsb3dlck5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7CmxvZyhgU3RhcnRpbmcgbG9hZCBmb3IgdGV4dHVyZTogJHtuYW1lfWAsICdpbmZvJyk7CmxvYWRlci5sb2FkKHVybCwgKHRleCkgPT4gewp0ZXguYW5pc290cm9weSA9IDQ7CnRleC53cmFwUyA9IFRIUkVFLlJlcGVhdFdyYXBwaW5nOwp0ZXgud3JhcFQgPSBUSFJFRS5SZXBlYXRXcmFwcGluZzsKdGV4LmZsaXBZID0gZmFsc2U7IC8vIE9wZW5CVkUgVVZzIGFyZSBZLWRvd24sIG1hcHBpbmcgZGlyZWN0bHkgd29ya3MgaWYgd2UgZG9uJ3QgZmxpcAp0ZXguY29sb3JTcGFjZSA9IFRIUkVFLlNSR0JDb2xvclNwYWNlOyAvLyBFbnN1cmUgY29ycmVjdCBjb2xvciBwcm9maWxlCnRoaXMudGV4dHVyZUNhY2hlLnNldChsb3dlck5hbWUsIHRleCk7CmxvZyhgVGV4dHVyZSBsb2FkZWQ6ICR7bmFtZX1gLCAnaW5mbycpOwovLyBSZWFjdGl2ZSBVcGRhdGU6IEFwcGx5IHRvIGV4aXN0aW5nIG1lc2hlcyB3YWl0aW5nIGZvciB0aGlzIHRleHR1cmUKdGhpcy5tb2RlbHMuZm9yRWFjaChncm91cCA9PiB7Cmdyb3VwLnRyYXZlcnNlKGNoaWxkID0+IHsKaWYgKGNoaWxkLmlzTWVzaCAmJiBjaGlsZC51c2VyRGF0YS50ZXh0dXJlTmFtZSA9PT0gbG93ZXJOYW1lKSB7CmNoaWxkLm1hdGVyaWFsLm1hcCA9IHRleDsKY2hpbGQubWF0ZXJpYWwuY29sb3Iuc2V0SGV4KDB4ZmZmZmZmKTsgLy8gUmVzZXQgY29sb3IgdGludApjaGlsZC5tYXRlcmlhbC5uZWVkc1VwZGF0ZSA9IHRydWU7CmxvZyhgUmVhY3RpdmU6IEFwcGxpZWQgJHtuYW1lfSB0byBtZXNoYCwgJ2luZm8nKTsKfQp9KTsKfSk7Cn0sIHVuZGVmaW5lZCwgKGVycikgPT4gewpsb2coYEZhaWxlZCB0byBsb2FkIHRleHR1cmUgJHtuYW1lfTogJHtlcnJ9YCwgJ2Vycm9yJyk7Cn0pOwp9CmxvYWRNb2RlbChpZCwgbWVzaERhdGEpIHsKY29uc3QgZ3JvdXAgPSBuZXcgVEhSRUUuR3JvdXAoKTsKbWVzaERhdGEuZm9yRWFjaChkYXRhID0+IHsKY29uc3QgYnVmZmVyR2VvID0gbmV3IFRIUkVFLkJ1ZmZlckdlb21ldHJ5KCk7CmJ1ZmZlckdlby5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZShkYXRhLnZlcnRpY2VzLCAzKSk7CmlmIChkYXRhLnV2cyAmJiBkYXRhLnV2cy5sZW5ndGggPiAwKSBidWZmZXJHZW8uc2V0QXR0cmlidXRlKCd1dicsIG5ldyBUSFJFRS5CdWZmZXJBdHRyaWJ1dGUoZGF0YS51dnMsIDIpKTsKYnVmZmVyR2VvLmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7CmNvbnN0IGMgPSBkYXRhLm1hdGVyaWFsLmNvbG9yOwpjb25zdCBtYXRPcHRpb25zID0gewpjb2xvcjogbmV3IFRIUkVFLkNvbG9yKGNbMF0gLyAyNTUsIGNbMV0gLyAyNTUsIGNbMl0gLyAyNTUpLAp0cmFuc3BhcmVudDogY1szXSA8IDI1NSwKb3BhY2l0eTogY1szXSAvIDI1NSwKc2lkZTogVEhSRUUuRG91YmxlU2lkZSwKLy8gWi1GaWdodGluZyBNaXRpZ2F0aW9uCnBvbHlnb25PZmZzZXQ6IHRydWUsCnBvbHlnb25PZmZzZXRGYWN0b3I6IDEsCnBvbHlnb25PZmZzZXRVbml0czogMQp9Owpjb25zdCB0ZXhOYW1lID0gZGF0YS5tYXRlcmlhbC50ZXh0dXJlOwpsZXQgdGV4dHVyZVRvQXBwbHkgPSBudWxsOwppZiAodGV4TmFtZSkgewppZiAodGhpcy50ZXh0dXJlQ2FjaGUuaGFzKHRleE5hbWUpKSB7Cm1hdE9wdGlvbnMubWFwID0gdGhpcy50ZXh0dXJlQ2FjaGUuZ2V0KHRleE5hbWUpOwptYXRPcHRpb25zLmNvbG9yID0gbmV3IFRIUkVFLkNvbG9yKDEsIDEsIDEpOwovLyBBbHBoYSBDbGlwcGluZyBmb3IgdHJhbnNwYXJlbnQgcGFydHMKbWF0T3B0aW9ucy5hbHBoYVRlc3QgPSAwLjE7Cn0gZWxzZSB7CmxvZyhgV2FpdGluZyBmb3IgdGV4dHVyZTogJHt0ZXhOYW1lfSAoRHJhZy9Ecm9wIHRoaXMgZmlsZSB0byBsb2FkKWAsICdpbmZvJyk7Cn0KdGV4dHVyZVRvQXBwbHkgPSB0ZXhOYW1lOwp9IGVsc2UgaWYgKGRhdGEubWF0ZXJpYWwuZW1pc3NpdmUpIHsKY29uc3QgZSA9IGRhdGEubWF0ZXJpYWwuZW1pc3NpdmU7Cm1hdE9wdGlvbnMuZW1pc3NpdmUgPSBuZXcgVEhSRUUuQ29sb3IoZVswXSAvIDI1NSwgZVsxXSAvIDI1NSwgZVsyXSAvIDI1NSk7Cn0KaWYgKGRhdGEubWF0ZXJpYWwuYmxlbmRNb2RlID09PSAnQWRkaXRpdmUnKSB7Cm1hdE9wdGlvbnMuYmxlbmRpbmcgPSBUSFJFRS5BZGRpdGl2ZUJsZW5kaW5nOwptYXRPcHRpb25zLmRlcHRoV3JpdGUgPSBmYWxzZTsKfQpjb25zdCBtZXNoID0gbmV3IFRIUkVFLk1lc2goYnVmZmVyR2VvLCBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwobWF0T3B0aW9ucykpOwptZXNoLmNhc3RTaGFkb3cgPSB0cnVlOwptZXNoLnJlY2VpdmVTaGFkb3cgPSB0cnVlOwppZiAodGV4dHVyZVRvQXBwbHkpIHsKbWVzaC51c2VyRGF0YS50ZXh0dXJlTmFtZSA9IHRleHR1cmVUb0FwcGx5Owp9CmlmIChkYXRhLm1hdGVyaWFsLmJsZW5kTW9kZSA9PT0gJ0FkZGl0aXZlJykgbWVzaC5yZW5kZXJPcmRlciA9IDE7IC8vIEJhc2ljIHNvcnQKZ3JvdXAuYWRkKG1lc2gpOwp9KTsKLy8gUmVjZW50ZXIgcGl2b3QgdG8gY2VudGVyIG9mIGJvdW5kaW5nIGJveAovLyBUaGlzIGVuc3VyZXMgdGhlIEdpem1vIGFwcGVhcnMgYXQgdGhlIHZpc3VhbCBjZW50ZXIgb2YgdGhlIG9iamVjdApjb25zdCBib3ggPSBuZXcgVEhSRUUuQm94MygpLnNldEZyb21PYmplY3QoZ3JvdXApOwppZiAoIWJveC5pc0VtcHR5KCkpIHsKY29uc3QgY2VudGVyID0gYm94LmdldENlbnRlcihuZXcgVEhSRUUuVmVjdG9yMygpKTsKLy8gMS4gTW92ZSBhbGwgZ2VvbWV0cnkgc28gdGhlIGNlbnRlciBiZWNvbWVzICgwLDAsMCkgbG9jYWxseQpncm91cC5jaGlsZHJlbi5mb3JFYWNoKG1lc2ggPT4gewppZiAobWVzaC5nZW9tZXRyeSkgewptZXNoLmdlb21ldHJ5LnRyYW5zbGF0ZSgtY2VudGVyLngsIC1jZW50ZXIueSwgLWNlbnRlci56KTsKfQp9KTsKLy8gMi4gTW92ZSB0aGUgZ3JvdXAgY29udGFpbmVyIHRvIHRoZSBvcmlnaW5hbCBjZW50ZXIgbG9jYXRpb24KLy8gVmlzdWFsIHBvc2l0aW9uIHJlbWFpbnMgdGhlIHNhbWUgaW4gd29ybGQgc3BhY2UsIGJ1dCBwaXZvdCBpcyBub3cgY2VudGVyZWQKZ3JvdXAucG9zaXRpb24uY29weShjZW50ZXIpOwp9CnRoaXMuc2NlbmUuYWRkKGdyb3VwKTsKdGhpcy5tb2RlbHMuc2V0KGlkLCBncm91cCk7CnRoaXMuY2VudGVyTW9kZWwoKTsKfQp1bmxvYWRNb2RlbChpZCkgewpjb25zdCBncm91cCA9IHRoaXMubW9kZWxzLmdldChpZCk7CmlmIChncm91cCkgewpncm91cC5jaGlsZHJlbi5mb3JFYWNoKG1lc2ggPT4gewppZiAobWVzaC5nZW9tZXRyeSkgbWVzaC5nZW9tZXRyeS5kaXNwb3NlKCk7CmlmIChtZXNoLm1hdGVyaWFsKSBtZXNoLm1hdGVyaWFsLmRpc3Bvc2UoKTsKfSk7CnRoaXMuc2NlbmUucmVtb3ZlKGdyb3VwKTsKdGhpcy5tb2RlbHMuZGVsZXRlKGlkKTsKbG9nKGBNb2RlbCB1bmxvYWRlZDogJHtpZH1gLCAnaW5mbycpOwp9Cn0KZmxpcFVWKGlkLCBheGlzKSB7CmNvbnN0IGdyb3VwID0gdGhpcy5tb2RlbHMuZ2V0KGlkKTsKaWYgKGdyb3VwKSB7Cmdyb3VwLnRyYXZlcnNlKGNoaWxkID0+IHsKaWYgKGNoaWxkLmlzTWVzaCAmJiBjaGlsZC5nZW9tZXRyeS5hdHRyaWJ1dGVzLnV2KSB7CmNvbnN0IHV2ID0gY2hpbGQuZ2VvbWV0cnkuYXR0cmlidXRlcy51djsKZm9yIChsZXQgaSA9IDA7IGkgPCB1di5jb3VudDsgaSsrKSB7CmlmIChheGlzID09PSAndScpIHsKdXYuc2V0WChpLCAxLjAgLSB1di5nZXRYKGkpKTsKfSBlbHNlIHsKdXYuc2V0WShpLCAxLjAgLSB1di5nZXRZKGkpKTsKfQp9CnV2Lm5lZWRzVXBkYXRlID0gdHJ1ZTsKfQp9KTsKbG9nKGBGbGlwcGVkICR7YXhpcy50b1VwcGVyQ2FzZSgpfSBmb3IgJHtpZH1gLCAnaW5mbycpOwp9Cn0KdW5sb2FkQWxsKCkgewpjb25zdCBrZXlzID0gQXJyYXkuZnJvbSh0aGlzLm1vZGVscy5rZXlzKCkpOwprZXlzLmZvckVhY2goaWQgPT4gdGhpcy51bmxvYWRNb2RlbChpZCkpOwp9CmNlbnRlck1vZGVsKCkgewppZiAodGhpcy5tb2RlbHMuc2l6ZSA9PT0gMCkgewp0aGlzLmNhbWVyYS5wb3NpdGlvbi5zZXQoNSwgNSwgNSk7CnRoaXMuY29udHJvbHMudGFyZ2V0LnNldCgwLCAwLCAwKTsKdGhpcy5jb250cm9scy51cGRhdGUoKTsKbG9nKCJDYW1lcmEgcmVzZXQgdG8gZGVmYXVsdCB2aWV3IiwgImluZm8iKTsKcmV0dXJuOwp9CmNvbnN0IGJveCA9IG5ldyBUSFJFRS5Cb3gzKCk7CnRoaXMubW9kZWxzLmZvckVhY2goZ3JvdXAgPT4gYm94LmV4cGFuZEJ5T2JqZWN0KGdyb3VwKSk7CmNvbnN0IGNlbnRlciA9IGJveC5nZXRDZW50ZXIobmV3IFRIUkVFLlZlY3RvcjMoKSk7CmNvbnN0IHNpemUgPSBib3guZ2V0U2l6ZShuZXcgVEhSRUUuVmVjdG9yMygpKTsKLy8gQ2FsY3VsYXRlIHRoZSBjYW1lcmEgZGlzdGFuY2UgYmFzZWQgb24gYm91bmRpbmcgYm94IHNpemUKY29uc3QgbWF4RGltID0gTWF0aC5tYXgoc2l6ZS54LCBzaXplLnksIHNpemUueik7CmNvbnN0IGZvdiA9IHRoaXMuY2FtZXJhLmZvdiAqIChNYXRoLlBJIC8gMTgwKTsKbGV0IGNhbWVyYVogPSBNYXRoLmFicyhtYXhEaW0gLyAyIC8gTWF0aC50YW4oZm92IC8gMikpOwpjYW1lcmFaICo9IDEuNTsgLy8gWm9vbSBvdXQgYSBiaXQKaWYgKGNhbWVyYVogPT09IDApIGNhbWVyYVogPSAxMDsgLy8gRmFsbGJhY2sKLy8gUG9zaXRpb24gY2FtZXJhIHRvIGxvb2sgYXQgY2VudGVyCnRoaXMuY2FtZXJhLnBvc2l0aW9uLnNldChjZW50ZXIueCArIGNhbWVyYVosIGNlbnRlci55ICsgY2FtZXJhWiwgY2VudGVyLnogKyBjYW1lcmFaKTsKdGhpcy5jYW1lcmEubG9va0F0KGNlbnRlcik7Ci8vIFVwZGF0ZSBjb250cm9scyB0YXJnZXQgdG8gb3JiaXQgYXJvdW5kIHRoZSBtb2RlbCBjZW50ZXIKdGhpcy5jb250cm9scy50YXJnZXQuY29weShjZW50ZXIpOwp0aGlzLmNvbnRyb2xzLnVwZGF0ZSgpOwpsb2coIkNhbWVyYSByZXNldCB0byBtb2RlbCBjZW50ZXIiLCAiaW5mbyIpOwp9Ci8vIC0tLSBHaXptbyBNZXRob2RzIC0tLQp1cGRhdGVMaWdodChhemltdXRoLCBlbGV2YXRpb24sIGludGVuc2l0eSwgc2hhZG93cykgewppZiAoIXRoaXMuZGlyTGlnaHQpIHJldHVybjsKY29uc3QgcGhpID0gKDkwIC0gZWxldmF0aW9uKSAqIChNYXRoLlBJIC8gMTgwKTsKY29uc3QgdGhldGEgPSBhemltdXRoICogKE1hdGguUEkgLyAxODApOwp0aGlzLmRpckxpZ2h0LnBvc2l0aW9uLnNldCgKMTUgKiBNYXRoLnNpbihwaGkpICogTWF0aC5jb3ModGhldGEpLAoxNSAqIE1hdGguY29zKHBoaSksCjE1ICogTWF0aC5zaW4ocGhpKSAqIE1hdGguc2luKHRoZXRhKQopOwp0aGlzLmRpckxpZ2h0LmludGVuc2l0eSA9IGludGVuc2l0eTsKdGhpcy5kaXJMaWdodC5jYXN0U2hhZG93ID0gc2hhZG93czsKbG9nKGBMaWdodCB1cGRhdGVkOiBBemltdXRoICR7YXppbXV0aH0sIEVsZXZhdGlvbiAke2VsZXZhdGlvbn1gLCAnZGVidWcnKTsKfQphdHRhY2hHaXptbyhvYmplY3QpIHsKaWYgKG9iamVjdCkgewp0aGlzLnRyYW5zZm9ybUNvbnRyb2wuYXR0YWNoKG9iamVjdCk7CmxvZyhgR2l6bW8gYXR0YWNoZWQgdG86ICR7b2JqZWN0LnVzZXJEYXRhLm5hbWUgfHwgJ01vZGVsJ31gLCAnaW5mbycpOwp9IGVsc2Ugewp0aGlzLmRldGFjaEdpem1vKCk7Cn0KfQpkZXRhY2hHaXptbygpIHsKdGhpcy50cmFuc2Zvcm1Db250cm9sLmRldGFjaCgpOwp9CnNldEdpem1vTW9kZShtb2RlKSB7CnRoaXMudHJhbnNmb3JtQ29udHJvbC5zZXRNb2RlKG1vZGUpOwpsb2coYEdpem1vIG1vZGU6ICR7bW9kZX1gLCAnaW5mbycpOwp9CnNldEdpem1vU3BhY2Uoc3BhY2UpIHsKdGhpcy50cmFuc2Zvcm1Db250cm9sLnNldFNwYWNlKHNwYWNlKTsgLy8gJ3dvcmxkJyBvciAnbG9jYWwnCmxvZyhgR2l6bW8gc3BhY2U6ICR7c3BhY2V9YCwgJ2luZm8nKTsKfQovLyAtLS0gTXVsdGktU2VsZWN0aW9uICYgR3JvdXBpbmcgLS0tCi8vIENsZWFyIGN1cnJlbnQgc2VsZWN0aW9uOiBzcGVjaWZpYyBoZWxwZXIgdG8gZGV0YWNoIG9iamVjdHMgZnJvbSB0ZW1wIGdyb3VwIGJhY2sgdG8gc2NlbmUKY2xlYXJTZWxlY3Rpb24oKSB7CnRoaXMuZGV0YWNoR2l6bW8oKTsKdGhpcy5zZWxlY3RlZE9iamVjdHMgPSBbXTsKaWYgKCF0aGlzLnNlbGVjdGlvbkdyb3VwKSByZXR1cm47Ci8vIDEuIE1vdmUgY2hpbGRyZW4gYmFjayB0byBTY2VuZSAocHJlc2VydmluZyB3b3JsZCB0cmFuc2Zvcm1zKQovLyBXZSBpdGVyYXRlIGJhY2t3YXJkcyBvciB1c2UgYSB3aGlsZSBsb29wIGJlY2F1c2UgY2hpbGRyZW4gYXJyYXkgY2hhbmdlcyBvbiBhdHRhY2gKY29uc3QgY2hpbGRyZW4gPSBbLi4udGhpcy5zZWxlY3Rpb25Hcm91cC5jaGlsZHJlbl07IC8vIHNuYXBzaG90CmNoaWxkcmVuLmZvckVhY2goY2hpbGQgPT4gewp0aGlzLnNjZW5lLmF0dGFjaChjaGlsZCk7Cn0pOwovLyAyLiBSZW1vdmUgdGVtcCBncm91cAp0aGlzLnNjZW5lLnJlbW92ZSh0aGlzLnNlbGVjdGlvbkdyb3VwKTsKdGhpcy5zZWxlY3Rpb25Hcm91cCA9IG51bGw7Cn0KdXBkYXRlU2VsZWN0aW9uR3JvdXAob2JqZWN0cykgewovLyBJZiB3ZSBhbHJlYWR5IGhhdmUgYSBncm91cCwgZGlzYmFuZCBpdCBmaXJzdCB0byByZXNldAp0aGlzLmNsZWFyU2VsZWN0aW9uKCk7CmlmIChvYmplY3RzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwp0aGlzLnNlbGVjdGVkT2JqZWN0cyA9IG9iamVjdHM7CmlmIChvYmplY3RzLmxlbmd0aCA9PT0gMSkgewovLyBTaW5nbGUgb2JqZWN0OiBzaW1wbGUgYXR0YWNoCnRoaXMuYXR0YWNoR2l6bW8ob2JqZWN0c1swXSk7CnJldHVybjsKfQovLyBNdWx0aXBsZSBvYmplY3RzOiBDcmVhdGUgbWVkaWFuIGdyb3VwCnRoaXMuc2VsZWN0aW9uR3JvdXAgPSBuZXcgVEhSRUUuR3JvdXAoKTsKdGhpcy5zY2VuZS5hZGQodGhpcy5zZWxlY3Rpb25Hcm91cCk7Ci8vIDEuIENhbGN1bGF0ZSBNZWRpYW4gUG9pbnQgKENlbnRlciBvZiBhbGwgYm91bmRpbmcgYm94ZXMpCmNvbnN0IGNvbWJpbmVkQm94ID0gbmV3IFRIUkVFLkJveDMoKTsKb2JqZWN0cy5mb3JFYWNoKG9iaiA9PiB7CmNvbnN0IGJveCA9IG5ldyBUSFJFRS5Cb3gzKCkuc2V0RnJvbU9iamVjdChvYmopOwppZiAoIWJveC5pc0VtcHR5KCkpIGNvbWJpbmVkQm94LnVuaW9uKGJveCk7Cn0pOwpjb25zdCBjZW50ZXIgPSBjb21iaW5lZEJveC5nZXRDZW50ZXIobmV3IFRIUkVFLlZlY3RvcjMoKSk7Ci8vIDIuIFBvc2l0aW9uIGdyb3VwIGF0IG1lZGlhbiBjZW50ZXIKdGhpcy5zZWxlY3Rpb25Hcm91cC5wb3NpdGlvbi5jb3B5KGNlbnRlcik7Ci8vIDMuIEF0dGFjaCBhbGwgb2JqZWN0cyB0byB0aGlzIGdyb3VwIChwcmVzZXJ2ZXMgd29ybGQgdHJhbnNmb3JtKQpvYmplY3RzLmZvckVhY2gob2JqID0+IHsKdGhpcy5zZWxlY3Rpb25Hcm91cC5hdHRhY2gob2JqKTsKfSk7Ci8vIDQuIEF0dGFjaCBHaXptbyB0byBncm91cAp0aGlzLmF0dGFjaEdpem1vKHRoaXMuc2VsZWN0aW9uR3JvdXApOwp0aGlzLnNlbGVjdGlvbkdyb3VwLnVzZXJEYXRhLm5hbWUgPSAiU2VsZWN0aW9uIEdyb3VwIjsKfQovLyBSYXljYXN0IFNpbmdsZSAoSGVscGVyKSByZXR1cm5zIHRoZSBtb2RlbCBncm91cApyYXljYXN0KG1vdXNlKSB7CmNvbnN0IHJheWNhc3RlciA9IG5ldyBUSFJFRS5SYXljYXN0ZXIoKTsKcmF5Y2FzdGVyLnNldEZyb21DYW1lcmEobW91c2UsIHRoaXMuY2FtZXJhKTsKY29uc3QgaW50ZXJzZWN0YWJsZVBhcmFtcyA9IFtdOwp0aGlzLm1vZGVscy5mb3JFYWNoKGdyb3VwID0+IGludGVyc2VjdGFibGVQYXJhbXMucHVzaChncm91cCkpOwpjb25zdCBpbnRlcnNlY3RzID0gcmF5Y2FzdGVyLmludGVyc2VjdE9iamVjdHMoaW50ZXJzZWN0YWJsZVBhcmFtcywgdHJ1ZSk7CmlmIChpbnRlcnNlY3RzLmxlbmd0aCA+IDApIHsKbGV0IHNlbGVjdGVkID0gaW50ZXJzZWN0c1swXS5vYmplY3Q7Ci8vIEZpbmQgcGFyZW50IGdyb3VwIG1vZGVsCndoaWxlIChzZWxlY3RlZC5wYXJlbnQgJiYgc2VsZWN0ZWQucGFyZW50LnR5cGUgIT09ICdTY2VuZScpIHsKaWYgKHRoaXMubW9kZWxzLmhhcyhzZWxlY3RlZC5wYXJlbnQudXVpZCkgfHwgQXJyYXkuZnJvbSh0aGlzLm1vZGVscy52YWx1ZXMoKSkuaW5jbHVkZXMoc2VsZWN0ZWQucGFyZW50KSkgewpyZXR1cm4gc2VsZWN0ZWQucGFyZW50Owp9CnNlbGVjdGVkID0gc2VsZWN0ZWQucGFyZW50Owp9Cn0KcmV0dXJuIG51bGw7Cn0KLy8gU2VsZWN0IG9iamVjdCBieSBtb3VzZSBjbGljayAoUmF5Y2FzdGluZykKc2VsZWN0T2JqZWN0KG1vdXNlLCB3aWR0aCwgaGVpZ2h0KSB7CmNvbnN0IHJheWNhc3RlciA9IG5ldyBUSFJFRS5SYXljYXN0ZXIoKTsKcmF5Y2FzdGVyLnNldEZyb21DYW1lcmEobW91c2UsIHRoaXMuY2FtZXJhKTsKY29uc3QgaW50ZXJzZWN0YWJsZVBhcmFtcyA9IFtdOwp0aGlzLm1vZGVscy5mb3JFYWNoKGdyb3VwID0+IGludGVyc2VjdGFibGVQYXJhbXMucHVzaChncm91cCkpOwpjb25zdCBpbnRlcnNlY3RzID0gcmF5Y2FzdGVyLmludGVyc2VjdE9iamVjdHMoaW50ZXJzZWN0YWJsZVBhcmFtcywgdHJ1ZSk7CmlmIChpbnRlcnNlY3RzLmxlbmd0aCA+IDApIHsKLy8gRmluZCB0aGUgdG9wLWxldmVsIGdyb3VwICh3aGljaCByZXByZXNlbnRzIHRoZSBtb2RlbCkKbGV0IHNlbGVjdGVkID0gaW50ZXJzZWN0c1swXS5vYmplY3Q7CndoaWxlIChzZWxlY3RlZC5wYXJlbnQgJiYgc2VsZWN0ZWQucGFyZW50LnR5cGUgIT09ICdTY2VuZScpIHsKaWYgKHRoaXMubW9kZWxzLmhhcyhzZWxlY3RlZC5wYXJlbnQudXVpZCkgfHwgQXJyYXkuZnJvbSh0aGlzLm1vZGVscy52YWx1ZXMoKSkuaW5jbHVkZXMoc2VsZWN0ZWQucGFyZW50KSkgewpzZWxlY3RlZCA9IHNlbGVjdGVkLnBhcmVudDsKYnJlYWs7Cn0Kc2VsZWN0ZWQgPSBzZWxlY3RlZC5wYXJlbnQ7Cn0KLy8gSWYgd2UgZm91bmQgYSBncm91cCB0aGF0IGlzIGluIG91ciBtb2RlbHMgbWFwCnJldHVybiBzZWxlY3RlZDsKfQpyZXR1cm4gbnVsbDsKfQp9Ci8vIC0tLSBBcHAgQ29tcG9uZW50IC0tLQpjbGFzcyBBcHAgewpjb25zdHJ1Y3RvcigpIHsKdGhpcy52aWV3ZXIgPSBuZXcgVmlld2VyKCd2aWV3ZXItY2FudmFzJyk7CnRoaXMucGFyc2VyID0gbmV3IEIzRFBhcnNlcigpOwp0aGlzLmxvYWRlZE1vZGVscyA9IG5ldyBNYXAoKTsgLy8gSUQgLT4gSW5mbwp0aGlzLmVsZW1lbnRzID0gewpvdmVybGF5OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndWktb3ZlcmxheScpLApmaWxlSW5wdXQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlLWlucHV0JyksCmZvbGRlcklucHV0OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZGVyLWlucHV0JyksCmxvYWRpbmc6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nLW92ZXJsYXknKSwKbWVzaExpc3Q6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZXNoLWxpc3QnKSwKbWVzaEl0ZW1zOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVzaC1pdGVtcycpLAp1bmxvYWRBbGxCdG46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1bmxvYWQtYWxsJyksCnJlc2V0Q2FtZXJhQnRuOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzZXQtY2FtJyksCnRvZ2dsZUxpc3RCdG46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtbGlzdC1idG4nKSwKaW5mb0J0bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm8tYnRuJyksCmluZm9Nb2RhbDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm8tbW9kYWwnKSwKY2xvc2VJbmZvQnRuOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2xvc2UtaW5mbycpLAovLyBTcGxhc2ggU2NyZWVuCnNwbGFzaDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NwbGFzaC1zY3JlZW4nKSwKLy8gVHJhbnNmb3JtIFVJCnRyYW5zZm9ybVRvb2xiYXI6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmFuc2Zvcm0tdG9vbGJhcicpLAovLyBTZXR0aW5ncyBQYW5lbApzZXR0aW5nc0J0bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzLWJ0bicpLApzZXR0aW5nc1BhbmVsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0dGluZ3MtcGFuZWwnKSwKY2xvc2VTZXR0aW5nc0J0bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nsb3NlLXNldHRpbmdzJyksCmxpZ2h0QXppbXV0aDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpZ2h0LWF6aW11dGgnKSwKbGlnaHRFbGV2YXRpb246IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaWdodC1lbGV2YXRpb24nKSwKbGlnaHRJbnRlbnNpdHk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaWdodC1pbnRlbnNpdHknKSwKdG9nZ2xlU2hhZG93czogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1zaGFkb3dzJyksCmNhbWVyYVRvZ2dsZUJ0bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbWVyYS10b2dnbGUtYnRuJyksCmJ0blRyYW5zbGF0ZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyYW5zbGF0ZS1idG4nKSwKYnRuUm90YXRlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm90YXRlLWJ0bicpLApidG5TY2FsZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYWxlLWJ0bicpLApidG5Cb3hTZWxlY3Q6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdib3gtc2VsZWN0LWJ0bicpLApzcGFjZVRvZ2dsZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvY2FsLXNwYWNlLXRvZ2dsZScpLAovLyBNb2JpbGUgVUkKb2JqZWN0Q29vcmRzOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb2JqZWN0LWNvb3JkcycpLAptb2JpbGVUcmFuc2Zvcm1VSTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vYmlsZS10cmFuc2Zvcm0tdWknKSwKc2xpZGVyWDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NsaWRlci14JyksCnNsaWRlclk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzbGlkZXIteScpLApzbGlkZXJaOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2xpZGVyLXonKSwKc2VsZWN0aW9uQm94OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsZWN0aW9uLWJveCcpLApjbG9zZURlYnVnQnRuOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2xvc2UtZGVidWcnKSwKZGVidWdCb3g6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWJ1Zy1ib3gnKSwKbW9iaWxlVHJhbnNmb3JtQnRuOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9iaWxlLXRyYW5zZm9ybS1idG4nKSwKdG9nZ2xlRGVidWdCdG46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtZGVidWctYnRuJyksCm1vYmlsZVRyYW5zZm9ybVVJOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9iaWxlLXRyYW5zZm9ybS11aScpLAp9Owp0aGlzLmJveFNlbGVjdE1vZGUgPSBmYWxzZTsKdGhpcy5tb2JpbGVUcmFuc2Zvcm1Nb2RlID0gJ25vbmUnOwp0aGlzLmluaXQoKTsKfQppbml0KCkgewovLyBJbml0aWFsaXplIExvY2FsaXphdGlvbgppMThuID0gbmV3IEkxOG4oKTsKaTE4bi5hcHBseSgpOwovLyBEaXNtaXNzIFNwbGFzaCBTY3JlZW4Kc2V0VGltZW91dCgoKSA9PiB7CmlmICh0aGlzLmVsZW1lbnRzLnNwbGFzaCkgewp0aGlzLmVsZW1lbnRzLnNwbGFzaC5jbGFzc0xpc3QuYWRkKCdmYWRlLW91dCcpOwpzZXRUaW1lb3V0KCgpID0+IHRoaXMuZWxlbWVudHMuc3BsYXNoLnN0eWxlLmRpc3BsYXkgPSAnbm9uZScsIDgwMCk7Cn0KfSwgMTUwMCk7Ci8vIFNldHRpbmdzIFBhbmVsIFRvZ2dsZXMKaWYgKHRoaXMuZWxlbWVudHMuc2V0dGluZ3NCdG4pIHsKdGhpcy5lbGVtZW50cy5zZXR0aW5nc0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7CmUuc3RvcFByb3BhZ2F0aW9uKCk7CnRoaXMuZWxlbWVudHMuc2V0dGluZ3NQYW5lbC5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTsKfSk7Cn0KaWYgKHRoaXMuZWxlbWVudHMuY2xvc2VTZXR0aW5nc0J0bikgewp0aGlzLmVsZW1lbnRzLmNsb3NlU2V0dGluZ3NCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CnRoaXMuZWxlbWVudHMuc2V0dGluZ3NQYW5lbC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKfSk7Cn0KLy8gTGlnaHQgQ29udHJvbHMKY29uc3QgdXBkYXRlTGlnaHQgPSAoKSA9PiB7CmNvbnN0IGF6ID0gcGFyc2VGbG9hdCh0aGlzLmVsZW1lbnRzLmxpZ2h0QXppbXV0aC52YWx1ZSk7CmNvbnN0IGVsID0gcGFyc2VGbG9hdCh0aGlzLmVsZW1lbnRzLmxpZ2h0RWxldmF0aW9uLnZhbHVlKTsKY29uc3QgaW50ZW5zaXR5ID0gcGFyc2VGbG9hdCh0aGlzLmVsZW1lbnRzLmxpZ2h0SW50ZW5zaXR5LnZhbHVlKTsKY29uc3Qgc2hhZG93cyA9IHRoaXMuZWxlbWVudHMudG9nZ2xlU2hhZG93cy5jaGVja2VkOwp0aGlzLnZpZXdlci51cGRhdGVMaWdodChheiwgZWwsIGludGVuc2l0eSwgc2hhZG93cyk7Cn07CmlmICh0aGlzLmVsZW1lbnRzLmxpZ2h0QXppbXV0aCkgewp0aGlzLmVsZW1lbnRzLmxpZ2h0QXppbXV0aC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHVwZGF0ZUxpZ2h0KTsKdGhpcy5lbGVtZW50cy5saWdodEVsZXZhdGlvbi5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHVwZGF0ZUxpZ2h0KTsKdGhpcy5lbGVtZW50cy5saWdodEludGVuc2l0eS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHVwZGF0ZUxpZ2h0KTsKdGhpcy5lbGVtZW50cy50b2dnbGVTaGFkb3dzLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHVwZGF0ZUxpZ2h0KTsKfQovLyBDYW1lcmEgVG9nZ2xlIGxvZ2ljCmlmICh0aGlzLmVsZW1lbnRzLmNhbWVyYVRvZ2dsZUJ0bikgewp0aGlzLmVsZW1lbnRzLmNhbWVyYVRvZ2dsZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKdGhpcy52aWV3ZXIudG9nZ2xlQ2FtZXJhUHJvamVjdGlvbigpOwp9KTsKfQovLyBNZXNoIExpc3QgVG9nZ2xlIChNb2JpbGUpCmlmICh0aGlzLmVsZW1lbnRzLnRvZ2dsZUxpc3RCdG4pIHsKdGhpcy5lbGVtZW50cy50b2dnbGVMaXN0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKLy8gU3RvcCBwcm9wYWdhdGlvbiBzbyBjbGlja2luZyB0aGUgYnV0dG9uIGRvZXNuJ3QgdHJpZ2dlciBkb2N1bWVudCBjbGljayAoaWYgd2UgYWRkIG91dHNpZGUgY2xpY2sgY2xvc2UpCmUuc3RvcFByb3BhZ2F0aW9uKCk7CnRoaXMuZWxlbWVudHMubWVzaExpc3QuY2xhc3NMaXN0LnRvZ2dsZSgnZXhwYW5kZWQnKTsKfSk7Ci8vIENsb3NlIG1lbnUgd2hlbiBjbGlja2luZyBvdXRzaWRlCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKaWYgKHdpbmRvdy5pbm5lcldpZHRoIDw9IDc2OCAmJgp0aGlzLmVsZW1lbnRzLm1lc2hMaXN0LmNsYXNzTGlzdC5jb250YWlucygnZXhwYW5kZWQnKSAmJgohdGhpcy5lbGVtZW50cy5tZXNoTGlzdC5jb250YWlucyhlLnRhcmdldCkpIHsKdGhpcy5lbGVtZW50cy5tZXNoTGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdleHBhbmRlZCcpOwp9Cn0pOwp9Ci8vIEluZGl2aWR1YWwgRmlsZXMKdGhpcy5lbGVtZW50cy5maWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHRoaXMuaGFuZGxlRmlsZXMoQXJyYXkuZnJvbShlLnRhcmdldC5maWxlcykpKTsKLy8gRm9sZGVyIElucHV0CmlmICh0aGlzLmVsZW1lbnRzLmZvbGRlcklucHV0KSB7CnRoaXMuZWxlbWVudHMuZm9sZGVySW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHRoaXMuaGFuZGxlRmlsZXMoQXJyYXkuZnJvbShlLnRhcmdldC5maWxlcykpKTsKfQovLyBVbmxvYWQgQWxsCmlmICh0aGlzLmVsZW1lbnRzLnVubG9hZEFsbEJ0bikgewp0aGlzLmVsZW1lbnRzLnVubG9hZEFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKdGhpcy52aWV3ZXIudW5sb2FkQWxsKCk7CnRoaXMubG9hZGVkTW9kZWxzLmNsZWFyKCk7CnRoaXMudXBkYXRlTWVzaExpc3QoKTsKdGhpcy5lbGVtZW50cy5tZXNoTGlzdC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKdGhpcy5lbGVtZW50cy5vdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpOwp9KTsKfQovLyBCb3ggU2VsZWN0IFRvZ2dsZQppZiAodGhpcy5lbGVtZW50cy5idG5Cb3hTZWxlY3QpIHsKdGhpcy5lbGVtZW50cy5idG5Cb3hTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CnRoaXMuYm94U2VsZWN0TW9kZSA9ICF0aGlzLmJveFNlbGVjdE1vZGU7CnRoaXMuZWxlbWVudHMuYnRuQm94U2VsZWN0LmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIHRoaXMuYm94U2VsZWN0TW9kZSk7CmxvZyhgQm94IFNlbGVjdGlvbiBNb2RlOiAke3RoaXMuYm94U2VsZWN0TW9kZSA/ICdFTkFCTEVEJyA6ICdESVNBQkxFRCd9YCwgJ2luZm8nKTsKLy8gSWYgZXhpdGluZyBib3ggc2VsZWN0LCBlbnN1cmUgY29udHJvbHMgYXJlIGJhY2sgb24KaWYgKCF0aGlzLmJveFNlbGVjdE1vZGUpIHsKdGhpcy52aWV3ZXIuY29udHJvbHMuZW5hYmxlZCA9IHRydWU7Cn0KfSk7Cn0KLy8gUmVzZXQgQ2FtZXJhCmlmICh0aGlzLmVsZW1lbnRzLnJlc2V0Q2FtZXJhQnRuKSB7CnRoaXMuZWxlbWVudHMucmVzZXRDYW1lcmFCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewplLnByZXZlbnREZWZhdWx0KCk7CmxvZygiUmVzZXQgQ2FtZXJhIHRyaWdnZXJlZCIsICJpbmZvIik7CnRoaXMudmlld2VyLmNlbnRlck1vZGVsKCk7Cn0pOwp9Ci8vIEluZm8gTW9kYWwKaWYgKHRoaXMuZWxlbWVudHMuaW5mb0J0biAmJiB0aGlzLmVsZW1lbnRzLmluZm9Nb2RhbCAmJiB0aGlzLmVsZW1lbnRzLmNsb3NlSW5mb0J0bikgewp0aGlzLmVsZW1lbnRzLmluZm9CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewplLnN0b3BQcm9wYWdhdGlvbigpOwp0aGlzLmVsZW1lbnRzLmluZm9Nb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKfSk7CnRoaXMuZWxlbWVudHMuY2xvc2VJbmZvQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewp0aGlzLmVsZW1lbnRzLmluZm9Nb2RhbC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKfSk7Ci8vIENsaWNrIG91dHNpZGUgdG8gY2xvc2UKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewppZiAoIXRoaXMuZWxlbWVudHMuaW5mb01vZGFsLmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykgJiYKIXRoaXMuZWxlbWVudHMuaW5mb01vZGFsLmNvbnRhaW5zKGUudGFyZ2V0KSAmJgplLnRhcmdldCAhPT0gdGhpcy5lbGVtZW50cy5pbmZvQnRuICYmCiF0aGlzLmVsZW1lbnRzLmluZm9CdG4uY29udGFpbnMoZS50YXJnZXQpKSB7CnRoaXMuZWxlbWVudHMuaW5mb01vZGFsLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwp9Cn0pOwp9Ci8vIERlYnVnIEJveCBUb2dnbGUKaWYgKHRoaXMuZWxlbWVudHMuY2xvc2VEZWJ1Z0J0biAmJiB0aGlzLmVsZW1lbnRzLmRlYnVnQm94KSB7CnRoaXMuZWxlbWVudHMuY2xvc2VEZWJ1Z0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7CmUuc3RvcFByb3BhZ2F0aW9uKCk7CnRoaXMuZWxlbWVudHMuZGVidWdCb3guY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7CnRoaXMuZWxlbWVudHMuZGVidWdCb3guc3R5bGUuZGlzcGxheSA9ICdub25lJzsKd2luZG93LmRlYnVnRXhwbGljaXRseUhpZGRlbiA9IHRydWU7IC8vIFVzZSBnbG9iYWwgdG8gbGV0IGxvZygpIGtub3cKfSk7Cn0KaWYgKHRoaXMuZWxlbWVudHMudG9nZ2xlRGVidWdCdG4gJiYgdGhpcy5lbGVtZW50cy5kZWJ1Z0JveCkgewp0aGlzLmVsZW1lbnRzLnRvZ2dsZURlYnVnQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewpjb25zdCBpc0hpZGRlbiA9IHRoaXMuZWxlbWVudHMuZGVidWdCb3guY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKTsKaWYgKGlzSGlkZGVuKSB7CnRoaXMuZWxlbWVudHMuZGVidWdCb3guY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CnRoaXMuZWxlbWVudHMuZGVidWdCb3guc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKd2luZG93LmRlYnVnRXhwbGljaXRseUhpZGRlbiA9IGZhbHNlOwp9IGVsc2Ugewp0aGlzLmVsZW1lbnRzLmRlYnVnQm94LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwp0aGlzLmVsZW1lbnRzLmRlYnVnQm94LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CndpbmRvdy5kZWJ1Z0V4cGxpY2l0bHlIaWRkZW4gPSB0cnVlOwp9Cn0pOwp9Ci8vIC0tLSBUcmFuc2Zvcm0gR2l6bW8gSW50ZXJhY3Rpb25zIC0tLQpsZXQgaXNEcmFnZ2luZ0dpem1vID0gZmFsc2U7CmlmICh0aGlzLnZpZXdlci50cmFuc2Zvcm1Db250cm9sKSB7CnRoaXMudmlld2VyLnRyYW5zZm9ybUNvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2dpbmctY2hhbmdlZCcsIChldmVudCkgPT4gewppc0RyYWdnaW5nR2l6bW8gPSBldmVudC52YWx1ZTsKfSk7Cn0KLy8gU2VsZWN0aW9uIFN0YXRlCmxldCBpc1NlbGVjdGluZyA9IGZhbHNlOwpsZXQgc2VsZWN0U3RhcnQgPSB7IHg6IDAsIHk6IDAgfTsKLy8gQ2FudmFzIENsaWNrIGZvciBTZWxlY3Rpb24KdGhpcy52aWV3ZXIuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7CnRoaXMubW91c2VEb3duVGltZSA9IERhdGUubm93KCk7CnRoaXMubW91c2VEb3duUG9zID0geyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9OwppZiAodGhpcy5ib3hTZWxlY3RNb2RlICYmICFpc0RyYWdnaW5nR2l6bW8pIHsKaXNTZWxlY3RpbmcgPSB0cnVlOwpzZWxlY3RTdGFydCA9IHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsKdGhpcy52aWV3ZXIuY29udHJvbHMuZW5hYmxlZCA9IGZhbHNlOwovLyBTaG93IGJveAppZiAodGhpcy5lbGVtZW50cy5zZWxlY3Rpb25Cb3gpIHsKdGhpcy5lbGVtZW50cy5zZWxlY3Rpb25Cb3guY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CnRoaXMuZWxlbWVudHMuc2VsZWN0aW9uQm94LnN0eWxlLmxlZnQgPSBgJHtlLmNsaWVudFh9cHhgOwp0aGlzLmVsZW1lbnRzLnNlbGVjdGlvbkJveC5zdHlsZS50b3AgPSBgJHtlLmNsaWVudFl9cHhgOwp0aGlzLmVsZW1lbnRzLnNlbGVjdGlvbkJveC5zdHlsZS53aWR0aCA9ICcwcHgnOwp0aGlzLmVsZW1lbnRzLnNlbGVjdGlvbkJveC5zdHlsZS5oZWlnaHQgPSAnMHB4JzsKfQp9Cn0pOwp0aGlzLnZpZXdlci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKGUpID0+IHsKaWYgKGlzU2VsZWN0aW5nICYmIHRoaXMuZWxlbWVudHMuc2VsZWN0aW9uQm94KSB7CmNvbnN0IGN1cnJlbnRYID0gZS5jbGllbnRYOwpjb25zdCBjdXJyZW50WSA9IGUuY2xpZW50WTsKY29uc3QgbGVmdCA9IE1hdGgubWluKHNlbGVjdFN0YXJ0LngsIGN1cnJlbnRYKTsKY29uc3QgdG9wID0gTWF0aC5taW4oc2VsZWN0U3RhcnQueSwgY3VycmVudFkpOwpjb25zdCB3aWR0aCA9IE1hdGguYWJzKGN1cnJlbnRYIC0gc2VsZWN0U3RhcnQueCk7CmNvbnN0IGhlaWdodCA9IE1hdGguYWJzKGN1cnJlbnRZIC0gc2VsZWN0U3RhcnQueSk7CnRoaXMuZWxlbWVudHMuc2VsZWN0aW9uQm94LnN0eWxlLmxlZnQgPSBgJHtsZWZ0fXB4YDsKdGhpcy5lbGVtZW50cy5zZWxlY3Rpb25Cb3guc3R5bGUudG9wID0gYCR7dG9wfXB4YDsKdGhpcy5lbGVtZW50cy5zZWxlY3Rpb25Cb3guc3R5bGUud2lkdGggPSBgJHt3aWR0aH1weGA7CnRoaXMuZWxlbWVudHMuc2VsZWN0aW9uQm94LnN0eWxlLmhlaWdodCA9IGAke2hlaWdodH1weGA7Cn0KfSk7CnRoaXMudmlld2VyLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKGUpID0+IHsKaWYgKGlzU2VsZWN0aW5nKSB7CmlzU2VsZWN0aW5nID0gZmFsc2U7CmlmICh0aGlzLmVsZW1lbnRzLnNlbGVjdGlvbkJveCkgewp0aGlzLmVsZW1lbnRzLnNlbGVjdGlvbkJveC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKfQpjb25zdCBzZWxlY3RFbmQgPSB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07CmNvbnN0IGRpc3QgPSBNYXRoLnNxcnQoTWF0aC5wb3coc2VsZWN0RW5kLnggLSBzZWxlY3RTdGFydC54LCAyKSArIE1hdGgucG93KHNlbGVjdEVuZC55IC0gc2VsZWN0U3RhcnQueSwgMikpOwppZiAoZGlzdCA+IDUpIHsKdGhpcy5wZXJmb3JtQm94U2VsZWN0aW9uKHNlbGVjdFN0YXJ0LCBzZWxlY3RFbmQpOwp9CnRoaXMudmlld2VyLmNvbnRyb2xzLmVuYWJsZWQgPSB0cnVlOwpyZXR1cm47Cn0KLy8gT25seSBzZWxlY3QgaWYgaXQgd2FzIGEgY2xpY2ssIG5vdCBhIGRyYWcKaWYgKGlzRHJhZ2dpbmdHaXptbykgcmV0dXJuOwpjb25zdCB0aW1lRGlmZiA9IERhdGUubm93KCkgLSB0aGlzLm1vdXNlRG93blRpbWU7CmNvbnN0IGRpc3REaWZmID0gTWF0aC5zcXJ0KE1hdGgucG93KGUuY2xpZW50WCAtIHRoaXMubW91c2VEb3duUG9zLngsIDIpICsgTWF0aC5wb3coZS5jbGllbnRZIC0gdGhpcy5tb3VzZURvd25Qb3MueSwgMikpOwppZiAodGltZURpZmYgPCAyMDAgJiYgZGlzdERpZmYgPCA1KSB7CmNvbnN0IHJlY3QgPSB0aGlzLnZpZXdlci5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CmNvbnN0IG1vdXNlID0gbmV3IFRIUkVFLlZlY3RvcjIoCigoZS5jbGllbnRYIC0gcmVjdC5sZWZ0KSAvIHJlY3Qud2lkdGgpICogMiAtIDEsCi0oKGUuY2xpZW50WSAtIHJlY3QudG9wKSAvIHJlY3QuaGVpZ2h0KSAqIDIgKyAxCik7CmNvbnN0IHNlbGVjdGVkID0gdGhpcy52aWV3ZXIuc2VsZWN0T2JqZWN0KG1vdXNlKTsKdGhpcy51cGRhdGVTZWxlY3Rpb25VSShzZWxlY3RlZCA/IFtzZWxlY3RlZF0gOiBbXSk7Cn0KfSk7Ci8vIFRvb2xiYXIgQnV0dG9ucwpjb25zdCB1cGRhdGVBY3RpdmVCdG4gPSAoYWN0aXZlSWQpID0+IHsKW3RoaXMuZWxlbWVudHMuYnRuVHJhbnNsYXRlLCB0aGlzLmVsZW1lbnRzLmJ0blJvdGF0ZSwgdGhpcy5lbGVtZW50cy5idG5TY2FsZV0uZm9yRWFjaChidG4gPT4gewppZiAoYnRuKSBidG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7Cn0pOwppZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYWN0aXZlSWQpKSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhY3RpdmVJZCkuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7Cn07CmlmICh0aGlzLmVsZW1lbnRzLmJ0blRyYW5zbGF0ZSkgewp0aGlzLmVsZW1lbnRzLmJ0blRyYW5zbGF0ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKdGhpcy52aWV3ZXIuc2V0R2l6bW9Nb2RlKCd0cmFuc2xhdGUnKTsKdXBkYXRlQWN0aXZlQnRuKCd0cmFuc2xhdGUtYnRuJyk7Cn0pOwp9CmlmICh0aGlzLmVsZW1lbnRzLmJ0blJvdGF0ZSkgewp0aGlzLmVsZW1lbnRzLmJ0blJvdGF0ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKdGhpcy52aWV3ZXIuc2V0R2l6bW9Nb2RlKCdyb3RhdGUnKTsKdXBkYXRlQWN0aXZlQnRuKCdyb3RhdGUtYnRuJyk7Cn0pOwp9CmlmICh0aGlzLmVsZW1lbnRzLmJ0blNjYWxlKSB7CnRoaXMuZWxlbWVudHMuYnRuU2NhbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CnRoaXMudmlld2VyLnNldEdpem1vTW9kZSgnc2NhbGUnKTsKdXBkYXRlQWN0aXZlQnRuKCdzY2FsZS1idG4nKTsKfSk7Cn0KaWYgKHRoaXMuZWxlbWVudHMuc3BhY2VUb2dnbGUpIHsKdGhpcy5lbGVtZW50cy5zcGFjZVRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gewp0aGlzLnZpZXdlci5zZXRHaXptb1NwYWNlKGUudGFyZ2V0LmNoZWNrZWQgPyAnbG9jYWwnIDogJ3dvcmxkJyk7Cn0pOwp9Ci8vIE1vYmlsZSBUcmFuc2Zvcm0gTW9kZSBDeWNsaW5nCmlmICh0aGlzLmVsZW1lbnRzLm1vYmlsZVRyYW5zZm9ybUJ0bikgewp0aGlzLmVsZW1lbnRzLm1vYmlsZVRyYW5zZm9ybUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKY29uc3QgbW9kZXMgPSBbJ3RyYW5zbGF0ZScsICdyb3RhdGUnLCAnc2NhbGUnLCAnbm9uZSddOwpsZXQgY3VycmVudElkeCA9IG1vZGVzLmluZGV4T2YodGhpcy5tb2JpbGVUcmFuc2Zvcm1Nb2RlKTsKbGV0IG5leHRJZHggPSAoY3VycmVudElkeCArIDEpICUgbW9kZXMubGVuZ3RoOwp0aGlzLm1vYmlsZVRyYW5zZm9ybU1vZGUgPSBtb2Rlc1tuZXh0SWR4XTsKdGhpcy5lbGVtZW50cy5tb2JpbGVUcmFuc2Zvcm1CdG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlLXRyYW5zbGF0ZScsICdhY3RpdmUtcm90YXRlJywgJ2FjdGl2ZS1zY2FsZScpOwppZiAodGhpcy5tb2JpbGVUcmFuc2Zvcm1Nb2RlID09PSAnbm9uZScpIHsKdGhpcy52aWV3ZXIuZGV0YWNoR2l6bW8oKTsKaWYgKHRoaXMuZWxlbWVudHMubW9iaWxlVHJhbnNmb3JtVUkpIHsKdGhpcy5lbGVtZW50cy5tb2JpbGVUcmFuc2Zvcm1VSS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKdGhpcy5lbGVtZW50cy5tb2JpbGVUcmFuc2Zvcm1VSS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKfQpsb2coIk1vYmlsZSBUcmFuc2Zvcm06IE9GRiIsICJpbmZvIik7Cn0gZWxzZSB7CnRoaXMudmlld2VyLnNldEdpem1vTW9kZSh0aGlzLm1vYmlsZVRyYW5zZm9ybU1vZGUpOwp0aGlzLmVsZW1lbnRzLm1vYmlsZVRyYW5zZm9ybUJ0bi5jbGFzc0xpc3QuYWRkKGBhY3RpdmUtJHt0aGlzLm1vYmlsZVRyYW5zZm9ybU1vZGV9YCk7CnVwZGF0ZUFjdGl2ZUJ0bihgJHt0aGlzLm1vYmlsZVRyYW5zZm9ybU1vZGV9LWJ0bmApOyAvLyBTeW5jIGRlc2t0b3AgdG9vbGJhciBpZiBhbnkKaWYgKHRoaXMuZWxlbWVudHMubW9iaWxlVHJhbnNmb3JtVUkpIHsKdGhpcy5lbGVtZW50cy5tb2JpbGVUcmFuc2Zvcm1VSS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKdGhpcy5lbGVtZW50cy5tb2JpbGVUcmFuc2Zvcm1VSS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKfQpsb2coYE1vYmlsZSBUcmFuc2Zvcm06ICR7dGhpcy5tb2JpbGVUcmFuc2Zvcm1Nb2RlLnRvVXBwZXJDYXNlKCl9YCwgImluZm8iKTsKLy8gRW5zdXJlIGdpem1vIGlzIGF0dGFjaGVkIGlmIHNvbWV0aGluZyBpcyBzZWxlY3RlZApjb25zdCBvYmogPSB0aGlzLnZpZXdlci50cmFuc2Zvcm1Db250cm9sLm9iamVjdDsKaWYgKCFvYmogJiYgdGhpcy52aWV3ZXIuc2VsZWN0ZWRPYmplY3RzICYmIHRoaXMudmlld2VyLnNlbGVjdGVkT2JqZWN0cy5sZW5ndGggPiAwKSB7CnRoaXMudmlld2VyLnVwZGF0ZVNlbGVjdGlvbkdyb3VwKHRoaXMudmlld2VyLnNlbGVjdGVkT2JqZWN0cyk7Cn0KfQp9KTsKfQovLyBPYmplY3QgQ29vcmQgU3luYwppZiAodGhpcy52aWV3ZXIudHJhbnNmb3JtQ29udHJvbCkgewp0aGlzLnZpZXdlci50cmFuc2Zvcm1Db250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHsKdGhpcy51cGRhdGVPYmplY3RDb29yZHMoKTsKaWYgKHRoaXMuc2VsZWN0aW9uSGVscGVyKSB0aGlzLnNlbGVjdGlvbkhlbHBlci51cGRhdGUoKTsKfSk7Cn0KLy8gLS0tIFVuZG8gU3lzdGVtIC0tLQp0aGlzLmhpc3RvcnkgPSBbXTsKdGhpcy5tYXhIaXN0b3J5ID0gNTA7Ci8vIENhcHR1cmUgc3RhdGUgb24gRHJhZyBTdGFydApsZXQgZHJhZ1N0YXJ0U3RhdGUgPSBudWxsOwppZiAodGhpcy52aWV3ZXIudHJhbnNmb3JtQ29udHJvbCkgewp0aGlzLnZpZXdlci50cmFuc2Zvcm1Db250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdnaW5nLWNoYW5nZWQnLCAoZXZlbnQpID0+IHsKY29uc3QgaXNEcmFnZ2luZyA9IGV2ZW50LnZhbHVlOwppZiAoaXNEcmFnZ2luZykgewpjb25zdCBvYmogPSB0aGlzLnZpZXdlci50cmFuc2Zvcm1Db250cm9sLm9iamVjdDsKaWYgKG9iaikgewpkcmFnU3RhcnRTdGF0ZSA9IHsKaWQ6IG9iai51dWlkLApwb3NpdGlvbjogb2JqLnBvc2l0aW9uLmNsb25lKCksCnJvdGF0aW9uOiBvYmoucm90YXRpb24uY2xvbmUoKSwKc2NhbGU6IG9iai5zY2FsZS5jbG9uZSgpCn07Cn0KfSBlbHNlIGlmIChkcmFnU3RhcnRTdGF0ZSkgewovLyBEcmFnIEVuZDogUHVzaCBwcmV2aW91cyBzdGF0ZSB0byBoaXN0b3J5CnRoaXMucHVzaEhpc3RvcnkoZHJhZ1N0YXJ0U3RhdGUpOwpkcmFnU3RhcnRTdGF0ZSA9IG51bGw7Cn0KfSk7Cn0KLy8gTW9iaWxlIFNsaWRlciBMb2dpYwp0aGlzLmluaXRNb2JpbGVTbGlkZXJzKCk7Ci8vIEtleWJvYXJkIFNob3J0Y3V0cwpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHsKLy8gVW5kbyAoQ3RybCtaKQppZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUua2V5LnRvTG93ZXJDYXNlKCkgPT09ICd6JykgewplLnByZXZlbnREZWZhdWx0KCk7CnRoaXMudW5kbygpOwpyZXR1cm47Cn0KLy8gSWdub3JlIGlmIHR5cGluZyBpbiBpbnB1dAppZiAoWydJTlBVVCcsICdURVhUQVJFQSddLmluY2x1ZGVzKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQudGFnTmFtZSkpIHJldHVybjsKc3dpdGNoIChlLmtleS50b0xvd2VyQ2FzZSgpKSB7CmNhc2UgJ2cnOiAvLyBHcmFiIC8gTW92ZQp0aGlzLnZpZXdlci5zZXRHaXptb01vZGUoJ3RyYW5zbGF0ZScpOwp1cGRhdGVBY3RpdmVCdG4oJ3RyYW5zbGF0ZS1idG4nKTsKYnJlYWs7CmNhc2UgJ3InOiAvLyBSb3RhdGUKdGhpcy52aWV3ZXIuc2V0R2l6bW9Nb2RlKCdyb3RhdGUnKTsKdXBkYXRlQWN0aXZlQnRuKCdyb3RhdGUtYnRuJyk7CmJyZWFrOwpjYXNlICdzJzogLy8gU2NhbGUKdGhpcy52aWV3ZXIuc2V0R2l6bW9Nb2RlKCdzY2FsZScpOwp1cGRhdGVBY3RpdmVCdG4oJ3NjYWxlLWJ0bicpOwpicmVhazsKY2FzZSAnYic6IC8vIEJveCBTZWxlY3QKaWYgKHRoaXMuZWxlbWVudHMuYnRuQm94U2VsZWN0KSB0aGlzLmVsZW1lbnRzLmJ0bkJveFNlbGVjdC5jbGljaygpOwpicmVhazsKY2FzZSAnZXNjYXBlJzogLy8gRGVzZWxlY3QKdGhpcy52aWV3ZXIuZGV0YWNoR2l6bW8oKTsKdGhpcy52aWV3ZXIuY2xlYXJTZWxlY3Rpb24oKTsKdGhpcy51cGRhdGVTZWxlY3Rpb25VSShbXSk7Ci8vIEV4aXQgYm94IHNlbGVjdCBtb2RlIGlmIGFjdGl2ZQppZiAodGhpcy5ib3hTZWxlY3RNb2RlKSB7CnRoaXMuYm94U2VsZWN0TW9kZSA9IGZhbHNlOwppZiAodGhpcy5lbGVtZW50cy5idG5Cb3hTZWxlY3QpIHRoaXMuZWxlbWVudHMuYnRuQm94U2VsZWN0LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwp0aGlzLnZpZXdlci5jb250cm9scy5lbmFibGVkID0gdHJ1ZTsKfQpicmVhazsKfQp9KTsKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCAoZSkgPT4gZS5wcmV2ZW50RGVmYXVsdCgpKTsKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGFzeW5jIChlKSA9PiB7CmUucHJldmVudERlZmF1bHQoKTsKY29uc3QgaXRlbXMgPSBlLmRhdGFUcmFuc2Zlci5pdGVtczsKaWYgKGl0ZW1zICYmIGl0ZW1zLmxlbmd0aCA+IDAgJiYgaXRlbXNbMF0ud2Via2l0R2V0QXNFbnRyeSkgewovLyBNb2Rlcm4gRGlyZWN0b3J5IFNjYW5uaW5nCmNvbnN0IGVudHJpZXMgPSBbXTsKZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykgewplbnRyaWVzLnB1c2goaXRlbXNbaV0ud2Via2l0R2V0QXNFbnRyeSgpKTsKfQpjb25zdCBmaWxlcyA9IGF3YWl0IHRoaXMuc2NhbkVudHJpZXMoZW50cmllcyk7CnRoaXMuaGFuZGxlRmlsZXMoZmlsZXMpOwp9IGVsc2UgewovLyBGYWxsYmFjayAvIFN0YW5kYXJkCnRoaXMuaGFuZGxlRmlsZXMoQXJyYXkuZnJvbShlLmRhdGFUcmFuc2Zlci5maWxlcykpOwp9Cn0pOwp9CmFzeW5jIHNjYW5FbnRyaWVzKGVudHJpZXMpIHsKY29uc3QgZmlsZXMgPSBbXTsKY29uc3Qgc2NhbiA9IGFzeW5jIChlbnRyeSkgPT4gewppZiAoZW50cnkuaXNGaWxlKSB7CnJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IGVudHJ5LmZpbGUoZmlsZSA9PiB7CmZpbGVzLnB1c2goZmlsZSk7CnJlc29sdmUoKTsKfSkpOwp9IGVsc2UgaWYgKGVudHJ5LmlzRGlyZWN0b3J5KSB7CmNvbnN0IHJlYWRlciA9IGVudHJ5LmNyZWF0ZVJlYWRlcigpOwpjb25zdCByZWFkRW50cmllcyA9IGFzeW5jICgpID0+IHsKY29uc3Qgc3ViRW50cmllcyA9IGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gcmVhZGVyLnJlYWRFbnRyaWVzKHJlc29sdmUpKTsKaWYgKHN1YkVudHJpZXMubGVuZ3RoID4gMCkgewphd2FpdCBQcm9taXNlLmFsbChzdWJFbnRyaWVzLm1hcChzY2FuKSk7CmF3YWl0IHJlYWRFbnRyaWVzKCk7IC8vIENvbnRpbnVlIHJlYWRpbmcgKHJlYWRFbnRyaWVzIHJldHVybnMgaW4gY2h1bmtzKQp9Cn07CmF3YWl0IHJlYWRFbnRyaWVzKCk7Cn0KfTsKYXdhaXQgUHJvbWlzZS5hbGwoZW50cmllcy5tYXAoc2NhbikpOwpyZXR1cm4gZmlsZXM7Cn0KYXN5bmMgaGFuZGxlRmlsZXMoZmlsZXMpIHsKLy8gUmVzZXQgaW5wdXRzIHNvIHRoZSBzYW1lIGZpbGUgY2FuIGJlIHNlbGVjdGVkIGFnYWluIGlmIG5lZWRlZAppZiAodGhpcy5lbGVtZW50cy5maWxlSW5wdXQpIHRoaXMuZWxlbWVudHMuZmlsZUlucHV0LnZhbHVlID0gJyc7CmlmICh0aGlzLmVsZW1lbnRzLmZvbGRlcklucHV0KSB0aGlzLmVsZW1lbnRzLmZvbGRlcklucHV0LnZhbHVlID0gJyc7CmlmICghZmlsZXMgfHwgZmlsZXMubGVuZ3RoID09PSAwKSByZXR1cm47CmxvZyhgUmVjZWl2ZWQgJHtmaWxlcy5sZW5ndGh9IGZpbGVzOiAke2ZpbGVzLm1hcChmID0+IGYubmFtZSkuam9pbignLCAnKX1gLCAnaW5mbycpOwpjb25zdCBtZXNoRmlsZXMgPSBmaWxlcy5maWx0ZXIoZiA9PiBmLm5hbWUudG9Mb3dlckNhc2UoKS5lbmRzV2l0aCgnLmNzdicpIHx8IGYubmFtZS50b0xvd2VyQ2FzZSgpLmVuZHNXaXRoKCcuYjNkJykpOwpjb25zdCBpbWFnZUZpbGVzID0gZmlsZXMuZmlsdGVyKGYgPT4gZi5uYW1lLm1hdGNoKC9cLihwbmd8anBnfGpwZWd8Ym1wfGdpZikkL2kpKTsKaWYgKGltYWdlRmlsZXMubGVuZ3RoID4gMCkgewpmb3IgKGNvbnN0IGZpbGUgb2YgaW1hZ2VGaWxlcykgewpjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpOwp0aGlzLnZpZXdlci5hZGRUZXh0dXJlKGZpbGUubmFtZSwgdXJsKTsKfQp9CmZvciAoY29uc3QgbWVzaEZpbGUgb2YgbWVzaEZpbGVzKSB7CmxvZyhgTG9hZGluZzogJHttZXNoRmlsZS5uYW1lfWAsICdpbmZvJyk7CnRoaXMuZWxlbWVudHMubG9hZGluZy5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKcmVhZGVyLm9ubG9hZCA9IChlKSA9PiB7CnRyeSB7CmNvbnN0IG1lc2hEYXRhID0gdGhpcy5wYXJzZXIucGFyc2UoZS50YXJnZXQucmVzdWx0LCBtZXNoRmlsZS5uYW1lLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoJy5iM2QnKSk7CmNvbnN0IGlkID0gJ21lc2hfJyArIERhdGUubm93KCkgKyAnXycgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwKTsKbGV0IHZlcnRzID0gMDsKbWVzaERhdGEuZm9yRWFjaChtID0+IHZlcnRzICs9IG0udmVydGljZXMubGVuZ3RoIC8gMyk7CnRoaXMudmlld2VyLmxvYWRNb2RlbChpZCwgbWVzaERhdGEpOwpjb25zdCB1dkNvdW50ID0gbWVzaERhdGEucmVkdWNlKChhY2MsIG0pID0+IGFjYyArIChtLnV2cyA/IG0udXZzLmxlbmd0aCAvIDIgOiAwKSwgMCk7CnRoaXMubG9hZGVkTW9kZWxzLnNldChpZCwgeyBuYW1lOiBtZXNoRmlsZS5uYW1lLCB2ZXJ0aWNlczogdmVydHMsIGZhY2VzOiBNYXRoLnJvdW5kKHZlcnRzIC8gMyksIHV2czogdXZDb3VudCB9KTsKdGhpcy51cGRhdGVNZXNoTGlzdCgpOwpsb2coYFBhcnNlZDogJHt2ZXJ0c30gdmVydHMsICR7dXZDb3VudH0gVVZzIFBvaW50YCwgJ2luZm8nKTsKdGhpcy5lbGVtZW50cy5vdmVybGF5LmNsYXNzTGlzdC5hZGQoJ2xvYWRlZCcpOwp9IGNhdGNoIChlcnIpIHsgbG9nKCdFcnJvcjogJyArIGVyci5tZXNzYWdlLCAnZXJyb3InKTsgfQp0aGlzLmVsZW1lbnRzLmxvYWRpbmcuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7Cn07CnJlYWRlci5yZWFkQXNUZXh0KG1lc2hGaWxlKTsKfQp9CnVwZGF0ZU9iamVjdENvb3JkcygpIHsKaWYgKCF0aGlzLmVsZW1lbnRzLm9iamVjdENvb3JkcykgcmV0dXJuOwpjb25zdCBvYmogPSB0aGlzLnZpZXdlci50cmFuc2Zvcm1Db250cm9sLm9iamVjdDsKaWYgKG9iaikgewp0aGlzLmVsZW1lbnRzLm9iamVjdENvb3Jkcy5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKY29uc3QgcG9zID0gb2JqLnBvc2l0aW9uOwovLyBTaG9ydGVuIG51bWJlcnMKY29uc3QgZiA9IChuKSA9PiBuLnRvRml4ZWQoMik7CnRoaXMuZWxlbWVudHMub2JqZWN0Q29vcmRzLnRleHRDb250ZW50ID0gYE9iajogJHtmKHBvcy54KX0sICR7Zihwb3MueSl9LCAke2YocG9zLnopfWA7Cn0gZWxzZSB7CnRoaXMuZWxlbWVudHMub2JqZWN0Q29vcmRzLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwp9Cn0KaW5pdE1vYmlsZVNsaWRlcnMoKSB7CmNvbnN0IHNsaWRlcnMgPSBbCnsgZWw6IHRoaXMuZWxlbWVudHMuc2xpZGVyWCwgYXhpczogJ3gnIH0sCnsgZWw6IHRoaXMuZWxlbWVudHMuc2xpZGVyWSwgYXhpczogJ3knIH0sCnsgZWw6IHRoaXMuZWxlbWVudHMuc2xpZGVyWiwgYXhpczogJ3onIH0KXTsKc2xpZGVycy5mb3JFYWNoKHMgPT4gewppZiAoIXMuZWwpIHJldHVybjsKLy8gUmVzZXQgb24gcmVsZWFzZQpjb25zdCByZXNldCA9ICgpID0+IHsgcy5lbC52YWx1ZSA9IDA7IH07CnMuZWwuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgcmVzZXQpOwpzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgcmVzZXQpOwpzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCByZXNldCk7Ci8vIENvbnRpbnVvdXMgdXBkYXRlCnMuZWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoZSkgPT4gewpjb25zdCB2YWwgPSBwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlKTsKLy8gRGVhZHpvbmUKaWYgKE1hdGguYWJzKHZhbCkgPCAwLjUpIHJldHVybjsKY29uc3Qgb2JqID0gdGhpcy52aWV3ZXIudHJhbnNmb3JtQ29udHJvbC5vYmplY3Q7CmlmICghb2JqKSByZXR1cm47CmNvbnN0IG1vZGUgPSB0aGlzLnZpZXdlci50cmFuc2Zvcm1Db250cm9sLmdldE1vZGUoKTsKY29uc3Qgc2Vuc2l0aXZpdHkgPSBtb2RlID09PSAncm90YXRlJyA/IDAuMDUgOiAobW9kZSA9PT0gJ3NjYWxlJyA/IDAuMDIgOiAwLjA1KTsKLy8gU2NhbGUgZmFjdG9yIGZvciBQb3NpdGlvbiBkZXBlbmRzIG9uIGNhbWVyYSBkaXN0YW5jZSB1c3VhbGx5LCBidXQgZml4ZWQgaXMgZmluZSBmb3Igbm93CmNvbnN0IGRlbHRhID0gdmFsICogc2Vuc2l0aXZpdHk7IC8vIFZhbHVlIGlzIC01MCB0byA1MAppZiAobW9kZSA9PT0gJ3RyYW5zbGF0ZScpIHsKLy8gU2ltcGxlIGxvY2FsIHRyYW5zbGF0aW9uIGhhY2sKLy8gQ29ycmVjdCB3YXkgaXMgdG8gY2hlY2sgc3BhY2UsIGJ1dCBsZXQncyBqdXN0IG1vZGlmeSBwcm9wZXJ0eSBmb3Igc2ltcGxpY2l0eQovLyBUaHJlZS5qcyBUcmFuc2Zvcm1Db250cm9scyB1c3VhbGx5IHdvcmtzIGluIFdvcmxkIG9yIExvY2FsLgovLyBJZiB3ZSBtb2RpZnkgLnBvc2l0aW9uIGRpcmVjdGx5LCB0aGF0IGlzIExvY2FsIChyZWxhdGl2ZSB0byBwYXJlbnQpLgpvYmoucG9zaXRpb25bcy5heGlzXSArPSBkZWx0YSAqIDAuMTsKfSBlbHNlIGlmIChtb2RlID09PSAncm90YXRlJykgewpvYmoucm90YXRpb25bcy5heGlzXSArPSBkZWx0YSAqIDAuMTsKfSBlbHNlIGlmIChtb2RlID09PSAnc2NhbGUnKSB7Cm9iai5zY2FsZVtzLmF4aXNdICs9IGRlbHRhICogMC4wMTsKfQp0aGlzLnVwZGF0ZU9iamVjdENvb3JkcygpOwp9KTsKfSk7Cn0KdXBkYXRlTWVzaExpc3QoKSB7CnRoaXMuZWxlbWVudHMubWVzaEl0ZW1zLmlubmVySFRNTCA9ICcnOwppZiAodGhpcy5sb2FkZWRNb2RlbHMuc2l6ZSA+IDApIHsKdGhpcy5lbGVtZW50cy5tZXNoTGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKdGhpcy5sb2FkZWRNb2RlbHMuZm9yRWFjaCgoaW5mbywgaWQpID0+IHsKY29uc3QgbW9kZWxHcm91cCA9IHRoaXMudmlld2VyLm1vZGVscy5nZXQoaWQpOwppZiAoIW1vZGVsR3JvdXApIHJldHVybjsKY29uc3QgZmlsZU5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKZmlsZU5vZGUuY2xhc3NOYW1lID0gJ21lc2gtZmlsZS1ub2RlJzsKLy8gRmlsZSBIZWFkZXIKY29uc3QgZmlsZUhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwpmaWxlSGVhZGVyLmNsYXNzTmFtZSA9ICdmaWxlLWhlYWRlcic7CmZpbGVIZWFkZXIuaW5uZXJIVE1MID0gYAo8c3BhbiBjbGFzcz0iZmlsZS1pY29uIj7wn5OmPC9zcGFuPgo8c3BhbiBjbGFzcz0ibWVzaC1pdGVtLW5hbWUiPiR7aW5mby5uYW1lfTwvc3Bhbj4KPGJ1dHRvbiBjbGFzcz0idGV4dC1idG4gZGFuZ2VyIHVubG9hZC1idG4iIHN0eWxlPSJtYXJnaW4tbGVmdDogYXV0bzsiPsOXPC9idXR0b24+CmA7CmNvbnN0IG1lc2hDaGlsZHJlbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwptZXNoQ2hpbGRyZW4uY2xhc3NOYW1lID0gJ21lc2gtY2hpbGRyZW4nOwovLyBJbmRpdmlkdWFsIE1lc2hlcyAoY2hpbGRyZW4gb2YgdGhlIGdyb3VwKQptb2RlbEdyb3VwLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkLCBpbmRleCkgPT4gewppZiAoIWNoaWxkLmlzTWVzaCkgcmV0dXJuOwpjb25zdCBtZXNoSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwptZXNoSXRlbS5jbGFzc05hbWUgPSAnbWVzaC1pdGVtJzsKY29uc3QgdGV4TmFtZSA9IGNoaWxkLnVzZXJEYXRhLnRleHR1cmVOYW1lIHx8ICdObyBUZXh0dXJlJzsKbWVzaEl0ZW0uaW5uZXJIVE1MID0gYAo8ZGl2IGNsYXNzPSJtZXNoLWl0ZW0taGVhZGVyIj4KPHNwYW4gY2xhc3M9Im1lc2gtaXRlbS1uYW1lIj5NZXNoICR7aW5kZXggKyAxfTwvc3Bhbj4KPC9kaXY+CjxkaXYgY2xhc3M9Im1lc2gtaXRlbS1zdGF0cyI+CjxzcGFuPlY6ICR7Y2hpbGQuZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5jb3VudH08L3NwYW4+CjxzcGFuPlRleDogJHt0ZXhOYW1lfTwvc3Bhbj4KPC9kaXY+CmA7Cm1lc2hJdGVtLm9uY2xpY2sgPSAoZSkgPT4gewplLnN0b3BQcm9wYWdhdGlvbigpOwp0aGlzLnVwZGF0ZVNlbGVjdGlvblVJKFtjaGlsZF0pOwp9OwovLyBDYWNoZSBmb3Igc2VsZWN0aW9uIGhpZ2hsaWdodGluZwpjaGlsZC51c2VyRGF0YS5vdXRsaW5lckVsZW1lbnQgPSBtZXNoSXRlbTsKbWVzaENoaWxkcmVuLmFwcGVuZENoaWxkKG1lc2hJdGVtKTsKfSk7CmZpbGVIZWFkZXIub25jbGljayA9ICgpID0+IHsKY29uc3QgaXNDb2xsYXBzZWQgPSBtZXNoQ2hpbGRyZW4uc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnOwptZXNoQ2hpbGRyZW4uc3R5bGUuZGlzcGxheSA9IGlzQ29sbGFwc2VkID8gJ2ZsZXgnIDogJ25vbmUnOwp0aGlzLnVwZGF0ZVNlbGVjdGlvblVJKFttb2RlbEdyb3VwXSk7Cn07CmZpbGVIZWFkZXIucXVlcnlTZWxlY3RvcignLnVubG9hZC1idG4nKS5vbmNsaWNrID0gKGUpID0+IHsKZS5zdG9wUHJvcGFnYXRpb24oKTsKdGhpcy51bmxvYWRNb2RlbChpZCk7Cn07CmZpbGVOb2RlLmFwcGVuZENoaWxkKGZpbGVIZWFkZXIpOwpmaWxlTm9kZS5hcHBlbmRDaGlsZChtZXNoQ2hpbGRyZW4pOwp0aGlzLmVsZW1lbnRzLm1lc2hJdGVtcy5hcHBlbmRDaGlsZChmaWxlTm9kZSk7Cn0pOwp9IGVsc2Ugewp0aGlzLmVsZW1lbnRzLm1lc2hMaXN0LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwp0aGlzLmVsZW1lbnRzLm92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7Cn0KfQp1cGRhdGVTZWxlY3Rpb25VSShzZWxlY3RlZE9iamVjdHMpIHsKaWYgKHRoaXMuc2VsZWN0aW9uSGVscGVyKSB7CnRoaXMudmlld2VyLnNjZW5lLnJlbW92ZSh0aGlzLnNlbGVjdGlvbkhlbHBlcik7CnRoaXMuc2VsZWN0aW9uSGVscGVyID0gbnVsbDsKfQp0aGlzLnZpZXdlci51cGRhdGVTZWxlY3Rpb25Hcm91cChzZWxlY3RlZE9iamVjdHMpOwpjb25zdCBoYXNTZWxlY3Rpb24gPSBzZWxlY3RlZE9iamVjdHMubGVuZ3RoID4gMDsKaWYgKGhhc1NlbGVjdGlvbikgewp0aGlzLmVsZW1lbnRzLnRyYW5zZm9ybVRvb2xiYXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CmlmICh0aGlzLmVsZW1lbnRzLm1vYmlsZVRyYW5zZm9ybVVJKSB0aGlzLmVsZW1lbnRzLm1vYmlsZVRyYW5zZm9ybVVJLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwovLyBBZGQgQm94SGVscGVyIGZvciBmaXJzdCBzZWxlY3RlZCBvYmplY3QgKG9yIGdyb3VwKQpjb25zdCB0YXJnZXQgPSB0aGlzLnZpZXdlci50cmFuc2Zvcm1Db250cm9sLm9iamVjdDsKaWYgKHRhcmdldCkgewp0aGlzLnNlbGVjdGlvbkhlbHBlciA9IG5ldyBUSFJFRS5Cb3hIZWxwZXIodGFyZ2V0LCAweGZmZmYwMCk7CnRoaXMudmlld2VyLnNjZW5lLmFkZCh0aGlzLnNlbGVjdGlvbkhlbHBlcik7Cn0KfSBlbHNlIHsKdGhpcy5lbGVtZW50cy50cmFuc2Zvcm1Ub29sYmFyLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwppZiAodGhpcy5lbGVtZW50cy5tb2JpbGVUcmFuc2Zvcm1VSSkgdGhpcy5lbGVtZW50cy5tb2JpbGVUcmFuc2Zvcm1VSS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKfQovLyBPcHRpbWl6ZWQ6IFVzZSBTZXQgZm9yIE8oMSkgbG9va3VwCmNvbnN0IHNlbGVjdGVkU2V0ID0gbmV3IFNldChzZWxlY3RlZE9iamVjdHMpOwp0aGlzLnZpZXdlci5tb2RlbHMuZm9yRWFjaCgoZ3JvdXAsIGlkKSA9PiB7Cmdyb3VwLnRyYXZlcnNlKGNoaWxkID0+IHsKaWYgKGNoaWxkLnVzZXJEYXRhLm91dGxpbmVyRWxlbWVudCkgewpjaGlsZC51c2VyRGF0YS5vdXRsaW5lckVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSgnc2VsZWN0ZWQnLCBzZWxlY3RlZFNldC5oYXMoY2hpbGQpKTsKfQp9KTsKfSk7CnRoaXMudXBkYXRlT2JqZWN0Q29vcmRzKCk7Cn0KcGVyZm9ybUJveFNlbGVjdGlvbihzdGFydCwgZW5kKSB7CmNvbnN0IG1pblggPSBNYXRoLm1pbihzdGFydC54LCBlbmQueCk7CmNvbnN0IG1heFggPSBNYXRoLm1heChzdGFydC54LCBlbmQueCk7CmNvbnN0IG1pblkgPSBNYXRoLm1pbihzdGFydC55LCBlbmQueSk7CmNvbnN0IG1heFkgPSBNYXRoLm1heChzdGFydC55LCBlbmQueSk7CmNvbnN0IG5ld1NlbGVjdGlvbiA9IFtdOwpjb25zdCByZWN0ID0gdGhpcy52aWV3ZXIuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwp0aGlzLnZpZXdlci5tb2RlbHMuZm9yRWFjaChtb2RlbCA9PiB7CmNvbnN0IGJveCA9IG5ldyBUSFJFRS5Cb3gzKCkuc2V0RnJvbU9iamVjdChtb2RlbCk7CmNvbnN0IGNlbnRlciA9IGJveC5nZXRDZW50ZXIobmV3IFRIUkVFLlZlY3RvcjMoKSk7CmNlbnRlci5wcm9qZWN0KHRoaXMudmlld2VyLmNhbWVyYSk7CmNvbnN0IHNjcmVlblggPSAoY2VudGVyLnggKiAwLjUgKyAwLjUpICogcmVjdC53aWR0aCArIHJlY3QubGVmdDsKY29uc3Qgc2NyZWVuWSA9ICgtKGNlbnRlci55ICogMC41KSArIDAuNSkgKiByZWN0LmhlaWdodCArIHJlY3QudG9wOwppZiAoc2NyZWVuWCA+PSBtaW5YICYmIHNjcmVlblggPD0gbWF4WCAmJiBzY3JlZW5ZID49IG1pblkgJiYgc2NyZWVuWSA8PSBtYXhZKSB7Cm5ld1NlbGVjdGlvbi5wdXNoKG1vZGVsKTsKfQp9KTsKY29uc3QgY3VycmVudFNlbGVjdGlvbiA9IHRoaXMudmlld2VyLnNlbGVjdGVkT2JqZWN0cyB8fCBbXTsKY29uc3QgY29tYmluZWQgPSBuZXcgU2V0KFsuLi5jdXJyZW50U2VsZWN0aW9uLCAuLi5uZXdTZWxlY3Rpb25dKTsKdGhpcy51cGRhdGVTZWxlY3Rpb25VSShBcnJheS5mcm9tKGNvbWJpbmVkKSk7Cn0KcHVzaEhpc3Rvcnkoc3RhdGUpIHsKaWYgKCFzdGF0ZSkgcmV0dXJuOwp0aGlzLmhpc3RvcnkucHVzaChzdGF0ZSk7CmlmICh0aGlzLmhpc3RvcnkubGVuZ3RoID4gdGhpcy5tYXhIaXN0b3J5KSB0aGlzLmhpc3Rvcnkuc2hpZnQoKTsKbG9nKCdBY3Rpb24gc2F2ZWQgdG8gaGlzdG9yeScsICdkZWJ1ZycpOwp9CnVuZG8oKSB7CmlmICh0aGlzLmhpc3RvcnkubGVuZ3RoID09PSAwKSB7CmxvZygnTm90aGluZyB0byB1bmRvJywgJ2luZm8nKTsKcmV0dXJuOwp9CmNvbnN0IHN0YXRlID0gdGhpcy5oaXN0b3J5LnBvcCgpOwovLyBGaW5kIG9iamVjdCAod2UgbmVlZCB0byBzZWFyY2ggaW4gdmlld2VyJ3MgbW9kZWxzKQpsZXQgZm91bmRPYmogPSBudWxsOwp0aGlzLnZpZXdlci5tb2RlbHMuZm9yRWFjaChtb2RlbCA9PiB7CmlmIChtb2RlbC51dWlkID09PSBzdGF0ZS5pZCkgZm91bmRPYmogPSBtb2RlbDsKLy8gQWxzbyBjaGVjayBjaGlsZHJlbiBpZiBuZWVkZWQsIGJ1dCBvdXIgSUQgbG9naWMgdGllcyB0byB0aGUgZ3JvdXAKfSk7Ci8vIFRoZSBzdG9yZWQgSUQgaXMgZnJvbSB0aGUgVHJhbnNmb3JtQ29udHJvbC5vYmplY3QsIHdoaWNoIG1hdGNoZXMgd2hhdCB3ZSBzZWxlY3RlZAovLyBJbiBvdXIgc2VsZWN0aW9uIGxvZ2ljLCB3ZSB0cmF2ZXJzZSB1cCB0byB0aGUgR3JvdXAsIHNvIFVVSUQgc2hvdWxkIG1hdGNoIHRoZSBHcm91cCBVVUlECi8vIFVOTEVTUyB0aGUgdHJhbnNmb3JtIHdhcyBhdHRhY2hlZCB0byBhIG1lc2ggaW5zaWRlLgovLyBMZXQncyB2ZXJpZnkgc2VsZWN0aW9uIGxvZ2ljOiBpdCBhdHRhY2hlcyB0byAnc2VsZWN0ZWQnLCB3aGljaCBpcyB0aGUgcGFyZW50IGdyb3VwIHVzdWFsbHkuCi8vIEJ1dCB0byBiZSBzYWZlLCB3ZSBjYW4gdHJ5IHRvIGZpbmQgb2JqZWN0IGJ5IFVVSUQgaW4gdGhlIHNjZW5lCmlmICghZm91bmRPYmopIHsKZm91bmRPYmogPSB0aGlzLnZpZXdlci5zY2VuZS5nZXRPYmplY3RCeVByb3BlcnR5KCd1dWlkJywgc3RhdGUuaWQpOwp9CmlmIChmb3VuZE9iaikgewpmb3VuZE9iai5wb3NpdGlvbi5jb3B5KHN0YXRlLnBvc2l0aW9uKTsKZm91bmRPYmoucm90YXRpb24uY29weShzdGF0ZS5yb3RhdGlvbik7CmZvdW5kT2JqLnNjYWxlLmNvcHkoc3RhdGUuc2NhbGUpOwovLyBJZiBjdXJyZW50bHkgc2VsZWN0ZWQsIHVwZGF0ZSBnaXptbyB2aXN1YWwgaW1tZWRpYXRlbHkgKHRob3VnaCBpdCBzaG91bGQgYXV0by11cGRhdGUpCi8vIEFuZCB1cGRhdGUgY29vcmRzIFVJCmlmICh0aGlzLnZpZXdlci50cmFuc2Zvcm1Db250cm9sLm9iamVjdCA9PT0gZm91bmRPYmopIHsKdGhpcy51cGRhdGVPYmplY3RDb29yZHMoKTsKaWYgKHRoaXMuc2VsZWN0aW9uSGVscGVyKSB0aGlzLnNlbGVjdGlvbkhlbHBlci51cGRhdGUoKTsKfQpsb2coJ1VuZG8gcGVyZm9ybWVkJywgJ2luZm8nKTsKfSBlbHNlIHsKbG9nKCdVbmRvIGZhaWxlZDogT2JqZWN0IG5vdCBmb3VuZCcsICdlcnJvcicpOwp9Cn0KdW5sb2FkTW9kZWwoaWQpIHsKdGhpcy52aWV3ZXIudW5sb2FkTW9kZWwoaWQpOwp0aGlzLmxvYWRlZE1vZGVscy5kZWxldGUoaWQpOwp0aGlzLnVwZGF0ZU1lc2hMaXN0KCk7CmxvZyhpMThuID8gaTE4bi5nZXQoJ21vZGVsVW5sb2FkZWQnLCB7IGlkIH0pIDogYE1vZGVsIHVubG9hZGVkOiAke2lkfWAsICdpbmZvJyk7Cn0KfQovLyAtLS0gTG9jYWxpemF0aW9uIC0tLQpjb25zdCB0cmFuc2xhdGlvbnMgPSB7Cidlbic6IHsKc3VidGl0bGU6ICdCM0QgJiBDU1YgM0QgTWVzaCBQcmV2aWV3JywKZHJvcFRpdGxlOiAnRHJvcCAuYjNkIC8gLmNzdiBmaWxlcyBoZXJlJywKZHJvcFN1YnRpdGxlOiAnb3IgY2xpY2sgdG8gYnJvd3NlIGZpbGVzJywKc2VsZWN0Rm9sZGVyOiAnU2VsZWN0IEZvbGRlcicsCmZvbGRlclRvb2x0aXA6ICdMb2FkIGVudGlyZSBmb2xkZXIgKE1lc2ggKyBUZXh0dXJlcyknLApsb2FkZWRNZXNoZXM6ICdMb2FkZWQgTWVzaGVzJywKdW5sb2FkQWxsOiAnVW5sb2FkIEFsbCcsCnBhcnNpbmc6ICdQYXJzaW5nIE1lc2guLi4nLApsb2FkTW9yZTogJ0xvYWQgTW9yZSBGaWxlcycsCnJlc2V0Q2FtZXJhOiAnUmVzZXQgQ2FtZXJhJywKLy8gTG9nIE1lc3NhZ2VzCnJlY2VpdmVkRmlsZXM6ICdSZWNlaXZlZCB7bn0gZmlsZXM6IHtsaXN0fScsCmxvYWRpbmc6ICdMb2FkaW5nOiB7bmFtZX0nLAp3YWl0aW5nVGV4dHVyZTogJ1dhaXRpbmcgZm9yIHRleHR1cmU6IHtuYW1lfSAoRHJhZy9Ecm9wIHRoaXMgZmlsZSB0byBsb2FkKScsCnRleHR1cmVMb2FkZWQ6ICdUZXh0dXJlIGxvYWRlZDoge25hbWV9JywKbG9hZEZhaWxlZDogJ0ZhaWxlZCB0byBsb2FkIHRleHR1cmUge25hbWV9OiB7ZXJyfScsCnBhcnNlZDogJ1BhcnNlZDoge3Z9IHZlcnRzLCB7dXZ9IFVWcycsCm1vZGVsVW5sb2FkZWQ6ICdNb2RlbCB1bmxvYWRlZDoge2lkfScsCmVycm9yOiAnRXJyb3I6IHttc2d9Jwp9LAonaWQnOiB7CnN1YnRpdGxlOiAnUHJhdGluamF1IE1lc2ggM0QgQjNEICYgQ1NWJywKZHJvcFRpdGxlOiAnVGFyaWsgZmlsZSAuYjNkIC8gLmNzdiBrZSBzaW5pJywKZHJvcFN1YnRpdGxlOiAnYXRhdSBrbGlrIHVudHVrIGplbGFqYWhpIGZpbGUnLApzZWxlY3RGb2xkZXI6ICdQaWxpaCBGb2xkZXInLApmb2xkZXJUb29sdGlwOiAnTXVhdCBzZWx1cnVoIGZvbGRlciAoTWVzaCArIFRla3N0dXIpJywKbG9hZGVkTWVzaGVzOiAnTWVzaCBEaW11YXQnLAp1bmxvYWRBbGw6ICdCb25na2FyIFNlbXVhJywKcGFyc2luZzogJ01lbmd1cmFpIE1lc2guLi4nLApsb2FkTW9yZTogJ011YXQgTGViaWggQmFueWFrIEZpbGUnLApyZXNldENhbWVyYTogJ1Jlc2V0IEthbWVyYScsCi8vIExvZyBNZXNzYWdlcwpyZWNlaXZlZEZpbGVzOiAnTWVuZXJpbWEge259IGZpbGU6IHtsaXN0fScsCmxvYWRpbmc6ICdNZW11YXQ6IHtuYW1lfScsCndhaXRpbmdUZXh0dXJlOiAnTWVudW5nZ3UgdGVrc3R1cjoge25hbWV9IChUYXJpayBmaWxlIGluaSB1bnR1ayBtZW11YXQpJywKdGV4dHVyZUxvYWRlZDogJ1Rla3N0dXIgZGltdWF0OiB7bmFtZX0nLApsb2FkRmFpbGVkOiAnR2FnYWwgbWVtdWF0IHRla3N0dXIge25hbWV9OiB7ZXJyfScsCnBhcnNlZDogJ0RpdXJhaToge3Z9IHZlcnRpa2FsLCB7dXZ9IFVWJywKbW9kZWxVbmxvYWRlZDogJ01vZGVsIGRpYm9uZ2thcjoge2lkfScsCmVycm9yOiAnS2VzYWxhaGFuOiB7bXNnfScKfQp9OwpjbGFzcyBJMThuIHsKY29uc3RydWN0b3IoKSB7Ci8vIERldGVjdCBsYW5ndWFnZSAoZGVmYXVsdCB0byBlbikKY29uc3QgdXNlckxhbmcgPSBuYXZpZ2F0b3IubGFuZ3VhZ2UgfHwgbmF2aWdhdG9yLnVzZXJMYW5ndWFnZTsKdGhpcy5sYW5nID0gdXNlckxhbmcuc3RhcnRzV2l0aCgnaWQnKSA/ICdpZCcgOiAnZW4nOwp0aGlzLnQgPSB0cmFuc2xhdGlvbnNbdGhpcy5sYW5nXTsKbG9nKGBMYW5ndWFnZSBkZXRlY3Rpb246ICR7dXNlckxhbmd9IC0+IHVzaW5nICR7dGhpcy5sYW5nfWAsICdpbmZvJyk7Cn0KYXBwbHkoKSB7Ci8vIFRleHQgQ29udGVudApkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1pMThuXScpLmZvckVhY2goZWwgPT4gewpjb25zdCBrZXkgPSBlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaTE4bicpOwppZiAodGhpcy50W2tleV0pIGVsLnRleHRDb250ZW50ID0gdGhpcy50W2tleV07Cn0pOwovLyBUb29sdGlwcwpkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1pMThuLXRvb2x0aXBdJykuZm9yRWFjaChlbCA9PiB7CmNvbnN0IGtleSA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1pMThuLXRvb2x0aXAnKTsKaWYgKHRoaXMudFtrZXldKSBlbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdG9vbHRpcCcsIHRoaXMudFtrZXldKTsKfSk7Ci8vIENTUyBWYXJpYWJsZXMgKGZvciBwc2V1ZG8tZWxlbWVudHMpCmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS10ZXh0LWxvYWQtbW9yZScsIGAiJHt0aGlzLnQubG9hZE1vcmV9ImApOwp9CmdldChrZXksIHJlcGxhY2VtZW50cyA9IHt9KSB7CmxldCB0ZXh0ID0gdGhpcy50W2tleV0gfHwga2V5Owpmb3IgKGNvbnN0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhyZXBsYWNlbWVudHMpKSB7CnRleHQgPSB0ZXh0LnJlcGxhY2UoYHske2t9fWAsIHYpOwp9CnJldHVybiB0ZXh0Owp9Cn0KbGV0IGkxOG47Ci8vIC0tLSBIZWxwZXIgRnVuY3Rpb25zIC0tLQp0cnkgewpjb25zdCBhcHAgPSBuZXcgQXBwKCk7CndpbmRvdy5hcHBJbnN0YW5jZSA9IGFwcDsgLy8gRm9yIGNvbnNvbGUgZGVidWdnaW5nCn0gY2F0Y2ggKGUpIHsKY29uc29sZS5lcnJvcigiQ3JpdGljYWwgQXBwIEluaXRpYWxpemF0aW9uIEVycm9yOiIsIGUpOwovLyBUcnkgdG8gbG9nIGl0IGlmIHRoZSBwYXJzZXIgaXMgZGVmaW5lZAppZiAodHlwZW9mIGxvZyA9PT0gJ2Z1bmN0aW9uJykgbG9nKCJJbml0aWFsaXphdGlvbiBGYWlsZWQ6ICIgKyBlLm1lc3NhZ2UsICdlcnJvcicpOwp9");
            eval(scriptContent);
        })();
    </script>
</body>

</html>