<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OpenBVE Mesh Viewer</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Outfit:wght@400;700&display=swap"
        rel="stylesheet">
    <!-- Load Three.js 0.145.0 (Last version with easy non-module support) -->
    <script src="https://unpkg.com/three@0.145.0/build/three.min.js"></script>
    <script src="https://unpkg.com/three@0.145.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://unpkg.com/three@0.145.0/examples/js/controls/TransformControls.js"></script>
</head>

<body>
    <div id="app">
        <canvas id="viewer-canvas"></canvas>

        <div id="ui-overlay">
            <header>
                <h1>OpenBVE <span>Viewer</span></h1>
                <p class="subtitle" data-i18n="subtitle">B3D & CSV 3D Mesh Preview</p>
                <p class="subtitle"> Made with ‚ù§Ô∏è by Progressive Addon</p>
            </header>

            <label for="file-input" id="drop-zone" class="glass-panel">
                <div class="drop-content">
                    <div class="icon-upload">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" class="animate-bounce">
                            <path d="M12 16L12 8" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" />
                            <path d="M9 11L12 8 15 11" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" />
                            <path d="M8 16H16" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" />
                        </svg>
                    </div>
                    <h3 data-i18n="dropTitle">Drop .b3d / .csv files here</h3>
                    <p class="subtitle-small" data-i18n="dropSubtitle">or click to browse files</p>
                </div>
            </label>

            <div class="external-actions">
                <label for="folder-input" class="upload-btn primary" data-tooltip="Load entire folder (Mesh + Textures)"
                    data-i18n-tooltip="folderTooltip">
                    <span class="btn-icon">üìÅ</span> <span data-i18n="selectFolder">Select Folder</span>
                </label>
            </div>

            <input type="file" id="file-input" accept=".b3d,.csv,.png,.jpg,.jpeg,.bmp" multiple
                style="position: absolute; opacity: 0; width: 0.1px; height: 0.1px; pointer-events: none;">
            <input type="file" id="folder-input" webkitdirectory directory multiple
                style="position: absolute; opacity: 0; width: 0.1px; height: 0.1px; pointer-events: none;">

            <div id="mesh-list" class="glass-panel hidden">
                <button id="toggle-list-btn" class="glass-btn icon-only" aria-label="Toggle Mesh List">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 6h16M4 12h16M4 18h16" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </button>
                <div class="list-container">
                    <div class="list-header">
                        <h3 data-i18n="loadedMeshes">Loaded Meshes</h3>
                        <button id="unload-all" class="text-btn danger" data-i18n="unloadAll">Unload All</button>
                    </div>
                    <div id="mesh-items">
                        <!-- Dynamic mesh items go here -->
                    </div>
                </div>
            </div>

            <div id="loading-overlay" class="hidden">
                <div class="loader"></div>
                <p data-i18n="parsing">Parsing Mesh...</p>
            </div>

            <div id="transform-toolbar" class="glass-panel hidden">
                <h3>Transform Tools</h3>
                <div class="transform-buttons">
                    <button id="translate-btn" class="transform-btn active" title="Move (G)">Move</button>
                    <button id="rotate-btn" class="transform-btn" title="Rotate (R)">Rotate</button>
                    <button id="scale-btn" class="transform-btn" title="Scale (S)">Scale</button>
                </div>
                <div class="transform-toggles">
                    <label class="toggle-switch">
                        <input type="checkbox" id="local-space-toggle">
                        <span class="slider round"></span>
                        <span class="label-text">Local Space</span>
                    </label>
                </div>
                <p class="hint">Click mesh to select ‚Ä¢ ESC to deselect</p>
            </div>

            <div id="debug-box" class="glass-panel hidden">
                <h3>Debug Log</h3>
                <div id="debug-log"></div>
            </div>

            <button id="reset-cam" class="glass-btn" data-i18n="resetCamera">Reset Camera</button>
            <div id="top-bar">
                <span id="app-version">v1.0.0 alpha</span>
                <div id="camera-coords">Cam: 0, 5, 5</div>
                <div id="object-coords" class="hidden">Obj: -</div>
            </div>

            <!-- Selection Box -->
            <div id="selection-box" class="hidden"></div>

            <!-- Mobile Transform Sliders -->
            <div id="mobile-transform-ui" class="glass-panel hidden">
                <div class="slider-row">
                    <span class="axis-label x-axis">X</span>
                    <input type="range" id="slider-x" min="-50" max="50" value="0" step="0.1">
                </div>
                <div class="slider-row">
                    <span class="axis-label y-axis">Y</span>
                    <input type="range" id="slider-y" min="-50" max="50" value="0" step="0.1">
                </div>
                <div class="slider-row">
                    <span class="axis-label z-axis">Z</span>
                    <input type="range" id="slider-z" min="-50" max="50" value="0" step="0.1">
                </div>
                <p class="hint-mobile">Drag sliders to adjust</p>
            </div>

            <button id="info-btn" class="glass-btn icon-only" aria-label="Info">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10" />
                    <line x1="12" y1="16" x2="12" y2="12" />
                    <line x1="12" y1="8" x2="12.01" y2="8" />
                </svg>
            </button>

            <button id="box-select-btn" class="glass-btn icon-only" title="Box Selection Mode (B)"
                aria-label="Box Select">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" stroke-dasharray="4 2" />
                    <line x1="12" y1="8" x2="12" y2="16" />
                    <line x1="8" y1="12" x2="16" y2="12" />
                </svg>
            </button>

            <div id="info-modal" class="glass-panel hidden">
                <h3>Texture Import Info</h3>
                <p>Textures must be imported manually along with mesh files.</p>
                <p><strong>Tip:</strong> Use the "Select Folder" button to import all files (mesh + textures) at once
                    automatically.</p>
                <button id="close-info" class="upload-btn primary" style="margin-top: 1rem;">Got it</button>
            </div>
        </div>
    </div>

    <script>
    (function(){
        // Decode and inject CSS
        var s = document.createElement('style');
        s.innerHTML = atob("OnJvb3R7LS1iZy1jb2xvcjojMGQwZjE0Oy0tYWNjZW50LWNvbG9yOiMzYjgyZjY7LS1hY2NlbnQtZ2xvdzpyZ2JhKDU5LCAxMzAsIDI0NiwgMC41KTstLXRleHQtcHJpbWFyeTojZjhmYWZjOy0tdGV4dC1zZWNvbmRhcnk6Izk0YTNiODstLWdsYXNzLWJnOnJnYmEoMjMsIDI4LCA0MSwgMC43NSk7LS1nbGFzcy1ib3JkZXI6cmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpOy0tcGFuZWwtcmFkaXVzOjE2cHh9KnttYXJnaW46MDtwYWRkaW5nOjA7Ym94LXNpemluZzpib3JkZXItYm94Oy13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvcjp0cmFuc3BhcmVudH1ib2R5e2ZvbnQtZmFtaWx5OidJbnRlcicsIHNhbnMtc2VyaWY7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1iZy1jb2xvcik7Y29sb3I6dmFyKC0tdGV4dC1wcmltYXJ5KTtvdmVyZmxvdzpoaWRkZW47aGVpZ2h0OjEwMHZoO3dpZHRoOjEwMHZ3fSNhcHB7cG9zaXRpb246cmVsYXRpdmU7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJX0jdmlld2VyLWNhbnZhc3twb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTt6LWluZGV4OjF9I3VpLW92ZXJsYXl7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7cG9pbnRlci1ldmVudHM6bm9uZTt6LWluZGV4OjEwO3BhZGRpbmc6MnJlbTtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2dhcDoycmVtO3RyYW5zaXRpb246YWxsIDAuNXMgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKX0jdWktb3ZlcmxheS5sb2FkZWR7YWxpZ24taXRlbXM6ZmxleC1zdGFydDtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1zdGFydH0jdWktb3ZlcmxheS5sb2FkZWQgaGVhZGVye3RleHQtYWxpZ246bGVmdH1oZWFkZXJ7cG9pbnRlci1ldmVudHM6YXV0bzt0ZXh0LWFsaWduOmNlbnRlcn1oZWFkZXIgaDF7Zm9udC1mYW1pbHk6J091dGZpdCcsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjIuNXJlbTtmb250LXdlaWdodDo3MDA7bGV0dGVyLXNwYWNpbmc6LTFweDttYXJnaW4tYm90dG9tOjAuMjVyZW19aGVhZGVyIGgxIHNwYW57Y29sb3I6dmFyKC0tYWNjZW50LWNvbG9yKTt0ZXh0LXNoYWRvdzowIDAgMjBweCB2YXIoLS1hY2NlbnQtZ2xvdyl9LnN1YnRpdGxle2NvbG9yOnZhcigtLXRleHQtc2Vjb25kYXJ5KTtmb250LXNpemU6MC45cmVtO3RleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTtsZXR0ZXItc3BhY2luZzoycHh9LmdsYXNzLXBhbmVse3BvaW50ZXItZXZlbnRzOmF1dG87YmFja2dyb3VuZDp2YXIoLS1nbGFzcy1iZyk7YmFja2Ryb3AtZmlsdGVyOmJsdXIoMTZweCk7LXdlYmtpdC1iYWNrZHJvcC1maWx0ZXI6Ymx1cigxNnB4KTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7Ym9yZGVyLXJhZGl1czp2YXIoLS1wYW5lbC1yYWRpdXMpO3BhZGRpbmc6MnJlbTtib3gtc2hhZG93OjAgMTJweCA0OHB4IHJnYmEoMCwgMCwgMCwgMC41KTt0cmFuc2l0aW9uOmFsbCAwLjNzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSl9LmdsYXNzLWJ0bnthcHBlYXJhbmNlOm5vbmU7Ym9yZGVyOm5vbmU7YmFja2dyb3VuZDp2YXIoLS1nbGFzcy1iZyk7YmFja2Ryb3AtZmlsdGVyOmJsdXIoMTZweCk7LXdlYmtpdC1iYWNrZHJvcC1maWx0ZXI6Ymx1cigxNnB4KTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7Y29sb3I6dmFyKC0tdGV4dC1wcmltYXJ5KTtwYWRkaW5nOjEwcHggMjBweDtib3JkZXItcmFkaXVzOjEycHg7Zm9udC13ZWlnaHQ6NjAwO2N1cnNvcjpwb2ludGVyO3BvaW50ZXItZXZlbnRzOmF1dG8gIWltcG9ydGFudDt6LWluZGV4OjEwMDt0cmFuc2l0aW9uOmFsbCAwLjNzIGVhc2U7ZGlzcGxheTppbmxpbmUtZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtnYXA6MC41cmVtO2ZvbnQtc2l6ZTowLjlyZW19LmdsYXNzLWJ0bjpob3ZlcntiYWNrZ3JvdW5kOnJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTtib3JkZXItY29sb3I6cmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0ycHgpO2JveC1zaGFkb3c6MCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMil9LmdsYXNzLWJ0bi5pY29uLW9ubHl7cGFkZGluZzowO3dpZHRoOjQ0cHg7aGVpZ2h0OjQ0cHg7Ym9yZGVyLXJhZGl1czo1MCV9I3RvZ2dsZS1saXN0LWJ0bntkaXNwbGF5Om5vbmV9I2Ryb3Atem9uZXt3aWR0aDozMjBweDtoZWlnaHQ6YXV0bzttaW4taGVpZ2h0OjE4MHB4O2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt0ZXh0LWFsaWduOmNlbnRlcjtjdXJzb3I6cG9pbnRlcjtib3JkZXI6MnB4IGRhc2hlZCB2YXIoLS1nbGFzcy1ib3JkZXIpO3RyYW5zaXRpb246YWxsIDAuM3MgZWFzZTtwYWRkaW5nOjJyZW19I3VpLW92ZXJsYXkubG9hZGVkICNkcm9wLXpvbmV7d2lkdGg6MjAwcHg7aGVpZ2h0OjgwcHg7bWluLWhlaWdodDowO3BhZGRpbmc6MC41cmVtfSN1aS1vdmVybGF5LmxvYWRlZCAjZHJvcC16b25lIC5pY29uLXVwbG9hZCwgI3VpLW92ZXJsYXkubG9hZGVkICNkcm9wLXpvbmUgaDMsICN1aS1vdmVybGF5LmxvYWRlZCAjZHJvcC16b25lIC5zdWJ0aXRsZS1zbWFsbHtkaXNwbGF5Om5vbmV9I3VpLW92ZXJsYXkubG9hZGVkICNkcm9wLXpvbmU6OmFmdGVye2NvbnRlbnQ6dmFyKC0tdGV4dC1sb2FkLW1vcmUsICJMb2FkIE1vcmUgRmlsZXMiKTtmb250LXNpemU6MC44cmVtO2ZvbnQtd2VpZ2h0OjYwMDtjb2xvcjp2YXIoLS1hY2NlbnQtY29sb3IpfS5zdWJ0aXRsZS1zbWFsbHtjb2xvcjp2YXIoLS10ZXh0LXNlY29uZGFyeSk7Zm9udC1zaXplOjAuOHJlbTttYXJnaW4tdG9wOjAuNXJlbTtvcGFjaXR5OjAuN30uZXh0ZXJuYWwtYWN0aW9uc3twb2ludGVyLWV2ZW50czphdXRvO3dpZHRoOjMyMHB4O2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfSN1aS1vdmVybGF5LmxvYWRlZCAuZXh0ZXJuYWwtYWN0aW9uc3tkaXNwbGF5Om5vbmV9I3VpLW92ZXJsYXkubG9hZGVkICNkcm9wLXpvbmUgLmRyb3AtY29udGVudCBzdmd7d2lkdGg6MjRweDtoZWlnaHQ6MjRweH0jdWktb3ZlcmxheS5sb2FkZWQgI2Ryb3Atem9uZSAuZHJvcC1jb250ZW50IHB7Zm9udC1zaXplOjAuOHJlbX0jdWktb3ZlcmxheS5sb2FkZWQgI2Ryb3Atem9uZSAuZHJvcC1jb250ZW50IHNtYWxse2Rpc3BsYXk6bm9uZX0jZHJvcC16b25lOmhvdmVyLCAjZHJvcC16b25lLmRyYWdvdmVye2JvcmRlci1jb2xvcjp2YXIoLS1hY2NlbnQtY29sb3IpO2JhY2tncm91bmQ6cmdiYSg1OSwgMTMwLCAyNDYsIDAuMSl9LmRyb3AtY29udGVudHtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6MC43NXJlbTtwb2ludGVyLWV2ZW50czpub25lfS5kcm9wLWNvbnRlbnQgc3Zne2NvbG9yOnZhcigtLXRleHQtc2Vjb25kYXJ5KTt0cmFuc2l0aW9uOmNvbG9yIDAuM3MgZWFzZX0jZHJvcC16b25lOmhvdmVyIHN2Z3tjb2xvcjp2YXIoLS1hY2NlbnQtY29sb3IpfS5kcm9wLWNvbnRlbnQgcHtmb250LXdlaWdodDo2MDB9LmRyb3AtY29udGVudCBzbWFsbHtjb2xvcjp2YXIoLS10ZXh0LXNlY29uZGFyeSl9I21lc2gtbGlzdHt3aWR0aDozMjBweDttYXgtaGVpZ2h0OjQwMHB4O292ZXJmbG93LXk6YXV0bztkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDoxcmVtO3Bvc2l0aW9uOmFic29sdXRlO3RvcDoycmVtO3JpZ2h0OjJyZW19I21lc2gtaXRlbXN7bWF4LWhlaWdodDozMDBweDtvdmVyZmxvdy15OmF1dG87ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtnYXA6MC44cmVtO3BhZGRpbmctcmlnaHQ6MC41cmVtfSNtZXNoLWl0ZW1zOjotd2Via2l0LXNjcm9sbGJhcnt3aWR0aDo2cHh9I21lc2gtaXRlbXM6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNre2JhY2tncm91bmQ6cmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA1KTtib3JkZXItcmFkaXVzOjNweH0jbWVzaC1pdGVtczo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWJ7YmFja2dyb3VuZDpyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7Ym9yZGVyLXJhZGl1czozcHh9I21lc2gtaXRlbXM6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVye2JhY2tncm91bmQ6cmdiYSgyNTUsIDI1NSwgMjU1LCAwLjMpfS50ZXh0LWJ0bntiYWNrZ3JvdW5kOm5vbmU7Ym9yZGVyOm5vbmU7Zm9udC1zaXplOjAuNzVyZW07Zm9udC13ZWlnaHQ6NjAwO2N1cnNvcjpwb2ludGVyO3RleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTtsZXR0ZXItc3BhY2luZzowLjVweDtwYWRkaW5nOjRweCA4cHg7Ym9yZGVyLXJhZGl1czo0cHg7cG9pbnRlci1ldmVudHM6YXV0byAhaW1wb3J0YW50O3RyYW5zaXRpb246YWxsIDAuMnN9LnRleHQtYnRuLmRhbmdlcntjb2xvcjojZjg3MTcxO2JhY2tncm91bmQ6cmdiYSgyMzksIDY4LCA2OCwgMC4xKX0udGV4dC1idG4uZGFuZ2VyOmhvdmVye2JhY2tncm91bmQ6cmdiYSgyMzksIDY4LCA2OCwgMC4yKX0ubGlzdC1oZWFkZXJ7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTtwYWRkaW5nLWJvdHRvbTowLjVyZW07ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2FsaWduLWl0ZW1zOmNlbnRlcn0ubGlzdC1oZWFkZXIgaDN7Zm9udC1zaXplOjAuOXJlbTt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bGV0dGVyLXNwYWNpbmc6MXB4O2NvbG9yOnZhcigtLWFjY2VudC1jb2xvcil9Lm1lc2gtaXRlbXtiYWNrZ3JvdW5kOnJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wMyk7Ym9yZGVyLXJhZGl1czo4cHg7cGFkZGluZzowLjc1cmVtO2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47Z2FwOjAuNXJlbTtwb3NpdGlvbjpyZWxhdGl2ZTtib3JkZXI6MXB4IHNvbGlkIHRyYW5zcGFyZW50O3RyYW5zaXRpb246Ym9yZGVyLWNvbG9yIDAuM3MgZWFzZX0ubWVzaC1pdGVtOmhvdmVye2JvcmRlci1jb2xvcjpyZ2JhKDU5LCAxMzAsIDI0NiwgMC4zKX0ubWVzaC1pdGVtLWhlYWRlcntkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyfS5tZXNoLWl0ZW0tbmFtZXtmb250LXdlaWdodDo2MDA7Zm9udC1zaXplOjAuODVyZW07d2hpdGUtc3BhY2U6bm93cmFwO292ZXJmbG93OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzO21heC13aWR0aDoyMDBweH0ubWVzaC1jb250cm9sc3tkaXNwbGF5OmZsZXg7Z2FwOjAuNXJlbTttYXJnaW4tdG9wOjAuMjVyZW19Lm1lc2gtY29udHJvbHMgLnRleHQtYnRue3BhZGRpbmc6MnB4IDhweDtmb250LXNpemU6MC42NXJlbTtiYWNrZ3JvdW5kOnJnYmEoNTksIDEzMCwgMjQ2LCAwLjEpO2NvbG9yOiM2MGE1ZmE7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDU5LCAxMzAsIDI0NiwgMC4yKX0ubWVzaC1jb250cm9scyAudGV4dC1idG46aG92ZXJ7YmFja2dyb3VuZDpyZ2JhKDU5LCAxMzAsIDI0NiwgMC4yKTtib3JkZXItY29sb3I6cmdiYSg1OSwgMTMwLCAyNDYsIDAuNCl9Lm1lc2gtaXRlbS1zdGF0c3tkaXNwbGF5OmZsZXg7Z2FwOjFyZW07Zm9udC1zaXplOjAuN3JlbTtjb2xvcjp2YXIoLS10ZXh0LXNlY29uZGFyeSl9I2xvYWRpbmctb3ZlcmxheXtwb3NpdGlvbjpmaXhlZDt0b3A6MDtsZWZ0OjA7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtiYWNrZ3JvdW5kOnJnYmEoMTMsIDE1LCAyMCwgMC44KTt6LWluZGV4OjEwMDtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2dhcDoxLjVyZW07cG9pbnRlci1ldmVudHM6YXV0b30ubG9hZGVye3dpZHRoOjQ4cHg7aGVpZ2h0OjQ4cHg7Ym9yZGVyOjNweCBzb2xpZCB2YXIoLS1hY2NlbnQtY29sb3IpO2JvcmRlci1ib3R0b20tY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyLXJhZGl1czo1MCU7YW5pbWF0aW9uOnJvdGF0aW9uIDFzIGxpbmVhciBpbmZpbml0ZX1Aa2V5ZnJhbWVzIHJvdGF0aW9uezAle3RyYW5zZm9ybTpyb3RhdGUoMGRlZyl9MTAwJXt0cmFuc2Zvcm06cm90YXRlKDM2MGRlZyl9fSNtb2JpbGUtY29udHJvbHN7cG9zaXRpb246YWJzb2x1dGU7Ym90dG9tOjJyZW07bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7ei1pbmRleDoyMDtkaXNwbGF5Om5vbmU7Z2FwOjFyZW19QG1lZGlhIChtYXgtd2lkdGg6NzY4cHgpeyNtb2JpbGUtY29udHJvbHN7ZGlzcGxheTpmbGV4fSNkcm9wLXpvbmV7d2lkdGg6MjgwcHg7bWluLWhlaWdodDoyMDBweH0jdWktb3ZlcmxheS5sb2FkZWQgI2Ryb3Atem9uZXt3aWR0aDoxNjBweDtoZWlnaHQ6NjBweDtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6N3JlbTtsZWZ0OjFyZW07bWFyZ2luOjB9LmV4dGVybmFsLWFjdGlvbnN7d2lkdGg6MjgwcHh9I21lc2gtbGlzdHtwb3NpdGlvbjpmaXhlZDt0b3A6MXJlbTtyaWdodDoxcmVtO3dpZHRoOmF1dG87bWF4LXdpZHRoOjkwdnc7bWF4LWhlaWdodDo4MHZoO3otaW5kZXg6NTA7YmFja2dyb3VuZDp0cmFuc3BhcmVudDtib3JkZXI6bm9uZTtiYWNrZHJvcC1maWx0ZXI6bm9uZTtib3gtc2hhZG93Om5vbmU7cGFkZGluZzowO2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47YWxpZ24taXRlbXM6ZmxleC1lbmR9I3RvZ2dsZS1saXN0LWJ0bntkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7d2lkdGg6NDRweDtoZWlnaHQ6NDRweDtib3JkZXItcmFkaXVzOjUwJTtiYWNrZ3JvdW5kOnZhcigtLWdsYXNzLWJnKTtiYWNrZHJvcC1maWx0ZXI6Ymx1cigxMnB4KTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWdsYXNzLWJvcmRlcik7Y29sb3I6dmFyKC0tdGV4dC1wcmltYXJ5KTtjdXJzb3I6cG9pbnRlcjt6LWluZGV4OjUxO3RyYW5zaXRpb246YWxsIDAuMnMgZWFzZX0jdG9nZ2xlLWxpc3QtYnRuOmhvdmVye2JhY2tncm91bmQ6cmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpfS5saXN0LWNvbnRhaW5lcntkaXNwbGF5Om5vbmU7bWFyZ2luLXRvcDoxcmVtO2JhY2tncm91bmQ6dmFyKC0tZ2xhc3MtYmcpO2JhY2tkcm9wLWZpbHRlcjpibHVyKDEycHgpO2JvcmRlcjoxcHggc29saWQgdmFyKC0tZ2xhc3MtYm9yZGVyKTtib3JkZXItcmFkaXVzOjEycHg7cGFkZGluZzoxcmVtO3dpZHRoOjI2MHB4O2JveC1zaGFkb3c6MCA4cHggMzJweCByZ2JhKDAsIDAsIDAsIDAuMyk7ZmxleC1kaXJlY3Rpb246Y29sdW1ufSNtZXNoLWxpc3QuZXhwYW5kZWQgLmxpc3QtY29udGFpbmVye2Rpc3BsYXk6ZmxleDthbmltYXRpb246c2xpZGVJbiAwLjJzIGVhc2Utb3V0fSNtZXNoLWxpc3QuZXhwYW5kZWQgI3RvZ2dsZS1saXN0LWJ0bntiYWNrZ3JvdW5kOnZhcigtLWFjY2VudC1jb2xvcik7Ym9yZGVyLWNvbG9yOnZhcigtLWFjY2VudC1jb2xvcik7Y29sb3I6d2hpdGV9QGtleWZyYW1lcyBzbGlkZUlue2Zyb217b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0xMHB4KX10b3tvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCl9fX0ubG9nLWVudHJ5e3BhZGRpbmc6MnB4IDA7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA1KX0ubG9nLWVycm9ye2NvbG9yOiNmODcxNzF9LmxvZy1pbmZve2NvbG9yOiM2MGE1ZmF9LmhpZGRlbntkaXNwbGF5Om5vbmUgIWltcG9ydGFudH1AbWVkaWEgKG1heC13aWR0aDo3NjhweCl7I3VpLW92ZXJsYXl7cGFkZGluZzoxLjVyZW07Z2FwOjFyZW19aGVhZGVyIGgxe2ZvbnQtc2l6ZToxLjhyZW19I2Ryb3Atem9uZSwgI2luZm8tcGFuZWx7d2lkdGg6MTAwJX0jZHJvcC16b25le2hlaWdodDoxNDBweH0uc3VidGl0bGV7Zm9udC1zaXplOjAuN3JlbX19W2RhdGEtdG9vbHRpcF17cG9zaXRpb246cmVsYXRpdmV9W2RhdGEtdG9vbHRpcF06aG92ZXI6OmFmdGVye2NvbnRlbnQ6YXR0cihkYXRhLXRvb2x0aXApO3Bvc2l0aW9uOmFic29sdXRlO2JvdHRvbToxMjAlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpO2JhY2tncm91bmQ6cmdiYSgxMywgMTUsIDIwLCAwLjk1KTtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTtjb2xvcjp2YXIoLS10ZXh0LXByaW1hcnkpO3BhZGRpbmc6NnB4IDEycHg7Ym9yZGVyLXJhZGl1czo4cHg7Zm9udC1zaXplOjAuODVyZW07d2hpdGUtc3BhY2U6bm93cmFwO2JhY2tkcm9wLWZpbHRlcjpibHVyKDhweCk7Ym94LXNoYWRvdzowIDRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC40KTtwb2ludGVyLWV2ZW50czpub25lO29wYWNpdHk6MDthbmltYXRpb246dG9vbHRpcEZhZGUgMC4ycyBmb3J3YXJkczt6LWluZGV4OjEwMDB9QGtleWZyYW1lcyB0b29sdGlwRmFkZXt0b3tvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSkgdHJhbnNsYXRlWSgtNXB4KX19LmFjdGlvbnMtY29udGFpbmVye2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47Z2FwOjAuOHJlbTt3aWR0aDoxMDAlO21heC13aWR0aDoyODBweDttYXJnaW4tdG9wOjFyZW19LnVwbG9hZC1idG57ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2dhcDowLjZyZW07cGFkZGluZzoxMnB4IDIwcHg7YmFja2dyb3VuZDp2YXIoLS1hY2NlbnQtY29sb3IpO2NvbG9yOndoaXRlO2JvcmRlcjoxcHggc29saWQgdHJhbnNwYXJlbnQ7Ym9yZGVyLXJhZGl1czoxMnB4O2N1cnNvcjpwb2ludGVyO2ZvbnQtd2VpZ2h0OjYwMDt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7Zm9udC1zaXplOjAuOXJlbTtsZXR0ZXItc3BhY2luZzowLjVweDtwb2ludGVyLWV2ZW50czphdXRvICFpbXBvcnRhbnQ7ei1pbmRleDoxMDA7dHJhbnNpdGlvbjphbGwgMC4yNXMgY3ViaWMtYmV6aWVyKDAuMTksIDEsIDAuMjIsIDEpO3dpZHRoOjEwMCU7cG9zaXRpb246cmVsYXRpdmU7b3ZlcmZsb3c6aGlkZGVufS51cGxvYWQtYnRuLnByaW1hcnl7YmFja2dyb3VuZDp2YXIoLS1hY2NlbnQtY29sb3IpO2JveC1zaGFkb3c6MCA0cHggMTVweCB2YXIoLS1hY2NlbnQtZ2xvdyl9LnVwbG9hZC1idG4uc2Vjb25kYXJ5e2JhY2tncm91bmQ6cmdiYSgyNTUsIDI1NSwgMjU1LCAwLjAzKTtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTtjb2xvcjp2YXIoLS10ZXh0LXNlY29uZGFyeSl9LnVwbG9hZC1idG46aG92ZXJ7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTJweCk7Y29sb3I6d2hpdGV9LnVwbG9hZC1idG4ucHJpbWFyeTpob3Zlcntib3gtc2hhZG93OjAgOHB4IDI1cHggdmFyKC0tYWNjZW50LWdsb3cpO2ZpbHRlcjpicmlnaHRuZXNzKDEuMSl9LnVwbG9hZC1idG4uc2Vjb25kYXJ5OmhvdmVye2JvcmRlci1jb2xvcjp2YXIoLS1hY2NlbnQtY29sb3IpO2JhY2tncm91bmQ6cmdiYSg1OSwgMTMwLCAyNDYsIDAuMSk7Ym94LXNoYWRvdzowIDRweCAxNXB4IHJnYmEoNTksIDEzMCwgMjQ2LCAwLjIpfS5idG4taWNvbntmb250LXNpemU6MS4xcmVtfSNyZXNldC1jYW17cG9zaXRpb246YWJzb2x1dGU7Ym90dG9tOjJyZW07bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7ei1pbmRleDoyMH0jaW5mby1idG57cG9zaXRpb246YWJzb2x1dGU7Ym90dG9tOjJyZW07cmlnaHQ6MnJlbTt6LWluZGV4OjIwO3BvaW50ZXItZXZlbnRzOmF1dG87Y3Vyc29yOnBvaW50ZXJ9I2JveC1zZWxlY3QtYnRue3Bvc2l0aW9uOmFic29sdXRlO2JvdHRvbTo2cmVtO3JpZ2h0OjJyZW07ei1pbmRleDoyMDtwb2ludGVyLWV2ZW50czphdXRvO2N1cnNvcjpwb2ludGVyO3RyYW5zaXRpb246YWxsIDAuM3MgY3ViaWMtYmV6aWVyKDAuMTc1LCAwLjg4NSwgMC4zMiwgMS4yNzUpfSNib3gtc2VsZWN0LWJ0bi5hY3RpdmV7YmFja2dyb3VuZDp2YXIoLS1hY2NlbnQtY29sb3IpO2JvcmRlci1jb2xvcjp2YXIoLS1hY2NlbnQtY29sb3IpO2NvbG9yOndoaXRlO2JveC1zaGFkb3c6MCAwIDE1cHggdmFyKC0tYWNjZW50LWdsb3cpO3RyYW5zZm9ybTpzY2FsZSgxLjEpfSN0b3AtYmFye3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDAlO3BhZGRpbmc6MXJlbSAycmVtO2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2dhcDoycmVtO2FsaWduLWl0ZW1zOmNlbnRlcjtwb2ludGVyLWV2ZW50czpub25lO3otaW5kZXg6MTU7Zm9udC1zaXplOjAuOHJlbTtjb2xvcjp2YXIoLS10ZXh0LXNlY29uZGFyeSk7dGV4dC1zaGFkb3c6MCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC41KX0jY2FtZXJhLWNvb3Jkc3tmb250LWZhbWlseTptb25vc3BhY2U7b3BhY2l0eTowLjh9I2luZm8tbW9kYWx7cG9zaXRpb246YWJzb2x1dGU7dG9wOjUwJTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsIC01MCUpO3dpZHRoOjkwJTttYXgtd2lkdGg6NDAwcHg7ei1pbmRleDoxMDA7dGV4dC1hbGlnbjpjZW50ZXI7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtnYXA6MXJlbX0jaW5mby1tb2RhbCBoM3tjb2xvcjp2YXIoLS1hY2NlbnQtY29sb3IpfSNpbmZvLW1vZGFsIHB7Zm9udC1zaXplOjAuOXJlbTtsaW5lLWhlaWdodDoxLjU7Y29sb3I6dmFyKC0tdGV4dC1wcmltYXJ5KX0jaW5mby1tb2RhbCBzdHJvbmd7Y29sb3I6dmFyKC0tYWNjZW50LWNvbG9yKX0udW5sb2FkLWJ0bntiYWNrZ3JvdW5kOnJnYmEoMjM5LCA2OCwgNjgsIDAuMSk7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDIzOSwgNjgsIDY4LCAwLjIpO2NvbG9yOiNmODcxNzE7Zm9udC1zaXplOjAuN3JlbTtwYWRkaW5nOjJweCA4cHg7Ym9yZGVyLXJhZGl1czo0cHg7Y3Vyc29yOnBvaW50ZXI7Zm9udC13ZWlnaHQ6NjAwO3BvaW50ZXItZXZlbnRzOmF1dG8gIWltcG9ydGFudDt0cmFuc2l0aW9uOmFsbCAwLjJzfS51bmxvYWQtYnRuOmhvdmVye2JhY2tncm91bmQ6cmdiYSgyMzksIDY4LCA2OCwgMC4yKTtib3JkZXItY29sb3I6cmdiYSgyMzksIDY4LCA2OCwgMC40KX0jZGVidWctYm94e3Bvc2l0aW9uOmFic29sdXRlO2JvdHRvbToycmVtO2xlZnQ6MnJlbTt3aWR0aDozMDBweDttYXgtaGVpZ2h0OjIwMHB4O3BhZGRpbmc6MXJlbTtmb250LXNpemU6MC43NXJlbTtkaXNwbGF5Om5vbmU7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDowLjVyZW07ei1pbmRleDo1MDtwb2ludGVyLWV2ZW50czphdXRvICFpbXBvcnRhbnR9I2RlYnVnLWJveDpub3QoLmhpZGRlbil7ZGlzcGxheTpmbGV4ICFpbXBvcnRhbnR9I2RlYnVnLWxvZ3tvdmVyZmxvdy15OmF1dG87bWF4LWhlaWdodDoxNDBweH0ubG9nLWRlYnVne2NvbG9yOnZhcigtLXRleHQtc2Vjb25kYXJ5KTtvcGFjaXR5OjAuNztmb250LXNpemU6MC43cmVtfSN0cmFuc2Zvcm0tdG9vbGJhcntwb3NpdGlvbjpmaXhlZDt0b3A6MjYwcHg7bGVmdDoyMHB4O3JpZ2h0OmF1dG87cGFkZGluZzoxcmVtO21pbi13aWR0aDoyMjBweDt6LWluZGV4OjEwMH0udHJhbnNmb3JtLWJ1dHRvbnN7ZGlzcGxheTpmbGV4O2dhcDowLjVyZW07bWFyZ2luLWJvdHRvbToxcmVtfS50cmFuc2Zvcm0tYnRue2ZsZXg6MTtwYWRkaW5nOjAuNXJlbTtiYWNrZ3JvdW5kOnJnYmEoNTksIDEzMCwgMjQ2LCAwLjEpO2JvcmRlcjoxcHggc29saWQgcmdiYSg1OSwgMTMwLCAyNDYsIDAuMyk7Ym9yZGVyLXJhZGl1czo2cHg7Y29sb3I6I2NiZDVlMTtjdXJzb3I6cG9pbnRlcjt0cmFuc2l0aW9uOmFsbCAwLjJzO2ZvbnQtc2l6ZTowLjlyZW19LnRyYW5zZm9ybS1idG46aG92ZXJ7YmFja2dyb3VuZDpyZ2JhKDU5LCAxMzAsIDI0NiwgMC4zKTtjb2xvcjojZmZmfS50cmFuc2Zvcm0tYnRuLmFjdGl2ZXtiYWNrZ3JvdW5kOnJnYmEoNTksIDEzMCwgMjQ2LCAwLjYpO2JvcmRlci1jb2xvcjojM2I4MmY2O2NvbG9yOiNmZmY7Ym94LXNoYWRvdzowIDAgMTBweCByZ2JhKDU5LCAxMzAsIDI0NiwgMC4zKX0udHJhbnNmb3JtLXRvZ2dsZXN7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjttYXJnaW4tYm90dG9tOjAuNXJlbX0uaGludHtmb250LXNpemU6MC43NXJlbTtjb2xvcjojOTRhM2I4O3RleHQtYWxpZ246Y2VudGVyO21hcmdpbi10b3A6MC41cmVtO2JvcmRlci10b3A6MXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTtwYWRkaW5nLXRvcDowLjVyZW19LnRvZ2dsZS1zd2l0Y2h7cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtjdXJzb3I6cG9pbnRlcjt1c2VyLXNlbGVjdDpub25lfS50b2dnbGUtc3dpdGNoIGlucHV0e29wYWNpdHk6MDt3aWR0aDowO2hlaWdodDowfS5zbGlkZXJ7cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTppbmxpbmUtYmxvY2s7d2lkdGg6MzZweDtoZWlnaHQ6MjBweDtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTt0cmFuc2l0aW9uOi40cztib3JkZXItcmFkaXVzOjM0cHg7bWFyZ2luLXJpZ2h0OjEwcHh9LnNsaWRlcjpiZWZvcmV7cG9zaXRpb246YWJzb2x1dGU7Y29udGVudDoiIjtoZWlnaHQ6MTRweDt3aWR0aDoxNHB4O2xlZnQ6M3B4O2JvdHRvbTozcHg7YmFja2dyb3VuZC1jb2xvcjp3aGl0ZTt0cmFuc2l0aW9uOi40cztib3JkZXItcmFkaXVzOjUwJX1pbnB1dDpjaGVja2VkKy5zbGlkZXJ7YmFja2dyb3VuZC1jb2xvcjojM2I4MmY2fWlucHV0OmNoZWNrZWQrLnNsaWRlcjpiZWZvcmV7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoMTZweCl9LmxhYmVsLXRleHR7Zm9udC1zaXplOjAuOXJlbTtjb2xvcjojY2JkNWUxfS5tZXNoLWl0ZW0uc2VsZWN0ZWR7Ym9yZGVyLWxlZnQ6M3B4IHNvbGlkICMzYjgyZjY7YmFja2dyb3VuZDpyZ2JhKDU5LCAxMzAsIDI0NiwgMC4xKX0jb2JqZWN0LWNvb3Jkc3tmb250LWZhbWlseTptb25vc3BhY2U7Y29sb3I6IzNiODJmNjtmb250LXdlaWdodDo2MDA7b3BhY2l0eTowLjl9I21vYmlsZS10cmFuc2Zvcm0tdWl7cG9zaXRpb246Zml4ZWQ7Ym90dG9tOjgwcHg7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7d2lkdGg6OTAlO21heC13aWR0aDo0MDBweDt6LWluZGV4OjkwO2Rpc3BsYXk6bm9uZTtmbGV4LWRpcmVjdGlvbjpjb2x1bW47Z2FwOjAuOHJlbTtwYWRkaW5nOjFyZW19LnNsaWRlci1yb3d7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6MXJlbX0uYXhpcy1sYWJlbHtmb250LXdlaWdodDpib2xkO2ZvbnQtZmFtaWx5Om1vbm9zcGFjZTt3aWR0aDoyMHB4fS54LWF4aXN7Y29sb3I6I2Y4NzE3MX0ueS1heGlze2NvbG9yOiM0YWRlODB9LnotYXhpc3tjb2xvcjojNjBhNWZhfSNtb2JpbGUtdHJhbnNmb3JtLXVpIGlucHV0W3R5cGU9cmFuZ2Vde2ZsZXg6MTtjdXJzb3I6cG9pbnRlcjstd2Via2l0LWFwcGVhcmFuY2U6bm9uZTthcHBlYXJhbmNlOm5vbmU7YmFja2dyb3VuZDp0cmFuc3BhcmVudH0jc2VsZWN0aW9uLWJveHtwb3NpdGlvbjphYnNvbHV0ZTtib3JkZXI6MXB4IHNvbGlkIHJnYmEoNTksIDEzMCwgMjQ2LCAwLjgpO2JhY2tncm91bmQtY29sb3I6cmdiYSg1OSwgMTMwLCAyNDYsIDAuMSk7cG9pbnRlci1ldmVudHM6bm9uZTt6LWluZGV4OjEwMDB9I21vYmlsZS10cmFuc2Zvcm0tdWkgaW5wdXRbdHlwZT1yYW5nZV06Oi13ZWJraXQtc2xpZGVyLXRodW1iey13ZWJraXQtYXBwZWFyYW5jZTpub25lO2hlaWdodDoyMHB4O3dpZHRoOjIwcHg7Ym9yZGVyLXJhZGl1czo1MCU7YmFja2dyb3VuZDojZmZmO2N1cnNvcjpwb2ludGVyO21hcmdpbi10b3A6LThweDtib3gtc2hhZG93OjAgMCA1cHggcmdiYSgwLCAwLCAwLCAwLjUpfSNtb2JpbGUtdHJhbnNmb3JtLXVpIGlucHV0W3R5cGU9cmFuZ2VdOjotd2Via2l0LXNsaWRlci1ydW5uYWJsZS10cmFja3t3aWR0aDoxMDAlO2hlaWdodDo0cHg7Y3Vyc29yOnBvaW50ZXI7YmFja2dyb3VuZDpyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7Ym9yZGVyLXJhZGl1czoycHh9LmhpbnQtbW9iaWxle2ZvbnQtc2l6ZTowLjdyZW07Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpO3RleHQtYWxpZ246Y2VudGVyO21hcmdpbi10b3A6MC4ycmVtfUBtZWRpYSAobWF4LXdpZHRoOjc2OHB4KXsjbW9iaWxlLXRyYW5zZm9ybS11aS5hY3RpdmV7ZGlzcGxheTpmbGV4fSN0cmFuc2Zvcm0tdG9vbGJhcnt0b3A6YXV0bztib3R0b206MjQwcHg7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7bWluLXdpZHRoOjkwJX19");
        document.head.appendChild(s);
        
        // Decode and execute JS
        // Using new Function to run in global scope similar to eval but slightly cleaner
        var scriptContent = atob("LyoqCiogT3BlbkJWRSBNZXNoIFZpZXdlciAtIE11bHRpLU1lc2ggTWFuYWdlbWVudCAmIFRleHR1cmUgRml4ZXMKKi8KZnVuY3Rpb24gbG9nKG1zZywgdHlwZSA9ICdpbmZvJykgewpjb25zb2xlLmxvZyhgWyR7dHlwZX1dICR7bXNnfWApOwpjb25zdCBib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVidWctYm94Jyk7CmNvbnN0IGxvZ0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RlYnVnLWxvZycpOwppZiAoYm94ICYmIGxvZ0VsKSB7CmJveC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKYm94LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7IC8vIEZvcmNlIHZpc2liaWxpdHkKY29uc3QgZW50cnkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKZW50cnkuY2xhc3NOYW1lID0gYGxvZy1lbnRyeSBsb2ctJHt0eXBlfWA7CmNvbnN0IHRpbWUgPSBuZXcgRGF0ZSgpLnRvTG9jYWxlVGltZVN0cmluZygnZW4tVVMnLCB7IGhvdXIxMjogZmFsc2UsIGhvdXI6ICcyLWRpZ2l0JywgbWludXRlOiAnMi1kaWdpdCcsIHNlY29uZDogJzItZGlnaXQnIH0pOwplbnRyeS50ZXh0Q29udGVudCA9IGBbJHt0aW1lfV0gJHttc2d9YDsKbG9nRWwuYXBwZW5kQ2hpbGQoZW50cnkpOwovLyBBdXRvLXNjcm9sbCBsb2dpYwpjb25zdCBpc0F0Qm90dG9tID0gbG9nRWwuc2Nyb2xsSGVpZ2h0IC0gbG9nRWwuc2Nyb2xsVG9wIDw9IGxvZ0VsLmNsaWVudEhlaWdodCArIDUwOwppZiAoaXNBdEJvdHRvbSkgewpsb2dFbC5zY3JvbGxUb3AgPSBsb2dFbC5zY3JvbGxIZWlnaHQ7Cn0KfQp9Ci8vIEdsb2JhbCBFcnJvciBIYW5kbGVyIGZvciB2aXN1YWwgZmVlZGJhY2sKd2luZG93Lm9uZXJyb3IgPSBmdW5jdGlvbiAobXNnLCB1cmwsIGxpbmVObywgY29sdW1uTm8sIGVycm9yKSB7CmxvZyhgR2xvYmFsIEVycm9yOiAke21zZ30gYXQgJHtsaW5lTm99OiR7Y29sdW1uTm99YCwgJ2Vycm9yJyk7CnJldHVybiBmYWxzZTsKfTsKLy8gLS0tIEIzRC9DU1YgUGFyc2VyIENvbXBvbmVudCAtLS0KY2xhc3MgQjNEUGFyc2VyIHsKY29uc3RydWN0b3IoKSB7IHRoaXMucmVzZXQoKTsgfQpyZXNldCgpIHsgdGhpcy5tZXNoZXMgPSBbXTsgdGhpcy5jdXJyZW50TWVzaCA9IG51bGw7IH0KcGFyc2UodGV4dCwgaXNCM0QgPSBmYWxzZSkgewp0aGlzLnJlc2V0KCk7CmNvbnN0IGxpbmVzID0gdGhpcy5zdHJpcENvbW1lbnRzKHRleHQpOwpmb3IgKGxldCBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7CmNvbnN0IGxpbmUgPSBsaW5lc1tpXS50cmltKCk7CmlmICghbGluZSkgY29udGludWU7CmxldCBjbWQsIGFyZ3M7CmlmIChpc0IzRCkgewppZiAobGluZS5zdGFydHNXaXRoKCdbJykgJiYgbGluZS5lbmRzV2l0aCgnXScpKSB7CmNtZCA9IGxpbmUuc2xpY2UoMSwgLTEpLnRvTG93ZXJDYXNlKCk7IGFyZ3MgPSBbXTsKfSBlbHNlIHsKLy8gU3BsaXQgYnkgZmlyc3Qgd2hpdGVzcGFjZSBvbmx5IHRvIHByZXNlcnZlIHNwYWNlcyBpbiBmaWxlbmFtZXMgKG1hdGNoZXMgUHl0aG9uJ3Mgc3BsaXQoTm9uZSwgMSkpCmNvbnN0IG1hdGNoID0gbGluZS5tYXRjaCgvXihcUyspKD86XHMrKC4qKSk/JC8pOwppZiAobWF0Y2gpIHsKY21kID0gbWF0Y2hbMV0udG9Mb3dlckNhc2UoKTsKY29uc3QgYXJnU3RyID0gbWF0Y2hbMl0gfHwgJyc7CmFyZ3MgPSBhcmdTdHIuc3BsaXQoJywnKS5tYXAocyA9PiBzLnRyaW0oKSkuZmlsdGVyKHMgPT4gcyAhPT0gJycpOwp9IGVsc2Ugewpjb250aW51ZTsKfQp9Cn0gZWxzZSB7CmNvbnN0IHBhcnRzID0gbGluZS5zcGxpdCgnLCcpLm1hcChzID0+IHMudHJpbSgpKTsKY21kID0gcGFydHNbMF0udG9Mb3dlckNhc2UoKTsKYXJncyA9IHBhcnRzLnNsaWNlKDEpLmZpbHRlcihzID0+IHMgIT09ICcnKTsKfQp0aGlzLnByb2Nlc3NDb21tYW5kKGNtZCwgYXJncywgaSArIDEpOwp9CmlmICh0aGlzLmN1cnJlbnRNZXNoKSB0aGlzLm1lc2hlcy5wdXNoKHRoaXMuY3VycmVudE1lc2gpOwpyZXR1cm4gdGhpcy5zZXJpYWxpemUoKTsKfQpzdHJpcENvbW1lbnRzKHRleHQpIHsKY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KC9ccj9cbi8pOwpsZXQgaW5CbG9jayA9IGZhbHNlOyBjb25zdCByZXN1bHQgPSBbXTsKZm9yIChsZXQgbGluZSBvZiBsaW5lcykgewppZiAoaW5CbG9jaykgewpjb25zdCBlbmQgPSBsaW5lLmluZGV4T2YoJyovJyk7CmlmIChlbmQgIT09IC0xKSB7IGluQmxvY2sgPSBmYWxzZTsgbGluZSA9IGxpbmUuc2xpY2UoZW5kICsgMik7IH0gZWxzZSB7IHJlc3VsdC5wdXNoKCcnKTsgY29udGludWU7IH0KfQpsZXQgcyA9IGxpbmU7CmNvbnN0IHNlbWkgPSBzLmluZGV4T2YoJzsnKTsgaWYgKHNlbWkgIT09IC0xKSBzID0gcy5zbGljZSgwLCBzZW1pKTsKY29uc3Qgc2xhc2ggPSBzLmluZGV4T2YoJy8vJyk7IGlmIChzbGFzaCAhPT0gLTEgJiYgKHNsYXNoID09PSAwIHx8IHNbc2xhc2ggLSAxXSAhPT0gJzonKSkgcyA9IHMuc2xpY2UoMCwgc2xhc2gpOwpjb25zdCBzdGFydCA9IHMuaW5kZXhPZignLyonKTsKaWYgKHN0YXJ0ICE9PSAtMSkgewpjb25zdCBlbmQgPSBzLmluZGV4T2YoJyovJywgc3RhcnQgKyAyKTsKaWYgKGVuZCAhPT0gLTEpIHMgPSBzLnNsaWNlKDAsIHN0YXJ0KSArIHMuc2xpY2UoZW5kICsgMik7IGVsc2UgeyBpbkJsb2NrID0gdHJ1ZTsgcyA9IHMuc2xpY2UoMCwgc3RhcnQpOyB9Cn0KcmVzdWx0LnB1c2gocyk7Cn0KcmV0dXJuIHJlc3VsdDsKfQpwcm9jZXNzQ29tbWFuZChjbWQsIGFyZ3MsIGxpbmVOdW0pIHsKY29uc3QgYnVpbGRlcktleXMgPSBbJ21lc2hidWlsZGVyJywgJ2NyZWF0ZW1lc2hidWlsZGVyJywgJ1ttZXNoYnVpbGRlcl0nXTsKaWYgKGJ1aWxkZXJLZXlzLmluY2x1ZGVzKGNtZCkpIHsKaWYgKHRoaXMuY3VycmVudE1lc2gpIHRoaXMubWVzaGVzLnB1c2godGhpcy5jdXJyZW50TWVzaCk7CnRoaXMuY3VycmVudE1lc2ggPSB7CnZlcnRpY2VzOiBbXSwKZmFjZXM6IFtdLAp1dnM6IFtdLAptYXRlcmlhbHM6IHsKY29sb3I6IFsyNTUsIDI1NSwgMjU1LCAyNTVdLAp0ZXh0dXJlOiBudWxsLAplbWlzc2l2ZTogWzAsIDAsIDBdLApibGVuZE1vZGU6ICdOb3JtYWwnLAp0cmFuc3BhcmVudENvbG9yOiBbMCwgMCwgMF0KfQp9OwpyZXR1cm47Cn0KaWYgKCF0aGlzLmN1cnJlbnRNZXNoKSByZXR1cm47CnN3aXRjaCAoY21kKSB7CmNhc2UgJ3ZlcnRleCc6IGNhc2UgJ2FkZHZlcnRleCc6CnRoaXMuY3VycmVudE1lc2gudmVydGljZXMucHVzaChwYXJzZUZsb2F0KGFyZ3NbMF0pIHx8IDAsIHBhcnNlRmxvYXQoYXJnc1sxXSkgfHwgMCwgLShwYXJzZUZsb2F0KGFyZ3NbMl0pIHx8IDApKTsgYnJlYWs7CmNhc2UgJ2ZhY2UnOiBjYXNlICdhZGRmYWNlJzogY2FzZSAnZmFjZTInOiBjYXNlICdhZGRmYWNlMic6CmNvbnN0IGYgPSBhcmdzLm1hcChpZHggPT4gcGFyc2VJbnQoaWR4KSkuZmlsdGVyKG4gPT4gIWlzTmFOKG4pKTsKaWYgKGYubGVuZ3RoID49IDMpIHsKdGhpcy5jdXJyZW50TWVzaC5mYWNlcy5wdXNoKGYucmV2ZXJzZSgpKTsKaWYgKGNtZC5lbmRzV2l0aCgnMicpKSB0aGlzLmN1cnJlbnRNZXNoLmZhY2VzLnB1c2goWy4uLmZdLnJldmVyc2UoKSk7Cn0gYnJlYWs7CmNhc2UgJ2N1YmUnOgp0aGlzLmNyZWF0ZUN1YmUodGhpcy5jdXJyZW50TWVzaCwgcGFyc2VGbG9hdChhcmdzWzBdKSB8fCAxLCBwYXJzZUZsb2F0KGFyZ3NbMV0pIHx8IDEsIHBhcnNlRmxvYXQoYXJnc1syXSkgfHwgMSk7IGJyZWFrOwpjYXNlICdjeWxpbmRlcic6CnsKY29uc3QgbiA9IHBhcnNlSW50KGFyZ3NbMF0pIHx8IDg7CmNvbnN0IHIxID0gYXJncy5sZW5ndGggPiAxID8gcGFyc2VGbG9hdChhcmdzWzFdKSA6IDE7CmNvbnN0IHIyID0gYXJncy5sZW5ndGggPiAyID8gcGFyc2VGbG9hdChhcmdzWzJdKSA6IDE7CmNvbnN0IGggPSBhcmdzLmxlbmd0aCA+IDMgPyBwYXJzZUZsb2F0KGFyZ3NbM10pIDogMTsKdGhpcy5jcmVhdGVDeWxpbmRlcih0aGlzLmN1cnJlbnRNZXNoLCBuLCByMSwgcjIsIGgpOwp9IGJyZWFrOwpjYXNlICdjb2xvcic6IGNhc2UgJ3NldGNvbG9yJzoKdGhpcy5jdXJyZW50TWVzaC5tYXRlcmlhbHMuY29sb3IgPSBbcGFyc2VJbnQoYXJnc1swXSkgfHwgMjU1LCBwYXJzZUludChhcmdzWzFdKSB8fCAyNTUsIHBhcnNlSW50KGFyZ3NbMl0pIHx8IDI1NSwgcGFyc2VJbnQoYXJnc1szXSkgfHwgMjU1XTsgYnJlYWs7CmNhc2UgJ2VtaXNzaXZlY29sb3InOiBjYXNlICdzZXRlbWlzc2l2ZWNvbG9yJzoKdGhpcy5jdXJyZW50TWVzaC5tYXRlcmlhbHMuZW1pc3NpdmUgPSBbcGFyc2VJbnQoYXJnc1swXSkgfHwgMCwgcGFyc2VJbnQoYXJnc1sxXSkgfHwgMCwgcGFyc2VJbnQoYXJnc1syXSkgfHwgMF07IGJyZWFrOwpjYXNlICdibGVuZG1vZGUnOiBjYXNlICdibGVuZGluZ21vZGUnOiBjYXNlICdzZXRibGVuZG1vZGUnOgp0aGlzLmN1cnJlbnRNZXNoLm1hdGVyaWFscy5ibGVuZE1vZGUgPSBhcmdzWzBdIHx8ICdOb3JtYWwnOyBicmVhazsKY2FzZSAndHJhbnNwYXJlbnQnOiBjYXNlICdzZXRkZWNhbHRyYW5zcGFyZW50Y29sb3InOgp0aGlzLmN1cnJlbnRNZXNoLm1hdGVyaWFscy50cmFuc3BhcmVudENvbG9yID0gW3BhcnNlSW50KGFyZ3NbMF0pIHx8IDAsIHBhcnNlSW50KGFyZ3NbMV0pIHx8IDAsIHBhcnNlSW50KGFyZ3NbMl0pIHx8IDBdOyBicmVhazsKY2FzZSAnY29vcmRpbmF0ZXMnOiBjYXNlICdzZXR0ZXh0dXJlY29vcmRpbmF0ZXMnOgovLyBPcGVuQlZFIGNvb3JkaW5hdGVzIGFyZSBuYXR1cmFsbHkgaGFuZGxlZCBpZiB0ZXh0dXJlLmZsaXBZID0gZmFsc2UKdGhpcy5jdXJyZW50TWVzaC51dnNbcGFyc2VJbnQoYXJnc1swXSldID0gW3BhcnNlRmxvYXQoYXJnc1sxXSkgfHwgMCwgcGFyc2VGbG9hdChhcmdzWzJdKSB8fCAwXTsKYnJlYWs7CmNhc2UgJ2xvYWQnOiBjYXNlICd0ZXh0dXJlJzogY2FzZSAnbG9hZHRleHR1cmUnOgpsZXQgdGV4ID0gYXJnc1swXSB8fCBudWxsOwppZiAodGV4KSB0ZXggPSB0ZXguc3BsaXQoL1tcXFwvXS8pLnBvcCgpLnRvTG93ZXJDYXNlKCk7CnRoaXMuY3VycmVudE1lc2gubWF0ZXJpYWxzLnRleHR1cmUgPSB0ZXg7CmJyZWFrOwpjYXNlICd0cmFuc2xhdGUnOiBjYXNlICd0cmFuc2xhdGVhbGwnOgp0aGlzLmFwcGx5VHJhbnNsYXRpb24odGhpcy5jdXJyZW50TWVzaCwgcGFyc2VGbG9hdChhcmdzWzBdKSB8fCAwLCBwYXJzZUZsb2F0KGFyZ3NbMV0pIHx8IDAsIHBhcnNlRmxvYXQoYXJnc1syXSkgfHwgMCk7IGJyZWFrOwpjYXNlICdzY2FsZSc6IGNhc2UgJ3NjYWxlYWxsJzoKdGhpcy5hcHBseVNjYWxlKHRoaXMuY3VycmVudE1lc2gsIHBhcnNlRmxvYXQoYXJnc1swXSkgfHwgMSwgcGFyc2VGbG9hdChhcmdzWzFdKSB8fCAxLCBwYXJzZUZsb2F0KGFyZ3NbMl0pIHx8IDEpOyBicmVhazsKY2FzZSAncm90YXRlJzogY2FzZSAncm90YXRlYWxsJzoKdGhpcy5hcHBseVJvdGF0aW9uKHRoaXMuY3VycmVudE1lc2gsIHBhcnNlRmxvYXQoYXJnc1swXSkgfHwgMCwgcGFyc2VGbG9hdChhcmdzWzFdKSB8fCAwLCBwYXJzZUZsb2F0KGFyZ3NbMl0pIHx8IDAsIChwYXJzZUZsb2F0KGFyZ3NbM10pIHx8IDApICogKE1hdGguUEkgLyAxODApKTsgYnJlYWs7CmNhc2UgJ3NoZWFyJzogY2FzZSAnc2hlYXJhbGwnOgp0aGlzLmFwcGx5U2hlYXIodGhpcy5jdXJyZW50TWVzaCwKW3BhcnNlRmxvYXQoYXJnc1swXSkgfHwgMCwgcGFyc2VGbG9hdChhcmdzWzFdKSB8fCAwLCBwYXJzZUZsb2F0KGFyZ3NbMl0pIHx8IDBdLApbcGFyc2VGbG9hdChhcmdzWzNdKSB8fCAwLCBwYXJzZUZsb2F0KGFyZ3NbNF0pIHx8IDAsIHBhcnNlRmxvYXQoYXJnc1s1XSkgfHwgMF0sCnBhcnNlRmxvYXQoYXJnc1s2XSkgfHwgMAopOwpicmVhazsKY2FzZSAnbWlycm9yJzogY2FzZSAnbWlycm9yYWxsJzoKdGhpcy5hcHBseU1pcnJvcih0aGlzLmN1cnJlbnRNZXNoLCAocGFyc2VGbG9hdChhcmdzWzBdKSB8fCAwKSAhPT0gMCwgKHBhcnNlRmxvYXQoYXJnc1sxXSkgfHwgMCkgIT09IDAsIChwYXJzZUZsb2F0KGFyZ3NbMl0pIHx8IDApICE9PSAwKTsKYnJlYWs7Cn0KfQpjcmVhdGVDdWJlKG1lc2gsIHN4LCBzeSwgc3opIHsKY29uc3QgdiA9IG1lc2gudmVydGljZXMubGVuZ3RoIC8gMzsKLy8gVmVydGljZXMKbWVzaC52ZXJ0aWNlcy5wdXNoKHN4LCBzeSwgLXN6KTsKbWVzaC52ZXJ0aWNlcy5wdXNoKHN4LCAtc3ksIC1zeik7Cm1lc2gudmVydGljZXMucHVzaCgtc3gsIC1zeSwgLXN6KTsKbWVzaC52ZXJ0aWNlcy5wdXNoKC1zeCwgc3ksIC1zeik7Cm1lc2gudmVydGljZXMucHVzaChzeCwgc3ksIHN6KTsKbWVzaC52ZXJ0aWNlcy5wdXNoKHN4LCAtc3ksIHN6KTsKbWVzaC52ZXJ0aWNlcy5wdXNoKC1zeCwgLXN5LCBzeik7Cm1lc2gudmVydGljZXMucHVzaCgtc3gsIHN5LCBzeik7Ci8vIEZhY2VzCm1lc2guZmFjZXMucHVzaChbdiArIDMsIHYgKyAyLCB2ICsgMSwgdiArIDBdKTsKbWVzaC5mYWNlcy5wdXNoKFt2ICsgMSwgdiArIDUsIHYgKyA0LCB2ICsgMF0pOwptZXNoLmZhY2VzLnB1c2goW3YgKyA0LCB2ICsgNywgdiArIDMsIHYgKyAwXSk7Cm1lc2guZmFjZXMucHVzaChbdiArIDcsIHYgKyA2LCB2ICsgNSwgdiArIDRdKTsKbWVzaC5mYWNlcy5wdXNoKFt2ICsgMiwgdiArIDMsIHYgKyA3LCB2ICsgNl0pOwptZXNoLmZhY2VzLnB1c2goW3YgKyA1LCB2ICsgNiwgdiArIDIsIHYgKyAxXSk7Cn0KY3JlYXRlQ3lsaW5kZXIobWVzaCwgbiwgcjEsIHIyLCBoKSB7Ci8vIEJhc2VkIG9uIENTVi5weQpjb25zdCB1cHBlcmNhcCA9IHIxID4gMC4wOwpjb25zdCBsb3dlcmNhcCA9IHIyID4gMC4wOwpjb25zdCBtID0gKHVwcGVyY2FwID8gMSA6IDApICsgKGxvd2VyY2FwID8gMSA6IDApOwpyMSA9IE1hdGguYWJzKHIxKTsgcjIgPSBNYXRoLmFicyhyMik7CmNvbnN0IHYgPSBtZXNoLnZlcnRpY2VzLmxlbmd0aCAvIDM7CmNvbnN0IGQgPSAyLjAgKiBNYXRoLlBJIC8gbjsKY29uc3QgZyA9IDAuNSAqIGg7CmxldCB0ID0gMC4wOwovLyBWZXJ0aWNlcwpmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykgewpjb25zdCBkeCA9IE1hdGguY29zKHQpOwpjb25zdCBkeiA9IE1hdGguc2luKHQpOwpjb25zdCBseCA9IGR4ICogcjIsIGx6ID0gZHogKiByMjsKY29uc3QgdXggPSBkeCAqIHIxLCB1eiA9IGR6ICogcjE7Cm1lc2gudmVydGljZXMucHVzaCh1eCwgZywgdXopOwptZXNoLnZlcnRpY2VzLnB1c2gobHgsIC1nLCBseik7CnQgKz0gZDsKfQovLyBGYWNlcyAoU2lkZSkKZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHsKY29uc3QgaTAgPSAoMiAqIGkgKyAyKSAlICgyICogbik7CmNvbnN0IGkxID0gKDIgKiBpICsgMykgJSAoMiAqIG4pOwpjb25zdCBpMiA9IDIgKiBpICsgMTsKY29uc3QgaTMgPSAyICogaTsKbWVzaC5mYWNlcy5wdXNoKFt2ICsgaTMsIHYgKyBpMiwgdiArIGkxLCB2ICsgaTBdKTsKfQovLyBDYXBzCmZvciAobGV0IGkgPSAwOyBpIDwgbTsgaSsrKSB7CmNvbnN0IGZhY2UgPSBbXTsKZm9yIChsZXQgaiA9IDA7IGogPCBuOyBqKyspIHsKaWYgKGkgPT09IDAgJiYgbG93ZXJjYXApIHsKZmFjZS5wdXNoKHYgKyAyICogaiArIDEpOwp9IGVsc2UgewpmYWNlLnB1c2godiArIDIgKiAobiAtIGogLSAxKSk7Cn0KfQptZXNoLmZhY2VzLnB1c2goZmFjZS5yZXZlcnNlKCkpOwp9Cn0KYXBwbHlUcmFuc2xhdGlvbihtLCB4LCB5LCB6KSB7IGZvciAobGV0IGkgPSAwOyBpIDwgbS52ZXJ0aWNlcy5sZW5ndGg7IGkgKz0gMykgeyBtLnZlcnRpY2VzW2ldICs9IHg7IG0udmVydGljZXNbaSArIDFdICs9IHk7IG0udmVydGljZXNbaSArIDJdICs9IHo7IH0gfQphcHBseVNjYWxlKG0sIHgsIHksIHopIHsKZm9yIChsZXQgaSA9IDA7IGkgPCBtLnZlcnRpY2VzLmxlbmd0aDsgaSArPSAzKSB7IG0udmVydGljZXNbaV0gKj0geDsgbS52ZXJ0aWNlc1tpICsgMV0gKj0geTsgbS52ZXJ0aWNlc1tpICsgMl0gKj0gejsgfQppZiAoeCAqIHkgKiB6IDwgMCkgbS5mYWNlcyA9IG0uZmFjZXMubWFwKGYgPT4gZi5yZXZlcnNlKCkpOwp9CmFwcGx5Um90YXRpb24obSwgcngsIHJ5LCByeiwgYW5nbGUpIHsKaWYgKGFuZ2xlID09PSAwKSByZXR1cm47IGNvbnN0IG1hZyA9IE1hdGguc3FydChyeCAqIHJ4ICsgcnkgKiByeSArIHJ6ICogcnopOyBpZiAobWFnID09PSAwKSByZXR1cm47CnJ4IC89IG1hZzsgcnkgLz0gbWFnOyByeiAvPSBtYWc7IGNvbnN0IGNvcyA9IE1hdGguY29zKGFuZ2xlKTsgY29uc3Qgc2luID0gTWF0aC5zaW4oYW5nbGUpOyBjb25zdCBvbWMgPSAxIC0gY29zOwpmb3IgKGxldCBpID0gMDsgaSA8IG0udmVydGljZXMubGVuZ3RoOyBpICs9IDMpIHsKY29uc3QgeCA9IG0udmVydGljZXNbaV07IGNvbnN0IHkgPSBtLnZlcnRpY2VzW2kgKyAxXTsgY29uc3QgeiA9IG0udmVydGljZXNbaSArIDJdOwptLnZlcnRpY2VzW2ldID0gKGNvcyArIHJ4ICogcnggKiBvbWMpICogeCArIChyeCAqIHJ5ICogb21jIC0gcnogKiBzaW4pICogeSArIChyeCAqIHJ6ICogb21jICsgcnkgKiBzaW4pICogejsKbS52ZXJ0aWNlc1tpICsgMV0gPSAocnkgKiByeCAqIG9tYyArIHJ6ICogc2luKSAqIHggKyAoY29zICsgcnkgKiByeSAqIG9tYykgKiB5ICsgKHJ5ICogcnogKiBvbWMgLSByeCAqIHNpbikgKiB6OwptLnZlcnRpY2VzW2kgKyAyXSA9IChyeiAqIHJ4ICogb21jIC0gcnkgKiBzaW4pICogeCArIChyeiAqIHJ5ICogb21jICsgcnggKiBzaW4pICogeSArIChjb3MgKyByeiAqIHJ6ICogb21jKSAqIHo7Cn0KfQphcHBseVNoZWFyKG0sIGQsIHMsIHIpIHsKY29uc3QgbWFnbml0dWRlID0gKHYpID0+IE1hdGguc3FydCh2WzBdICogdlswXSArIHZbMV0gKiB2WzFdICsgdlsyXSAqIHZbMl0pOwpjb25zdCBub3JtYWxpemUgPSAodikgPT4geyBjb25zdCBtYWcgPSBtYWduaXR1ZGUodik7IHJldHVybiBtYWcgPT09IDAgPyB2IDogW3ZbMF0gLyBtYWcsIHZbMV0gLyBtYWcsIHZbMl0gLyBtYWddOyB9OwpkID0gbm9ybWFsaXplKGQpOwpzID0gbm9ybWFsaXplKHMpOwpmb3IgKGxldCBpID0gMDsgaSA8IG0udmVydGljZXMubGVuZ3RoOyBpICs9IDMpIHsKY29uc3QgdnggPSBtLnZlcnRpY2VzW2ldLCB2eSA9IG0udmVydGljZXNbaSArIDFdLCB2eiA9IG0udmVydGljZXNbaSArIDJdOwpjb25zdCBkb3QgPSBkWzBdICogdnggKyBkWzFdICogdnkgKyBkWzJdICogdno7Cm0udmVydGljZXNbaV0gPSB2eCArIHNbMF0gKiByICogZG90OwptLnZlcnRpY2VzW2kgKyAxXSA9IHZ5ICsgc1sxXSAqIHIgKiBkb3Q7Cm0udmVydGljZXNbaSArIDJdID0gdnogKyBzWzJdICogciAqIGRvdDsKfQp9CmFwcGx5TWlycm9yKG0sIHZ4LCB2eSwgdnopIHsKY29uc3QgeG0gPSB2eCA/IC0xLjAgOiAxLjA7CmNvbnN0IHltID0gdnkgPyAtMS4wIDogMS4wOwpjb25zdCB6bSA9IHZ6ID8gLTEuMCA6IDEuMDsKLy8gSW52ZXJ0IHZlcnRpY2VzCmZvciAobGV0IGkgPSAwOyBpIDwgbS52ZXJ0aWNlcy5sZW5ndGg7IGkgKz0gMykgewptLnZlcnRpY2VzW2ldICo9IHhtOwptLnZlcnRpY2VzW2kgKyAxXSAqPSB5bTsKbS52ZXJ0aWNlc1tpICsgMl0gKj0gem07Cn0KLy8gUmV2ZXJzZSBmYWNlcyBpZiBvZGQgbnVtYmVyIG9mIGZsaXBzCmxldCBudW1GbGlwcyA9IDA7CmlmICh2eCkgbnVtRmxpcHMrKzsgaWYgKHZ5KSBudW1GbGlwcysrOyBpZiAodnopIG51bUZsaXBzKys7CmlmIChudW1GbGlwcyAlIDIgIT09IDApIHsKbS5mYWNlcyA9IG0uZmFjZXMubWFwKGYgPT4gZi5yZXZlcnNlKCkpOwp9Cn0Kc2VyaWFsaXplKCkgewpyZXR1cm4gdGhpcy5tZXNoZXMubWFwKG0gPT4gewpjb25zdCB0cmlWZXJ0cyA9IFtdOyBjb25zdCB0cmlVVnMgPSBbXTsKZm9yIChjb25zdCBmYWNlIG9mIG0uZmFjZXMpIHsKZm9yIChsZXQgaSA9IDE7IGkgPCBmYWNlLmxlbmd0aCAtIDE7IGkrKykgewpjb25zdCBpZHhzID0gW2ZhY2VbMF0sIGZhY2VbaV0sIGZhY2VbaSArIDFdXTsKZm9yIChjb25zdCBpZCBvZiBpZHhzKSB7CnRyaVZlcnRzLnB1c2gobS52ZXJ0aWNlc1tpZCAqIDNdLCBtLnZlcnRpY2VzW2lkICogMyArIDFdLCBtLnZlcnRpY2VzW2lkICogMyArIDJdKTsKaWYgKG0udXZzW2lkXSkgdHJpVVZzLnB1c2gobS51dnNbaWRdWzBdLCBtLnV2c1tpZF1bMV0pOyBlbHNlIHRyaVVWcy5wdXNoKDAsIDApOwp9Cn0KfQpyZXR1cm4geyB2ZXJ0aWNlczogbmV3IEZsb2F0MzJBcnJheSh0cmlWZXJ0cyksIHV2czogbmV3IEZsb2F0MzJBcnJheSh0cmlVVnMpLCBtYXRlcmlhbDogbS5tYXRlcmlhbHMgfTsKfSk7Cn0KfQovLyAtLS0gVmlld2VyIENvbXBvbmVudCAtLS0KY2xhc3MgVmlld2VyIHsKY29uc3RydWN0b3IoY2FudmFzSWQpIHsKdGhpcy5jYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjYW52YXNJZCk7CnRoaXMudGV4dHVyZUNhY2hlID0gbmV3IE1hcCgpOwp0aGlzLm1vZGVscyA9IG5ldyBNYXAoKTsgLy8gU3RvcmUgbW9kZWxzIGJ5IElECnRoaXMuaW5pdCgpOwp9CmluaXQoKSB7CnRoaXMuc2NlbmUgPSBuZXcgVEhSRUUuU2NlbmUoKTsKdGhpcy5zY2VuZS5iYWNrZ3JvdW5kID0gbmV3IFRIUkVFLkNvbG9yKDB4MGQwZjE0KTsKdGhpcy5jYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoNzUsIHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0LCAwLjEsIDEwMDApOwp0aGlzLmNhbWVyYS5wb3NpdGlvbi5zZXQoNSwgNSwgNSk7CnRoaXMucmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7IGNhbnZhczogdGhpcy5jYW52YXMsIGFudGlhbGlhczogdHJ1ZSwgYWxwaGE6IHRydWUgfSk7CnRoaXMucmVuZGVyZXIuc2V0U2l6ZSh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTsKdGhpcy5jb250cm9scyA9IG5ldyBUSFJFRS5PcmJpdENvbnRyb2xzKHRoaXMuY2FtZXJhLCB0aGlzLnJlbmRlcmVyLmRvbUVsZW1lbnQpOwp0aGlzLmNvbnRyb2xzLmVuYWJsZURhbXBpbmcgPSB0cnVlOwp0aGlzLmNvbnRyb2xzLmVuYWJsZVBhbiA9IHRydWU7CnRoaXMuY29udHJvbHMuc2NyZWVuU3BhY2VQYW5uaW5nID0gdHJ1ZTsKdGhpcy5jb250cm9scy50b3VjaGVzID0gewpPTkU6IFRIUkVFLlRPVUNILlJPVEFURSwKVFdPOiBUSFJFRS5UT1VDSC5ET0xMWV9QQU4KfTsKdGhpcy5jb250cm9scy5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7CmNvbnN0IHggPSB0aGlzLmNhbWVyYS5wb3NpdGlvbi54LnRvRml4ZWQoMik7CmNvbnN0IHkgPSB0aGlzLmNhbWVyYS5wb3NpdGlvbi55LnRvRml4ZWQoMik7CmNvbnN0IHogPSB0aGlzLmNhbWVyYS5wb3NpdGlvbi56LnRvRml4ZWQoMik7CmNvbnN0IGNvb3Jkc1BhcmFtcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW1lcmEtY29vcmRzJyk7CmlmIChjb29yZHNQYXJhbXMpIGNvb3Jkc1BhcmFtcy50ZXh0Q29udGVudCA9IGBDYW06ICR7eH0sICR7eX0sICR7en1gOwp9KTsKdGhpcy5zY2VuZS5hZGQobmV3IFRIUkVFLkFtYmllbnRMaWdodCgweGZmZmZmZiwgMS41KSk7Ci8vIEluZmluaXRlIEdyaWQgQXBwcm94aW1hdGlvbgovLyAyMDAwIHVuaXRzIHNpemUgLyAyMDAwIGRpdmlzaW9ucyA9IDEgdW5pdCAoMSBtZXRlcikgcGVyIHNxdWFyZQpjb25zdCBncmlkID0gbmV3IFRIUkVFLkdyaWRIZWxwZXIoMjAwMCwgMjAwMCwgMHgzYjgyZjYsIDB4MWUyOTNiKTsKZ3JpZC5wb3NpdGlvbi55ID0gLTAuNTsKZ3JpZC5tYXRlcmlhbC50cmFuc3BhcmVudCA9IHRydWU7CmdyaWQubWF0ZXJpYWwub3BhY2l0eSA9IDAuMjU7IC8vIExvd2VyIG9wYWNpdHkgc2luY2UgaXQncyBkZW5zZXIKLy8gVHJhbnNmb3JtIENvbnRyb2xzCnRoaXMudHJhbnNmb3JtQ29udHJvbCA9IG5ldyBUSFJFRS5UcmFuc2Zvcm1Db250cm9scyh0aGlzLmNhbWVyYSwgdGhpcy5yZW5kZXJlci5kb21FbGVtZW50KTsKdGhpcy50cmFuc2Zvcm1Db250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdnaW5nLWNoYW5nZWQnLCAoZXZlbnQpID0+IHsKdGhpcy5jb250cm9scy5lbmFibGVkID0gIWV2ZW50LnZhbHVlOwp9KTsKdGhpcy5zY2VuZS5hZGQodGhpcy50cmFuc2Zvcm1Db250cm9sKTsKdGhpcy5zY2VuZS5hZGQoZ3JpZCk7Ci8vIEZvZyBmb3IgZGVwdGgvaW5maW5pdGUgZmVlbAp0aGlzLnNjZW5lLmZvZyA9IG5ldyBUSFJFRS5Gb2dFeHAyKDB4MGQwZjE0LCAwLjAwMik7CmNvbnN0IGFuaW1hdGUgPSAoKSA9PiB7IHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKTsgdGhpcy5jb250cm9scy51cGRhdGUoKTsgdGhpcy5yZW5kZXJlci5yZW5kZXIodGhpcy5zY2VuZSwgdGhpcy5jYW1lcmEpOyB9OwphbmltYXRlKCk7Cn0KYWRkVGV4dHVyZShuYW1lLCB1cmwpIHsKY29uc3QgbG9hZGVyID0gbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKTsKY29uc3QgbG93ZXJOYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpOwpsb2coYFN0YXJ0aW5nIGxvYWQgZm9yIHRleHR1cmU6ICR7bmFtZX1gLCAnaW5mbycpOwpsb2FkZXIubG9hZCh1cmwsICh0ZXgpID0+IHsKdGV4LmFuaXNvdHJvcHkgPSA0Owp0ZXgud3JhcFMgPSBUSFJFRS5SZXBlYXRXcmFwcGluZzsKdGV4LndyYXBUID0gVEhSRUUuUmVwZWF0V3JhcHBpbmc7CnRleC5mbGlwWSA9IGZhbHNlOyAvLyBPcGVuQlZFIFVWcyBhcmUgWS1kb3duLCBtYXBwaW5nIGRpcmVjdGx5IHdvcmtzIGlmIHdlIGRvbid0IGZsaXAKdGV4LmNvbG9yU3BhY2UgPSBUSFJFRS5TUkdCQ29sb3JTcGFjZTsgLy8gRW5zdXJlIGNvcnJlY3QgY29sb3IgcHJvZmlsZQp0aGlzLnRleHR1cmVDYWNoZS5zZXQobG93ZXJOYW1lLCB0ZXgpOwpsb2coYFRleHR1cmUgbG9hZGVkOiAke25hbWV9YCwgJ2luZm8nKTsKLy8gUmVhY3RpdmUgVXBkYXRlOiBBcHBseSB0byBleGlzdGluZyBtZXNoZXMgd2FpdGluZyBmb3IgdGhpcyB0ZXh0dXJlCnRoaXMubW9kZWxzLmZvckVhY2goZ3JvdXAgPT4gewpncm91cC50cmF2ZXJzZShjaGlsZCA9PiB7CmlmIChjaGlsZC5pc01lc2ggJiYgY2hpbGQudXNlckRhdGEudGV4dHVyZU5hbWUgPT09IGxvd2VyTmFtZSkgewpjaGlsZC5tYXRlcmlhbC5tYXAgPSB0ZXg7CmNoaWxkLm1hdGVyaWFsLmNvbG9yLnNldEhleCgweGZmZmZmZik7IC8vIFJlc2V0IGNvbG9yIHRpbnQKY2hpbGQubWF0ZXJpYWwubmVlZHNVcGRhdGUgPSB0cnVlOwpsb2coYFJlYWN0aXZlOiBBcHBsaWVkICR7bmFtZX0gdG8gbWVzaGAsICdpbmZvJyk7Cn0KfSk7Cn0pOwp9LCB1bmRlZmluZWQsIChlcnIpID0+IHsKbG9nKGBGYWlsZWQgdG8gbG9hZCB0ZXh0dXJlICR7bmFtZX06ICR7ZXJyfWAsICdlcnJvcicpOwp9KTsKfQpsb2FkTW9kZWwoaWQsIG1lc2hEYXRhKSB7CmNvbnN0IGdyb3VwID0gbmV3IFRIUkVFLkdyb3VwKCk7Cm1lc2hEYXRhLmZvckVhY2goZGF0YSA9PiB7CmNvbnN0IGJ1ZmZlckdlbyA9IG5ldyBUSFJFRS5CdWZmZXJHZW9tZXRyeSgpOwpidWZmZXJHZW8uc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIG5ldyBUSFJFRS5CdWZmZXJBdHRyaWJ1dGUoZGF0YS52ZXJ0aWNlcywgMykpOwppZiAoZGF0YS51dnMgJiYgZGF0YS51dnMubGVuZ3RoID4gMCkgYnVmZmVyR2VvLnNldEF0dHJpYnV0ZSgndXYnLCBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKGRhdGEudXZzLCAyKSk7CmJ1ZmZlckdlby5jb21wdXRlVmVydGV4Tm9ybWFscygpOwpjb25zdCBjID0gZGF0YS5tYXRlcmlhbC5jb2xvcjsKY29uc3QgbWF0T3B0aW9ucyA9IHsKY29sb3I6IG5ldyBUSFJFRS5Db2xvcihjWzBdIC8gMjU1LCBjWzFdIC8gMjU1LCBjWzJdIC8gMjU1KSwKdHJhbnNwYXJlbnQ6IGNbM10gPCAyNTUsIG9wYWNpdHk6IGNbM10gLyAyNTUsCnNpZGU6IFRIUkVFLkRvdWJsZVNpZGUKfTsKY29uc3QgdGV4TmFtZSA9IGRhdGEubWF0ZXJpYWwudGV4dHVyZTsgLy8gQWxyZWFkeSBsb3dlcmNhc2VkIGJ5IHBhcnNlcgpsZXQgdGV4dHVyZVRvQXBwbHkgPSBudWxsOwppZiAodGV4TmFtZSkgewppZiAodGhpcy50ZXh0dXJlQ2FjaGUuaGFzKHRleE5hbWUpKSB7Cm1hdE9wdGlvbnMubWFwID0gdGhpcy50ZXh0dXJlQ2FjaGUuZ2V0KHRleE5hbWUpOwptYXRPcHRpb25zLmNvbG9yID0gbmV3IFRIUkVFLkNvbG9yKDEsIDEsIDEpOwp9IGVsc2Ugewpsb2coYFdhaXRpbmcgZm9yIHRleHR1cmU6ICR7dGV4TmFtZX0gKERyYWcvRHJvcCB0aGlzIGZpbGUgdG8gbG9hZClgLCAnaW5mbycpOwp9CnRleHR1cmVUb0FwcGx5ID0gdGV4TmFtZTsKfSBlbHNlIGlmIChkYXRhLm1hdGVyaWFsLmVtaXNzaXZlKSB7Ci8vIEFwcGx5IGVtaXNzaXZlIGlmIHNldApjb25zdCBlID0gZGF0YS5tYXRlcmlhbC5lbWlzc2l2ZTsKbWF0T3B0aW9ucy5lbWlzc2l2ZSA9IG5ldyBUSFJFRS5Db2xvcihlWzBdIC8gMjU1LCBlWzFdIC8gMjU1LCBlWzJdIC8gMjU1KTsKfQppZiAoZGF0YS5tYXRlcmlhbC5ibGVuZE1vZGUgPT09ICdBZGRpdGl2ZScpIHsKbWF0T3B0aW9ucy5ibGVuZGluZyA9IFRIUkVFLkFkZGl0aXZlQmxlbmRpbmc7Cm1hdE9wdGlvbnMuZGVwdGhXcml0ZSA9IGZhbHNlOwp9CmNvbnN0IG1lc2ggPSBuZXcgVEhSRUUuTWVzaChidWZmZXJHZW8sIG5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbChtYXRPcHRpb25zKSk7CmlmICh0ZXh0dXJlVG9BcHBseSkgewptZXNoLnVzZXJEYXRhLnRleHR1cmVOYW1lID0gdGV4dHVyZVRvQXBwbHk7Cn0KaWYgKGRhdGEubWF0ZXJpYWwuYmxlbmRNb2RlID09PSAnQWRkaXRpdmUnKSBtZXNoLnJlbmRlck9yZGVyID0gMTsgLy8gQmFzaWMgc29ydApncm91cC5hZGQobWVzaCk7Cn0pOwovLyBSZWNlbnRlciBwaXZvdCB0byBjZW50ZXIgb2YgYm91bmRpbmcgYm94Ci8vIFRoaXMgZW5zdXJlcyB0aGUgR2l6bW8gYXBwZWFycyBhdCB0aGUgdmlzdWFsIGNlbnRlciBvZiB0aGUgb2JqZWN0CmNvbnN0IGJveCA9IG5ldyBUSFJFRS5Cb3gzKCkuc2V0RnJvbU9iamVjdChncm91cCk7CmlmICghYm94LmlzRW1wdHkoKSkgewpjb25zdCBjZW50ZXIgPSBib3guZ2V0Q2VudGVyKG5ldyBUSFJFRS5WZWN0b3IzKCkpOwovLyAxLiBNb3ZlIGFsbCBnZW9tZXRyeSBzbyB0aGUgY2VudGVyIGJlY29tZXMgKDAsMCwwKSBsb2NhbGx5Cmdyb3VwLmNoaWxkcmVuLmZvckVhY2gobWVzaCA9PiB7CmlmIChtZXNoLmdlb21ldHJ5KSB7Cm1lc2guZ2VvbWV0cnkudHJhbnNsYXRlKC1jZW50ZXIueCwgLWNlbnRlci55LCAtY2VudGVyLnopOwp9Cn0pOwovLyAyLiBNb3ZlIHRoZSBncm91cCBjb250YWluZXIgdG8gdGhlIG9yaWdpbmFsIGNlbnRlciBsb2NhdGlvbgovLyBWaXN1YWwgcG9zaXRpb24gcmVtYWlucyB0aGUgc2FtZSBpbiB3b3JsZCBzcGFjZSwgYnV0IHBpdm90IGlzIG5vdyBjZW50ZXJlZApncm91cC5wb3NpdGlvbi5jb3B5KGNlbnRlcik7Cn0KdGhpcy5zY2VuZS5hZGQoZ3JvdXApOwp0aGlzLm1vZGVscy5zZXQoaWQsIGdyb3VwKTsKdGhpcy5jZW50ZXJNb2RlbCgpOwp9CnVubG9hZE1vZGVsKGlkKSB7CmNvbnN0IGdyb3VwID0gdGhpcy5tb2RlbHMuZ2V0KGlkKTsKaWYgKGdyb3VwKSB7Cmdyb3VwLmNoaWxkcmVuLmZvckVhY2gobWVzaCA9PiB7CmlmIChtZXNoLmdlb21ldHJ5KSBtZXNoLmdlb21ldHJ5LmRpc3Bvc2UoKTsKaWYgKG1lc2gubWF0ZXJpYWwpIG1lc2gubWF0ZXJpYWwuZGlzcG9zZSgpOwp9KTsKdGhpcy5zY2VuZS5yZW1vdmUoZ3JvdXApOwp0aGlzLm1vZGVscy5kZWxldGUoaWQpOwpsb2coYE1vZGVsIHVubG9hZGVkOiAke2lkfWAsICdpbmZvJyk7Cn0KfQpmbGlwVVYoaWQsIGF4aXMpIHsKY29uc3QgZ3JvdXAgPSB0aGlzLm1vZGVscy5nZXQoaWQpOwppZiAoZ3JvdXApIHsKZ3JvdXAudHJhdmVyc2UoY2hpbGQgPT4gewppZiAoY2hpbGQuaXNNZXNoICYmIGNoaWxkLmdlb21ldHJ5LmF0dHJpYnV0ZXMudXYpIHsKY29uc3QgdXYgPSBjaGlsZC5nZW9tZXRyeS5hdHRyaWJ1dGVzLnV2Owpmb3IgKGxldCBpID0gMDsgaSA8IHV2LmNvdW50OyBpKyspIHsKaWYgKGF4aXMgPT09ICd1Jykgewp1di5zZXRYKGksIDEuMCAtIHV2LmdldFgoaSkpOwp9IGVsc2Ugewp1di5zZXRZKGksIDEuMCAtIHV2LmdldFkoaSkpOwp9Cn0KdXYubmVlZHNVcGRhdGUgPSB0cnVlOwp9Cn0pOwpsb2coYEZsaXBwZWQgJHtheGlzLnRvVXBwZXJDYXNlKCl9IGZvciAke2lkfWAsICdpbmZvJyk7Cn0KfQp1bmxvYWRBbGwoKSB7CmNvbnN0IGtleXMgPSBBcnJheS5mcm9tKHRoaXMubW9kZWxzLmtleXMoKSk7CmtleXMuZm9yRWFjaChpZCA9PiB0aGlzLnVubG9hZE1vZGVsKGlkKSk7Cn0KY2VudGVyTW9kZWwoKSB7CmlmICh0aGlzLm1vZGVscy5zaXplID09PSAwKSB7CnRoaXMuY2FtZXJhLnBvc2l0aW9uLnNldCg1LCA1LCA1KTsKdGhpcy5jb250cm9scy50YXJnZXQuc2V0KDAsIDAsIDApOwp0aGlzLmNvbnRyb2xzLnVwZGF0ZSgpOwpsb2coIkNhbWVyYSByZXNldCB0byBkZWZhdWx0IHZpZXciLCAiaW5mbyIpOwpyZXR1cm47Cn0KY29uc3QgYm94ID0gbmV3IFRIUkVFLkJveDMoKTsKdGhpcy5tb2RlbHMuZm9yRWFjaChncm91cCA9PiBib3guZXhwYW5kQnlPYmplY3QoZ3JvdXApKTsKY29uc3QgY2VudGVyID0gYm94LmdldENlbnRlcihuZXcgVEhSRUUuVmVjdG9yMygpKTsKY29uc3Qgc2l6ZSA9IGJveC5nZXRTaXplKG5ldyBUSFJFRS5WZWN0b3IzKCkpOwovLyBDYWxjdWxhdGUgdGhlIGNhbWVyYSBkaXN0YW5jZSBiYXNlZCBvbiBib3VuZGluZyBib3ggc2l6ZQpjb25zdCBtYXhEaW0gPSBNYXRoLm1heChzaXplLngsIHNpemUueSwgc2l6ZS56KTsKY29uc3QgZm92ID0gdGhpcy5jYW1lcmEuZm92ICogKE1hdGguUEkgLyAxODApOwpsZXQgY2FtZXJhWiA9IE1hdGguYWJzKG1heERpbSAvIDIgLyBNYXRoLnRhbihmb3YgLyAyKSk7CmNhbWVyYVogKj0gMS41OyAvLyBab29tIG91dCBhIGJpdAppZiAoY2FtZXJhWiA9PT0gMCkgY2FtZXJhWiA9IDEwOyAvLyBGYWxsYmFjawovLyBQb3NpdGlvbiBjYW1lcmEgdG8gbG9vayBhdCBjZW50ZXIKdGhpcy5jYW1lcmEucG9zaXRpb24uc2V0KGNlbnRlci54ICsgY2FtZXJhWiwgY2VudGVyLnkgKyBjYW1lcmFaLCBjZW50ZXIueiArIGNhbWVyYVopOwp0aGlzLmNhbWVyYS5sb29rQXQoY2VudGVyKTsKLy8gVXBkYXRlIGNvbnRyb2xzIHRhcmdldCB0byBvcmJpdCBhcm91bmQgdGhlIG1vZGVsIGNlbnRlcgp0aGlzLmNvbnRyb2xzLnRhcmdldC5jb3B5KGNlbnRlcik7CnRoaXMuY29udHJvbHMudXBkYXRlKCk7CmxvZygiQ2FtZXJhIHJlc2V0IHRvIG1vZGVsIGNlbnRlciIsICJpbmZvIik7Cn0KLy8gLS0tIEdpem1vIE1ldGhvZHMgLS0tCmF0dGFjaEdpem1vKG9iamVjdCkgewppZiAob2JqZWN0KSB7CnRoaXMudHJhbnNmb3JtQ29udHJvbC5hdHRhY2gob2JqZWN0KTsKbG9nKGBHaXptbyBhdHRhY2hlZCB0bzogJHtvYmplY3QudXNlckRhdGEubmFtZSB8fCAnTW9kZWwnfWAsICdpbmZvJyk7Cn0gZWxzZSB7CnRoaXMuZGV0YWNoR2l6bW8oKTsKfQp9CmRldGFjaEdpem1vKCkgewp0aGlzLnRyYW5zZm9ybUNvbnRyb2wuZGV0YWNoKCk7Cn0Kc2V0R2l6bW9Nb2RlKG1vZGUpIHsKdGhpcy50cmFuc2Zvcm1Db250cm9sLnNldE1vZGUobW9kZSk7CmxvZyhgR2l6bW8gbW9kZTogJHttb2RlfWAsICdpbmZvJyk7Cn0Kc2V0R2l6bW9TcGFjZShzcGFjZSkgewp0aGlzLnRyYW5zZm9ybUNvbnRyb2wuc2V0U3BhY2Uoc3BhY2UpOyAvLyAnd29ybGQnIG9yICdsb2NhbCcKbG9nKGBHaXptbyBzcGFjZTogJHtzcGFjZX1gLCAnaW5mbycpOwp9Ci8vIC0tLSBNdWx0aS1TZWxlY3Rpb24gJiBHcm91cGluZyAtLS0KLy8gQ2xlYXIgY3VycmVudCBzZWxlY3Rpb246IHNwZWNpZmljIGhlbHBlciB0byBkZXRhY2ggb2JqZWN0cyBmcm9tIHRlbXAgZ3JvdXAgYmFjayB0byBzY2VuZQpjbGVhclNlbGVjdGlvbigpIHsKdGhpcy5kZXRhY2hHaXptbygpOwp0aGlzLnNlbGVjdGVkT2JqZWN0cyA9IFtdOwppZiAoIXRoaXMuc2VsZWN0aW9uR3JvdXApIHJldHVybjsKLy8gMS4gTW92ZSBjaGlsZHJlbiBiYWNrIHRvIFNjZW5lIChwcmVzZXJ2aW5nIHdvcmxkIHRyYW5zZm9ybXMpCi8vIFdlIGl0ZXJhdGUgYmFja3dhcmRzIG9yIHVzZSBhIHdoaWxlIGxvb3AgYmVjYXVzZSBjaGlsZHJlbiBhcnJheSBjaGFuZ2VzIG9uIGF0dGFjaApjb25zdCBjaGlsZHJlbiA9IFsuLi50aGlzLnNlbGVjdGlvbkdyb3VwLmNoaWxkcmVuXTsgLy8gc25hcHNob3QKY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7CnRoaXMuc2NlbmUuYXR0YWNoKGNoaWxkKTsKfSk7Ci8vIDIuIFJlbW92ZSB0ZW1wIGdyb3VwCnRoaXMuc2NlbmUucmVtb3ZlKHRoaXMuc2VsZWN0aW9uR3JvdXApOwp0aGlzLnNlbGVjdGlvbkdyb3VwID0gbnVsbDsKfQp1cGRhdGVTZWxlY3Rpb25Hcm91cChvYmplY3RzKSB7Ci8vIElmIHdlIGFscmVhZHkgaGF2ZSBhIGdyb3VwLCBkaXNiYW5kIGl0IGZpcnN0IHRvIHJlc2V0CnRoaXMuY2xlYXJTZWxlY3Rpb24oKTsKaWYgKG9iamVjdHMubGVuZ3RoID09PSAwKSByZXR1cm47CnRoaXMuc2VsZWN0ZWRPYmplY3RzID0gb2JqZWN0czsKaWYgKG9iamVjdHMubGVuZ3RoID09PSAxKSB7Ci8vIFNpbmdsZSBvYmplY3Q6IHNpbXBsZSBhdHRhY2gKdGhpcy5hdHRhY2hHaXptbyhvYmplY3RzWzBdKTsKcmV0dXJuOwp9Ci8vIE11bHRpcGxlIG9iamVjdHM6IENyZWF0ZSBtZWRpYW4gZ3JvdXAKdGhpcy5zZWxlY3Rpb25Hcm91cCA9IG5ldyBUSFJFRS5Hcm91cCgpOwp0aGlzLnNjZW5lLmFkZCh0aGlzLnNlbGVjdGlvbkdyb3VwKTsKLy8gMS4gQ2FsY3VsYXRlIE1lZGlhbiBQb2ludCAoQ2VudGVyIG9mIGFsbCBib3VuZGluZyBib3hlcykKY29uc3QgY29tYmluZWRCb3ggPSBuZXcgVEhSRUUuQm94MygpOwpvYmplY3RzLmZvckVhY2gob2JqID0+IHsKY29uc3QgYm94ID0gbmV3IFRIUkVFLkJveDMoKS5zZXRGcm9tT2JqZWN0KG9iaik7CmlmICghYm94LmlzRW1wdHkoKSkgY29tYmluZWRCb3gudW5pb24oYm94KTsKfSk7CmNvbnN0IGNlbnRlciA9IGNvbWJpbmVkQm94LmdldENlbnRlcihuZXcgVEhSRUUuVmVjdG9yMygpKTsKLy8gMi4gUG9zaXRpb24gZ3JvdXAgYXQgbWVkaWFuIGNlbnRlcgp0aGlzLnNlbGVjdGlvbkdyb3VwLnBvc2l0aW9uLmNvcHkoY2VudGVyKTsKLy8gMy4gQXR0YWNoIGFsbCBvYmplY3RzIHRvIHRoaXMgZ3JvdXAgKHByZXNlcnZlcyB3b3JsZCB0cmFuc2Zvcm0pCm9iamVjdHMuZm9yRWFjaChvYmogPT4gewp0aGlzLnNlbGVjdGlvbkdyb3VwLmF0dGFjaChvYmopOwp9KTsKLy8gNC4gQXR0YWNoIEdpem1vIHRvIGdyb3VwCnRoaXMuYXR0YWNoR2l6bW8odGhpcy5zZWxlY3Rpb25Hcm91cCk7CnRoaXMuc2VsZWN0aW9uR3JvdXAudXNlckRhdGEubmFtZSA9ICJTZWxlY3Rpb24gR3JvdXAiOwp9Ci8vIFJheWNhc3QgU2luZ2xlIChIZWxwZXIpIHJldHVybnMgdGhlIG1vZGVsIGdyb3VwCnJheWNhc3QobW91c2UpIHsKY29uc3QgcmF5Y2FzdGVyID0gbmV3IFRIUkVFLlJheWNhc3RlcigpOwpyYXljYXN0ZXIuc2V0RnJvbUNhbWVyYShtb3VzZSwgdGhpcy5jYW1lcmEpOwpjb25zdCBpbnRlcnNlY3RhYmxlUGFyYW1zID0gW107CnRoaXMubW9kZWxzLmZvckVhY2goZ3JvdXAgPT4gaW50ZXJzZWN0YWJsZVBhcmFtcy5wdXNoKGdyb3VwKSk7CmNvbnN0IGludGVyc2VjdHMgPSByYXljYXN0ZXIuaW50ZXJzZWN0T2JqZWN0cyhpbnRlcnNlY3RhYmxlUGFyYW1zLCB0cnVlKTsKaWYgKGludGVyc2VjdHMubGVuZ3RoID4gMCkgewpsZXQgc2VsZWN0ZWQgPSBpbnRlcnNlY3RzWzBdLm9iamVjdDsKLy8gRmluZCBwYXJlbnQgZ3JvdXAgbW9kZWwKd2hpbGUgKHNlbGVjdGVkLnBhcmVudCAmJiBzZWxlY3RlZC5wYXJlbnQudHlwZSAhPT0gJ1NjZW5lJykgewppZiAodGhpcy5tb2RlbHMuaGFzKHNlbGVjdGVkLnBhcmVudC51dWlkKSB8fCBBcnJheS5mcm9tKHRoaXMubW9kZWxzLnZhbHVlcygpKS5pbmNsdWRlcyhzZWxlY3RlZC5wYXJlbnQpKSB7CnJldHVybiBzZWxlY3RlZC5wYXJlbnQ7Cn0Kc2VsZWN0ZWQgPSBzZWxlY3RlZC5wYXJlbnQ7Cn0KfQpyZXR1cm4gbnVsbDsKfQovLyBTZWxlY3Qgb2JqZWN0IGJ5IG1vdXNlIGNsaWNrIChSYXljYXN0aW5nKQpzZWxlY3RPYmplY3QobW91c2UsIHdpZHRoLCBoZWlnaHQpIHsKY29uc3QgcmF5Y2FzdGVyID0gbmV3IFRIUkVFLlJheWNhc3RlcigpOwpyYXljYXN0ZXIuc2V0RnJvbUNhbWVyYShtb3VzZSwgdGhpcy5jYW1lcmEpOwpjb25zdCBpbnRlcnNlY3RhYmxlUGFyYW1zID0gW107CnRoaXMubW9kZWxzLmZvckVhY2goZ3JvdXAgPT4gaW50ZXJzZWN0YWJsZVBhcmFtcy5wdXNoKGdyb3VwKSk7CmNvbnN0IGludGVyc2VjdHMgPSByYXljYXN0ZXIuaW50ZXJzZWN0T2JqZWN0cyhpbnRlcnNlY3RhYmxlUGFyYW1zLCB0cnVlKTsKaWYgKGludGVyc2VjdHMubGVuZ3RoID4gMCkgewovLyBGaW5kIHRoZSB0b3AtbGV2ZWwgZ3JvdXAgKHdoaWNoIHJlcHJlc2VudHMgdGhlIG1vZGVsKQpsZXQgc2VsZWN0ZWQgPSBpbnRlcnNlY3RzWzBdLm9iamVjdDsKd2hpbGUgKHNlbGVjdGVkLnBhcmVudCAmJiBzZWxlY3RlZC5wYXJlbnQudHlwZSAhPT0gJ1NjZW5lJykgewppZiAodGhpcy5tb2RlbHMuaGFzKHNlbGVjdGVkLnBhcmVudC51dWlkKSB8fCBBcnJheS5mcm9tKHRoaXMubW9kZWxzLnZhbHVlcygpKS5pbmNsdWRlcyhzZWxlY3RlZC5wYXJlbnQpKSB7CnNlbGVjdGVkID0gc2VsZWN0ZWQucGFyZW50OwpicmVhazsKfQpzZWxlY3RlZCA9IHNlbGVjdGVkLnBhcmVudDsKfQovLyBJZiB3ZSBmb3VuZCBhIGdyb3VwIHRoYXQgaXMgaW4gb3VyIG1vZGVscyBtYXAKcmV0dXJuIHNlbGVjdGVkOwp9CnJldHVybiBudWxsOwp9Cn0KLy8gLS0tIEFwcCBDb21wb25lbnQgLS0tCmNsYXNzIEFwcCB7CmNvbnN0cnVjdG9yKCkgewp0aGlzLnZpZXdlciA9IG5ldyBWaWV3ZXIoJ3ZpZXdlci1jYW52YXMnKTsKdGhpcy5wYXJzZXIgPSBuZXcgQjNEUGFyc2VyKCk7CnRoaXMubG9hZGVkTW9kZWxzID0gbmV3IE1hcCgpOyAvLyBJRCAtPiBJbmZvCnRoaXMuZWxlbWVudHMgPSB7Cm92ZXJsYXk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1aS1vdmVybGF5JyksCmZpbGVJbnB1dDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGUtaW5wdXQnKSwKZm9sZGVySW5wdXQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXItaW5wdXQnKSwKbG9hZGluZzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmctb3ZlcmxheScpLAptZXNoTGlzdDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lc2gtbGlzdCcpLAptZXNoSXRlbXM6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZXNoLWl0ZW1zJyksCnVubG9hZEFsbEJ0bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VubG9hZC1hbGwnKSwKcmVzZXRDYW1lcmFCdG46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXNldC1jYW0nKSwKdG9nZ2xlTGlzdEJ0bjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1saXN0LWJ0bicpLAppbmZvQnRuOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5mby1idG4nKSwKaW5mb01vZGFsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5mby1tb2RhbCcpLApjbG9zZUluZm9CdG46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9zZS1pbmZvJyksCi8vIFRyYW5zZm9ybSBVSQp0cmFuc2Zvcm1Ub29sYmFyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHJhbnNmb3JtLXRvb2xiYXInKSwKYnRuVHJhbnNsYXRlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHJhbnNsYXRlLWJ0bicpLApidG5Sb3RhdGU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb3RhdGUtYnRuJyksCmJ0blNjYWxlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NhbGUtYnRuJyksCmJ0bkJveFNlbGVjdDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JveC1zZWxlY3QtYnRuJyksCnNwYWNlVG9nZ2xlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9jYWwtc3BhY2UtdG9nZ2xlJyksCi8vIE1vYmlsZSBVSQpvYmplY3RDb29yZHM6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvYmplY3QtY29vcmRzJyksCm1vYmlsZVRyYW5zZm9ybVVJOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9iaWxlLXRyYW5zZm9ybS11aScpLApzbGlkZXJYOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2xpZGVyLXgnKSwKc2xpZGVyWTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NsaWRlci15JyksCnNsaWRlclo6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzbGlkZXIteicpLApzZWxlY3Rpb25Cb3g6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxlY3Rpb24tYm94JykKfTsKdGhpcy5ib3hTZWxlY3RNb2RlID0gZmFsc2U7CnRoaXMuaW5pdCgpOwp9CmluaXQoKSB7Ci8vIEluaXRpYWxpemUgTG9jYWxpemF0aW9uCmkxOG4gPSBuZXcgSTE4bigpOwppMThuLmFwcGx5KCk7Ci8vIE1lc2ggTGlzdCBUb2dnbGUgKE1vYmlsZSkKaWYgKHRoaXMuZWxlbWVudHMudG9nZ2xlTGlzdEJ0bikgewp0aGlzLmVsZW1lbnRzLnRvZ2dsZUxpc3RCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewovLyBTdG9wIHByb3BhZ2F0aW9uIHNvIGNsaWNraW5nIHRoZSBidXR0b24gZG9lc24ndCB0cmlnZ2VyIGRvY3VtZW50IGNsaWNrIChpZiB3ZSBhZGQgb3V0c2lkZSBjbGljayBjbG9zZSkKZS5zdG9wUHJvcGFnYXRpb24oKTsKdGhpcy5lbGVtZW50cy5tZXNoTGlzdC5jbGFzc0xpc3QudG9nZ2xlKCdleHBhbmRlZCcpOwp9KTsKLy8gQ2xvc2UgbWVudSB3aGVuIGNsaWNraW5nIG91dHNpZGUKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewppZiAod2luZG93LmlubmVyV2lkdGggPD0gNzY4ICYmCnRoaXMuZWxlbWVudHMubWVzaExpc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdleHBhbmRlZCcpICYmCiF0aGlzLmVsZW1lbnRzLm1lc2hMaXN0LmNvbnRhaW5zKGUudGFyZ2V0KSkgewp0aGlzLmVsZW1lbnRzLm1lc2hMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ2V4cGFuZGVkJyk7Cn0KfSk7Cn0KLy8gSW5kaXZpZHVhbCBGaWxlcwp0aGlzLmVsZW1lbnRzLmZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gdGhpcy5oYW5kbGVGaWxlcyhBcnJheS5mcm9tKGUudGFyZ2V0LmZpbGVzKSkpOwovLyBGb2xkZXIgSW5wdXQKaWYgKHRoaXMuZWxlbWVudHMuZm9sZGVySW5wdXQpIHsKdGhpcy5lbGVtZW50cy5mb2xkZXJJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gdGhpcy5oYW5kbGVGaWxlcyhBcnJheS5mcm9tKGUudGFyZ2V0LmZpbGVzKSkpOwp9Ci8vIFVubG9hZCBBbGwKaWYgKHRoaXMuZWxlbWVudHMudW5sb2FkQWxsQnRuKSB7CnRoaXMuZWxlbWVudHMudW5sb2FkQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewp0aGlzLnZpZXdlci51bmxvYWRBbGwoKTsKdGhpcy5sb2FkZWRNb2RlbHMuY2xlYXIoKTsKdGhpcy51cGRhdGVNZXNoTGlzdCgpOwp0aGlzLmVsZW1lbnRzLm1lc2hMaXN0LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwp0aGlzLmVsZW1lbnRzLm92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7Cn0pOwp9Ci8vIEJveCBTZWxlY3QgVG9nZ2xlCmlmICh0aGlzLmVsZW1lbnRzLmJ0bkJveFNlbGVjdCkgewp0aGlzLmVsZW1lbnRzLmJ0bkJveFNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKdGhpcy5ib3hTZWxlY3RNb2RlID0gIXRoaXMuYm94U2VsZWN0TW9kZTsKdGhpcy5lbGVtZW50cy5idG5Cb3hTZWxlY3QuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgdGhpcy5ib3hTZWxlY3RNb2RlKTsKbG9nKGBCb3ggU2VsZWN0aW9uIE1vZGU6ICR7dGhpcy5ib3hTZWxlY3RNb2RlID8gJ0VOQUJMRUQnIDogJ0RJU0FCTEVEJ31gLCAnaW5mbycpOwovLyBJZiBleGl0aW5nIGJveCBzZWxlY3QsIGVuc3VyZSBjb250cm9scyBhcmUgYmFjayBvbgppZiAoIXRoaXMuYm94U2VsZWN0TW9kZSkgewp0aGlzLnZpZXdlci5jb250cm9scy5lbmFibGVkID0gdHJ1ZTsKfQp9KTsKfQovLyBSZXNldCBDYW1lcmEKaWYgKHRoaXMuZWxlbWVudHMucmVzZXRDYW1lcmFCdG4pIHsKdGhpcy5lbGVtZW50cy5yZXNldENhbWVyYUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7CmUucHJldmVudERlZmF1bHQoKTsKbG9nKCJSZXNldCBDYW1lcmEgdHJpZ2dlcmVkIiwgImluZm8iKTsKdGhpcy52aWV3ZXIuY2VudGVyTW9kZWwoKTsKfSk7Cn0KLy8gSW5mbyBNb2RhbAppZiAodGhpcy5lbGVtZW50cy5pbmZvQnRuICYmIHRoaXMuZWxlbWVudHMuaW5mb01vZGFsICYmIHRoaXMuZWxlbWVudHMuY2xvc2VJbmZvQnRuKSB7CnRoaXMuZWxlbWVudHMuaW5mb0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7CmUuc3RvcFByb3BhZ2F0aW9uKCk7CnRoaXMuZWxlbWVudHMuaW5mb01vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwp9KTsKdGhpcy5lbGVtZW50cy5jbG9zZUluZm9CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CnRoaXMuZWxlbWVudHMuaW5mb01vZGFsLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwp9KTsKLy8gQ2xpY2sgb3V0c2lkZSB0byBjbG9zZQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7CmlmICghdGhpcy5lbGVtZW50cy5pbmZvTW9kYWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSAmJgohdGhpcy5lbGVtZW50cy5pbmZvTW9kYWwuY29udGFpbnMoZS50YXJnZXQpICYmCmUudGFyZ2V0ICE9PSB0aGlzLmVsZW1lbnRzLmluZm9CdG4gJiYKIXRoaXMuZWxlbWVudHMuaW5mb0J0bi5jb250YWlucyhlLnRhcmdldCkpIHsKdGhpcy5lbGVtZW50cy5pbmZvTW9kYWwuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7Cn0KfSk7Cn0KLy8gLS0tIFRyYW5zZm9ybSBHaXptbyBJbnRlcmFjdGlvbnMgLS0tCmxldCBpc0RyYWdnaW5nR2l6bW8gPSBmYWxzZTsKaWYgKHRoaXMudmlld2VyLnRyYW5zZm9ybUNvbnRyb2wpIHsKdGhpcy52aWV3ZXIudHJhbnNmb3JtQ29udHJvbC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZ2luZy1jaGFuZ2VkJywgKGV2ZW50KSA9PiB7CmlzRHJhZ2dpbmdHaXptbyA9IGV2ZW50LnZhbHVlOwp9KTsKfQovLyBTZWxlY3Rpb24gU3RhdGUKbGV0IGlzU2VsZWN0aW5nID0gZmFsc2U7CmxldCBzZWxlY3RTdGFydCA9IHsgeDogMCwgeTogMCB9OwovLyBDYW52YXMgQ2xpY2sgZm9yIFNlbGVjdGlvbgp0aGlzLnZpZXdlci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGUpID0+IHsKdGhpcy5tb3VzZURvd25UaW1lID0gRGF0ZS5ub3coKTsKdGhpcy5tb3VzZURvd25Qb3MgPSB7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH07CmlmICh0aGlzLmJveFNlbGVjdE1vZGUgJiYgIWlzRHJhZ2dpbmdHaXptbykgewppc1NlbGVjdGluZyA9IHRydWU7CnNlbGVjdFN0YXJ0ID0geyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9Owp0aGlzLnZpZXdlci5jb250cm9scy5lbmFibGVkID0gZmFsc2U7Ci8vIFNob3cgYm94CmlmICh0aGlzLmVsZW1lbnRzLnNlbGVjdGlvbkJveCkgewp0aGlzLmVsZW1lbnRzLnNlbGVjdGlvbkJveC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKdGhpcy5lbGVtZW50cy5zZWxlY3Rpb25Cb3guc3R5bGUubGVmdCA9IGAke2UuY2xpZW50WH1weGA7CnRoaXMuZWxlbWVudHMuc2VsZWN0aW9uQm94LnN0eWxlLnRvcCA9IGAke2UuY2xpZW50WX1weGA7CnRoaXMuZWxlbWVudHMuc2VsZWN0aW9uQm94LnN0eWxlLndpZHRoID0gJzBweCc7CnRoaXMuZWxlbWVudHMuc2VsZWN0aW9uQm94LnN0eWxlLmhlaWdodCA9ICcwcHgnOwp9Cn0KfSk7CnRoaXMudmlld2VyLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCAoZSkgPT4gewppZiAoaXNTZWxlY3RpbmcgJiYgdGhpcy5lbGVtZW50cy5zZWxlY3Rpb25Cb3gpIHsKY29uc3QgY3VycmVudFggPSBlLmNsaWVudFg7CmNvbnN0IGN1cnJlbnRZID0gZS5jbGllbnRZOwpjb25zdCBsZWZ0ID0gTWF0aC5taW4oc2VsZWN0U3RhcnQueCwgY3VycmVudFgpOwpjb25zdCB0b3AgPSBNYXRoLm1pbihzZWxlY3RTdGFydC55LCBjdXJyZW50WSk7CmNvbnN0IHdpZHRoID0gTWF0aC5hYnMoY3VycmVudFggLSBzZWxlY3RTdGFydC54KTsKY29uc3QgaGVpZ2h0ID0gTWF0aC5hYnMoY3VycmVudFkgLSBzZWxlY3RTdGFydC55KTsKdGhpcy5lbGVtZW50cy5zZWxlY3Rpb25Cb3guc3R5bGUubGVmdCA9IGAke2xlZnR9cHhgOwp0aGlzLmVsZW1lbnRzLnNlbGVjdGlvbkJveC5zdHlsZS50b3AgPSBgJHt0b3B9cHhgOwp0aGlzLmVsZW1lbnRzLnNlbGVjdGlvbkJveC5zdHlsZS53aWR0aCA9IGAke3dpZHRofXB4YDsKdGhpcy5lbGVtZW50cy5zZWxlY3Rpb25Cb3guc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0fXB4YDsKfQp9KTsKdGhpcy52aWV3ZXIuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoZSkgPT4gewppZiAoaXNTZWxlY3RpbmcpIHsKaXNTZWxlY3RpbmcgPSBmYWxzZTsKaWYgKHRoaXMuZWxlbWVudHMuc2VsZWN0aW9uQm94KSB7CnRoaXMuZWxlbWVudHMuc2VsZWN0aW9uQm94LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwp9CmNvbnN0IHNlbGVjdEVuZCA9IHsgeDogZS5jbGllbnRYLCB5OiBlLmNsaWVudFkgfTsKY29uc3QgZGlzdCA9IE1hdGguc3FydChNYXRoLnBvdyhzZWxlY3RFbmQueCAtIHNlbGVjdFN0YXJ0LngsIDIpICsgTWF0aC5wb3coc2VsZWN0RW5kLnkgLSBzZWxlY3RTdGFydC55LCAyKSk7CmlmIChkaXN0ID4gNSkgewp0aGlzLnBlcmZvcm1Cb3hTZWxlY3Rpb24oc2VsZWN0U3RhcnQsIHNlbGVjdEVuZCk7Cn0KdGhpcy52aWV3ZXIuY29udHJvbHMuZW5hYmxlZCA9IHRydWU7CnJldHVybjsKfQovLyBPbmx5IHNlbGVjdCBpZiBpdCB3YXMgYSBjbGljaywgbm90IGEgZHJhZwppZiAoaXNEcmFnZ2luZ0dpem1vKSByZXR1cm47CmNvbnN0IHRpbWVEaWZmID0gRGF0ZS5ub3coKSAtIHRoaXMubW91c2VEb3duVGltZTsKY29uc3QgZGlzdERpZmYgPSBNYXRoLnNxcnQoTWF0aC5wb3coZS5jbGllbnRYIC0gdGhpcy5tb3VzZURvd25Qb3MueCwgMikgKyBNYXRoLnBvdyhlLmNsaWVudFkgLSB0aGlzLm1vdXNlRG93blBvcy55LCAyKSk7CmlmICh0aW1lRGlmZiA8IDIwMCAmJiBkaXN0RGlmZiA8IDUpIHsKY29uc3QgcmVjdCA9IHRoaXMudmlld2VyLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKY29uc3QgbW91c2UgPSBuZXcgVEhSRUUuVmVjdG9yMigKKChlLmNsaWVudFggLSByZWN0LmxlZnQpIC8gcmVjdC53aWR0aCkgKiAyIC0gMSwKLSgoZS5jbGllbnRZIC0gcmVjdC50b3ApIC8gcmVjdC5oZWlnaHQpICogMiArIDEKKTsKY29uc3Qgc2VsZWN0ZWQgPSB0aGlzLnZpZXdlci5zZWxlY3RPYmplY3QobW91c2UpOwp0aGlzLnVwZGF0ZVNlbGVjdGlvblVJKHNlbGVjdGVkID8gW3NlbGVjdGVkXSA6IFtdKTsKfQp9KTsKLy8gVG9vbGJhciBCdXR0b25zCmNvbnN0IHVwZGF0ZUFjdGl2ZUJ0biA9IChhY3RpdmVJZCkgPT4gewpbdGhpcy5lbGVtZW50cy5idG5UcmFuc2xhdGUsIHRoaXMuZWxlbWVudHMuYnRuUm90YXRlLCB0aGlzLmVsZW1lbnRzLmJ0blNjYWxlXS5mb3JFYWNoKGJ0biA9PiB7CmlmIChidG4pIGJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKfSk7CmlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhY3RpdmVJZCkpIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGFjdGl2ZUlkKS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKfTsKaWYgKHRoaXMuZWxlbWVudHMuYnRuVHJhbnNsYXRlKSB7CnRoaXMuZWxlbWVudHMuYnRuVHJhbnNsYXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewp0aGlzLnZpZXdlci5zZXRHaXptb01vZGUoJ3RyYW5zbGF0ZScpOwp1cGRhdGVBY3RpdmVCdG4oJ3RyYW5zbGF0ZS1idG4nKTsKfSk7Cn0KaWYgKHRoaXMuZWxlbWVudHMuYnRuUm90YXRlKSB7CnRoaXMuZWxlbWVudHMuYnRuUm90YXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewp0aGlzLnZpZXdlci5zZXRHaXptb01vZGUoJ3JvdGF0ZScpOwp1cGRhdGVBY3RpdmVCdG4oJ3JvdGF0ZS1idG4nKTsKfSk7Cn0KaWYgKHRoaXMuZWxlbWVudHMuYnRuU2NhbGUpIHsKdGhpcy5lbGVtZW50cy5idG5TY2FsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKdGhpcy52aWV3ZXIuc2V0R2l6bW9Nb2RlKCdzY2FsZScpOwp1cGRhdGVBY3RpdmVCdG4oJ3NjYWxlLWJ0bicpOwp9KTsKfQppZiAodGhpcy5lbGVtZW50cy5zcGFjZVRvZ2dsZSkgewp0aGlzLmVsZW1lbnRzLnNwYWNlVG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7CnRoaXMudmlld2VyLnNldEdpem1vU3BhY2UoZS50YXJnZXQuY2hlY2tlZCA/ICdsb2NhbCcgOiAnd29ybGQnKTsKfSk7Cn0KLy8gT2JqZWN0IENvb3JkIFN5bmMKaWYgKHRoaXMudmlld2VyLnRyYW5zZm9ybUNvbnRyb2wpIHsKdGhpcy52aWV3ZXIudHJhbnNmb3JtQ29udHJvbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB0aGlzLnVwZGF0ZU9iamVjdENvb3JkcygpKTsKfQovLyAtLS0gVW5kbyBTeXN0ZW0gLS0tCnRoaXMuaGlzdG9yeSA9IFtdOwp0aGlzLm1heEhpc3RvcnkgPSA1MDsKLy8gQ2FwdHVyZSBzdGF0ZSBvbiBEcmFnIFN0YXJ0CmxldCBkcmFnU3RhcnRTdGF0ZSA9IG51bGw7CmlmICh0aGlzLnZpZXdlci50cmFuc2Zvcm1Db250cm9sKSB7CnRoaXMudmlld2VyLnRyYW5zZm9ybUNvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2dpbmctY2hhbmdlZCcsIChldmVudCkgPT4gewpjb25zdCBpc0RyYWdnaW5nID0gZXZlbnQudmFsdWU7CmlmIChpc0RyYWdnaW5nKSB7CmNvbnN0IG9iaiA9IHRoaXMudmlld2VyLnRyYW5zZm9ybUNvbnRyb2wub2JqZWN0OwppZiAob2JqKSB7CmRyYWdTdGFydFN0YXRlID0gewppZDogb2JqLnV1aWQsCnBvc2l0aW9uOiBvYmoucG9zaXRpb24uY2xvbmUoKSwKcm90YXRpb246IG9iai5yb3RhdGlvbi5jbG9uZSgpLApzY2FsZTogb2JqLnNjYWxlLmNsb25lKCkKfTsKfQp9IGVsc2UgaWYgKGRyYWdTdGFydFN0YXRlKSB7Ci8vIERyYWcgRW5kOiBQdXNoIHByZXZpb3VzIHN0YXRlIHRvIGhpc3RvcnkKdGhpcy5wdXNoSGlzdG9yeShkcmFnU3RhcnRTdGF0ZSk7CmRyYWdTdGFydFN0YXRlID0gbnVsbDsKfQp9KTsKfQovLyBNb2JpbGUgU2xpZGVyIExvZ2ljCnRoaXMuaW5pdE1vYmlsZVNsaWRlcnMoKTsKLy8gS2V5Ym9hcmQgU2hvcnRjdXRzCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4gewovLyBVbmRvIChDdHJsK1opCmlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5rZXkudG9Mb3dlckNhc2UoKSA9PT0gJ3onKSB7CmUucHJldmVudERlZmF1bHQoKTsKdGhpcy51bmRvKCk7CnJldHVybjsKfQovLyBJZ25vcmUgaWYgdHlwaW5nIGluIGlucHV0CmlmIChbJ0lOUFVUJywgJ1RFWFRBUkVBJ10uaW5jbHVkZXMoZG9jdW1lbnQuYWN0aXZlRWxlbWVudC50YWdOYW1lKSkgcmV0dXJuOwpzd2l0Y2ggKGUua2V5LnRvTG93ZXJDYXNlKCkpIHsKY2FzZSAnZyc6IC8vIEdyYWIgLyBNb3ZlCnRoaXMudmlld2VyLnNldEdpem1vTW9kZSgndHJhbnNsYXRlJyk7CnVwZGF0ZUFjdGl2ZUJ0bigndHJhbnNsYXRlLWJ0bicpOwpicmVhazsKY2FzZSAncic6IC8vIFJvdGF0ZQp0aGlzLnZpZXdlci5zZXRHaXptb01vZGUoJ3JvdGF0ZScpOwp1cGRhdGVBY3RpdmVCdG4oJ3JvdGF0ZS1idG4nKTsKYnJlYWs7CmNhc2UgJ3MnOiAvLyBTY2FsZQp0aGlzLnZpZXdlci5zZXRHaXptb01vZGUoJ3NjYWxlJyk7CnVwZGF0ZUFjdGl2ZUJ0bignc2NhbGUtYnRuJyk7CmJyZWFrOwpjYXNlICdiJzogLy8gQm94IFNlbGVjdAppZiAodGhpcy5lbGVtZW50cy5idG5Cb3hTZWxlY3QpIHRoaXMuZWxlbWVudHMuYnRuQm94U2VsZWN0LmNsaWNrKCk7CmJyZWFrOwpjYXNlICdlc2NhcGUnOiAvLyBEZXNlbGVjdAp0aGlzLnZpZXdlci5kZXRhY2hHaXptbygpOwp0aGlzLnZpZXdlci5jbGVhclNlbGVjdGlvbigpOwp0aGlzLnVwZGF0ZVNlbGVjdGlvblVJKFtdKTsKLy8gRXhpdCBib3ggc2VsZWN0IG1vZGUgaWYgYWN0aXZlCmlmICh0aGlzLmJveFNlbGVjdE1vZGUpIHsKdGhpcy5ib3hTZWxlY3RNb2RlID0gZmFsc2U7CmlmICh0aGlzLmVsZW1lbnRzLmJ0bkJveFNlbGVjdCkgdGhpcy5lbGVtZW50cy5idG5Cb3hTZWxlY3QuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7CnRoaXMudmlld2VyLmNvbnRyb2xzLmVuYWJsZWQgPSB0cnVlOwp9CmJyZWFrOwp9Cn0pOwpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIChlKSA9PiBlLnByZXZlbnREZWZhdWx0KCkpOwpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgYXN5bmMgKGUpID0+IHsKZS5wcmV2ZW50RGVmYXVsdCgpOwpjb25zdCBpdGVtcyA9IGUuZGF0YVRyYW5zZmVyLml0ZW1zOwppZiAoaXRlbXMgJiYgaXRlbXMubGVuZ3RoID4gMCAmJiBpdGVtc1swXS53ZWJraXRHZXRBc0VudHJ5KSB7Ci8vIE1vZGVybiBEaXJlY3RvcnkgU2Nhbm5pbmcKY29uc3QgZW50cmllcyA9IFtdOwpmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7CmVudHJpZXMucHVzaChpdGVtc1tpXS53ZWJraXRHZXRBc0VudHJ5KCkpOwp9CmNvbnN0IGZpbGVzID0gYXdhaXQgdGhpcy5zY2FuRW50cmllcyhlbnRyaWVzKTsKdGhpcy5oYW5kbGVGaWxlcyhmaWxlcyk7Cn0gZWxzZSB7Ci8vIEZhbGxiYWNrIC8gU3RhbmRhcmQKdGhpcy5oYW5kbGVGaWxlcyhBcnJheS5mcm9tKGUuZGF0YVRyYW5zZmVyLmZpbGVzKSk7Cn0KfSk7Cn0KYXN5bmMgc2NhbkVudHJpZXMoZW50cmllcykgewpjb25zdCBmaWxlcyA9IFtdOwpjb25zdCBzY2FuID0gYXN5bmMgKGVudHJ5KSA9PiB7CmlmIChlbnRyeS5pc0ZpbGUpIHsKcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gZW50cnkuZmlsZShmaWxlID0+IHsKZmlsZXMucHVzaChmaWxlKTsKcmVzb2x2ZSgpOwp9KSk7Cn0gZWxzZSBpZiAoZW50cnkuaXNEaXJlY3RvcnkpIHsKY29uc3QgcmVhZGVyID0gZW50cnkuY3JlYXRlUmVhZGVyKCk7CmNvbnN0IHJlYWRFbnRyaWVzID0gYXN5bmMgKCkgPT4gewpjb25zdCBzdWJFbnRyaWVzID0gYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiByZWFkZXIucmVhZEVudHJpZXMocmVzb2x2ZSkpOwppZiAoc3ViRW50cmllcy5sZW5ndGggPiAwKSB7CmF3YWl0IFByb21pc2UuYWxsKHN1YkVudHJpZXMubWFwKHNjYW4pKTsKYXdhaXQgcmVhZEVudHJpZXMoKTsgLy8gQ29udGludWUgcmVhZGluZyAocmVhZEVudHJpZXMgcmV0dXJucyBpbiBjaHVua3MpCn0KfTsKYXdhaXQgcmVhZEVudHJpZXMoKTsKfQp9Owphd2FpdCBQcm9taXNlLmFsbChlbnRyaWVzLm1hcChzY2FuKSk7CnJldHVybiBmaWxlczsKfQphc3luYyBoYW5kbGVGaWxlcyhmaWxlcykgewppZiAoIWZpbGVzIHx8IGZpbGVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwpsb2coYFJlY2VpdmVkICR7ZmlsZXMubGVuZ3RofSBmaWxlczogJHtmaWxlcy5tYXAoZiA9PiBmLm5hbWUpLmpvaW4oJywgJyl9YCwgJ2luZm8nKTsKY29uc3QgbWVzaEZpbGVzID0gZmlsZXMuZmlsdGVyKGYgPT4gZi5uYW1lLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoJy5jc3YnKSB8fCBmLm5hbWUudG9Mb3dlckNhc2UoKS5lbmRzV2l0aCgnLmIzZCcpKTsKY29uc3QgaW1hZ2VGaWxlcyA9IGZpbGVzLmZpbHRlcihmID0+IGYubmFtZS5tYXRjaCgvXC4ocG5nfGpwZ3xqcGVnfGJtcHxnaWYpJC9pKSk7CmlmIChpbWFnZUZpbGVzLmxlbmd0aCA+IDApIHsKZm9yIChjb25zdCBmaWxlIG9mIGltYWdlRmlsZXMpIHsKY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKdGhpcy52aWV3ZXIuYWRkVGV4dHVyZShmaWxlLm5hbWUsIHVybCk7Cn0KfQpmb3IgKGNvbnN0IG1lc2hGaWxlIG9mIG1lc2hGaWxlcykgewpsb2coYExvYWRpbmc6ICR7bWVzaEZpbGUubmFtZX1gLCAnaW5mbycpOwp0aGlzLmVsZW1lbnRzLmxvYWRpbmcuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CmNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CnJlYWRlci5vbmxvYWQgPSAoZSkgPT4gewp0cnkgewpjb25zdCBtZXNoRGF0YSA9IHRoaXMucGFyc2VyLnBhcnNlKGUudGFyZ2V0LnJlc3VsdCwgbWVzaEZpbGUubmFtZS50b0xvd2VyQ2FzZSgpLmVuZHNXaXRoKCcuYjNkJykpOwpjb25zdCBpZCA9ICdtZXNoXycgKyBEYXRlLm5vdygpICsgJ18nICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMCk7CmxldCB2ZXJ0cyA9IDA7Cm1lc2hEYXRhLmZvckVhY2gobSA9PiB2ZXJ0cyArPSBtLnZlcnRpY2VzLmxlbmd0aCAvIDMpOwp0aGlzLnZpZXdlci5sb2FkTW9kZWwoaWQsIG1lc2hEYXRhKTsKY29uc3QgdXZDb3VudCA9IG1lc2hEYXRhLnJlZHVjZSgoYWNjLCBtKSA9PiBhY2MgKyAobS51dnMgPyBtLnV2cy5sZW5ndGggLyAyIDogMCksIDApOwp0aGlzLmxvYWRlZE1vZGVscy5zZXQoaWQsIHsgbmFtZTogbWVzaEZpbGUubmFtZSwgdmVydGljZXM6IHZlcnRzLCBmYWNlczogTWF0aC5yb3VuZCh2ZXJ0cyAvIDMpLCB1dnM6IHV2Q291bnQgfSk7CnRoaXMudXBkYXRlTWVzaExpc3QoKTsKbG9nKGBQYXJzZWQ6ICR7dmVydHN9IHZlcnRzLCAke3V2Q291bnR9IFVWcyBQb2ludGAsICdpbmZvJyk7CnRoaXMuZWxlbWVudHMub3ZlcmxheS5jbGFzc0xpc3QuYWRkKCdsb2FkZWQnKTsKfSBjYXRjaCAoZXJyKSB7IGxvZygnRXJyb3I6ICcgKyBlcnIubWVzc2FnZSwgJ2Vycm9yJyk7IH0KdGhpcy5lbGVtZW50cy5sb2FkaW5nLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwp9OwpyZWFkZXIucmVhZEFzVGV4dChtZXNoRmlsZSk7Cn0KfQp1cGRhdGVPYmplY3RDb29yZHMoKSB7CmlmICghdGhpcy5lbGVtZW50cy5vYmplY3RDb29yZHMpIHJldHVybjsKY29uc3Qgb2JqID0gdGhpcy52aWV3ZXIudHJhbnNmb3JtQ29udHJvbC5vYmplY3Q7CmlmIChvYmopIHsKdGhpcy5lbGVtZW50cy5vYmplY3RDb29yZHMuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CmNvbnN0IHBvcyA9IG9iai5wb3NpdGlvbjsKLy8gU2hvcnRlbiBudW1iZXJzCmNvbnN0IGYgPSAobikgPT4gbi50b0ZpeGVkKDIpOwp0aGlzLmVsZW1lbnRzLm9iamVjdENvb3Jkcy50ZXh0Q29udGVudCA9IGBPYmo6ICR7Zihwb3MueCl9LCAke2YocG9zLnkpfSwgJHtmKHBvcy56KX1gOwp9IGVsc2Ugewp0aGlzLmVsZW1lbnRzLm9iamVjdENvb3Jkcy5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKfQp9CmluaXRNb2JpbGVTbGlkZXJzKCkgewpjb25zdCBzbGlkZXJzID0gWwp7IGVsOiB0aGlzLmVsZW1lbnRzLnNsaWRlclgsIGF4aXM6ICd4JyB9LAp7IGVsOiB0aGlzLmVsZW1lbnRzLnNsaWRlclksIGF4aXM6ICd5JyB9LAp7IGVsOiB0aGlzLmVsZW1lbnRzLnNsaWRlclosIGF4aXM6ICd6JyB9Cl07CnNsaWRlcnMuZm9yRWFjaChzID0+IHsKaWYgKCFzLmVsKSByZXR1cm47Ci8vIFJlc2V0IG9uIHJlbGVhc2UKY29uc3QgcmVzZXQgPSAoKSA9PiB7IHMuZWwudmFsdWUgPSAwOyB9OwpzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHJlc2V0KTsKcy5lbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHJlc2V0KTsKcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgcmVzZXQpOwovLyBDb250aW51b3VzIHVwZGF0ZQpzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGUpID0+IHsKY29uc3QgdmFsID0gcGFyc2VGbG9hdChlLnRhcmdldC52YWx1ZSk7Ci8vIERlYWR6b25lCmlmIChNYXRoLmFicyh2YWwpIDwgMC41KSByZXR1cm47CmNvbnN0IG9iaiA9IHRoaXMudmlld2VyLnRyYW5zZm9ybUNvbnRyb2wub2JqZWN0OwppZiAoIW9iaikgcmV0dXJuOwpjb25zdCBtb2RlID0gdGhpcy52aWV3ZXIudHJhbnNmb3JtQ29udHJvbC5nZXRNb2RlKCk7CmNvbnN0IHNlbnNpdGl2aXR5ID0gbW9kZSA9PT0gJ3JvdGF0ZScgPyAwLjA1IDogKG1vZGUgPT09ICdzY2FsZScgPyAwLjAyIDogMC4wNSk7Ci8vIFNjYWxlIGZhY3RvciBmb3IgUG9zaXRpb24gZGVwZW5kcyBvbiBjYW1lcmEgZGlzdGFuY2UgdXN1YWxseSwgYnV0IGZpeGVkIGlzIGZpbmUgZm9yIG5vdwpjb25zdCBkZWx0YSA9IHZhbCAqIHNlbnNpdGl2aXR5OyAvLyBWYWx1ZSBpcyAtNTAgdG8gNTAKaWYgKG1vZGUgPT09ICd0cmFuc2xhdGUnKSB7Ci8vIFNpbXBsZSBsb2NhbCB0cmFuc2xhdGlvbiBoYWNrCi8vIENvcnJlY3Qgd2F5IGlzIHRvIGNoZWNrIHNwYWNlLCBidXQgbGV0J3MganVzdCBtb2RpZnkgcHJvcGVydHkgZm9yIHNpbXBsaWNpdHkKLy8gVGhyZWUuanMgVHJhbnNmb3JtQ29udHJvbHMgdXN1YWxseSB3b3JrcyBpbiBXb3JsZCBvciBMb2NhbC4KLy8gSWYgd2UgbW9kaWZ5IC5wb3NpdGlvbiBkaXJlY3RseSwgdGhhdCBpcyBMb2NhbCAocmVsYXRpdmUgdG8gcGFyZW50KS4Kb2JqLnBvc2l0aW9uW3MuYXhpc10gKz0gZGVsdGEgKiAwLjE7Cn0gZWxzZSBpZiAobW9kZSA9PT0gJ3JvdGF0ZScpIHsKb2JqLnJvdGF0aW9uW3MuYXhpc10gKz0gZGVsdGEgKiAwLjE7Cn0gZWxzZSBpZiAobW9kZSA9PT0gJ3NjYWxlJykgewpvYmouc2NhbGVbcy5heGlzXSArPSBkZWx0YSAqIDAuMDE7Cn0KdGhpcy51cGRhdGVPYmplY3RDb29yZHMoKTsKfSk7Cn0pOwp9CnVwZGF0ZU1lc2hMaXN0KCkgewp0aGlzLmVsZW1lbnRzLm1lc2hJdGVtcy5pbm5lckhUTUwgPSAnJzsKaWYgKHRoaXMubG9hZGVkTW9kZWxzLnNpemUgPiAwKSB7CnRoaXMuZWxlbWVudHMubWVzaExpc3QuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CnRoaXMubG9hZGVkTW9kZWxzLmZvckVhY2goKGluZm8sIGlkKSA9PiB7CmNvbnN0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKaXRlbS5jbGFzc05hbWUgPSAnbWVzaC1pdGVtJzsKaXRlbS5pbm5lckhUTUwgPSBgCjxkaXYgY2xhc3M9Im1lc2gtaXRlbS1oZWFkZXIiPgo8c3BhbiBjbGFzcz0ibWVzaC1pdGVtLW5hbWUiPiR7aW5mby5uYW1lfTwvc3Bhbj4KPGJ1dHRvbiBjbGFzcz0idW5sb2FkLWJ0biIgZGF0YS1pZD0iJHtpZH0iPlVOTE9BRDwvYnV0dG9uPgo8L2Rpdj4KPGRpdiBjbGFzcz0ibWVzaC1jb250cm9scyI+CjxidXR0b24gY2xhc3M9InRleHQtYnRuIGZsaXAtdS1idG4iIGRhdGEtaWQ9IiR7aWR9Ij5GTElQIFU8L2J1dHRvbj4KPGJ1dHRvbiBjbGFzcz0idGV4dC1idG4gZmxpcC12LWJ0biIgZGF0YS1pZD0iJHtpZH0iPkZMSVAgVjwvYnV0dG9uPgo8L2Rpdj4KPGRpdiBjbGFzcz0ibWVzaC1pdGVtLXN0YXRzIj4KPHNwYW4+VjogJHtpbmZvLnZlcnRpY2VzLnRvTG9jYWxlU3RyaW5nKCl9PC9zcGFuPgo8c3Bhbj5GOiAke2luZm8uZmFjZXMudG9Mb2NhbGVTdHJpbmcoKX08L3NwYW4+CjxzcGFuPlVWOiAke2luZm8udXZzLnRvTG9jYWxlU3RyaW5nKCl9PC9zcGFuPgo8L2Rpdj4KYDsKaXRlbS5xdWVyeVNlbGVjdG9yKCcudW5sb2FkLWJ0bicpLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnVubG9hZE1vZGVsKGlkKTsKaXRlbS5xdWVyeVNlbGVjdG9yKCcuZmxpcC11LWJ0bicpLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnZpZXdlci5mbGlwVVYoaWQsICd1Jyk7Cml0ZW0ucXVlcnlTZWxlY3RvcignLmZsaXAtdi1idG4nKS5vbmNsaWNrID0gKCkgPT4gdGhpcy52aWV3ZXIuZmxpcFVWKGlkLCAndicpOwovLyBDYWNoZSBET00gcmVmZXJlbmNlIGZvciBPKDEpIHNlbGVjdGlvbiBoaWdobGlnaHRpbmcKaW5mby5lbGVtZW50ID0gaXRlbTsKdGhpcy5lbGVtZW50cy5tZXNoSXRlbXMuYXBwZW5kQ2hpbGQoaXRlbSk7Cn0pOwp9IGVsc2Ugewp0aGlzLmVsZW1lbnRzLm1lc2hMaXN0LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwp0aGlzLmVsZW1lbnRzLm92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7Cn0KfQp1cGRhdGVTZWxlY3Rpb25VSShzZWxlY3RlZE9iamVjdHMpIHsKdGhpcy52aWV3ZXIudXBkYXRlU2VsZWN0aW9uR3JvdXAoc2VsZWN0ZWRPYmplY3RzKTsKY29uc3QgaGFzU2VsZWN0aW9uID0gc2VsZWN0ZWRPYmplY3RzLmxlbmd0aCA+IDA7CmlmIChoYXNTZWxlY3Rpb24pIHsKdGhpcy5lbGVtZW50cy50cmFuc2Zvcm1Ub29sYmFyLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwppZiAodGhpcy5lbGVtZW50cy5tb2JpbGVUcmFuc2Zvcm1VSSkgdGhpcy5lbGVtZW50cy5tb2JpbGVUcmFuc2Zvcm1VSS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKfSBlbHNlIHsKdGhpcy5lbGVtZW50cy50cmFuc2Zvcm1Ub29sYmFyLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwppZiAodGhpcy5lbGVtZW50cy5tb2JpbGVUcmFuc2Zvcm1VSSkgdGhpcy5lbGVtZW50cy5tb2JpbGVUcmFuc2Zvcm1VSS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKfQovLyBPcHRpbWl6ZWQ6IFVzZSBjYWNoZWQgZWxlbWVudHMgYW5kIFNldCBmb3IgTygxKSBsb29rdXAKY29uc3Qgc2VsZWN0ZWRTZXQgPSBuZXcgU2V0KHNlbGVjdGVkT2JqZWN0cyk7CnRoaXMubG9hZGVkTW9kZWxzLmZvckVhY2goKGluZm8sIGlkKSA9PiB7CmlmIChpbmZvLmVsZW1lbnQpIHsKY29uc3QgaXNTZWxlY3RlZCA9IHNlbGVjdGVkU2V0Lmhhcyh0aGlzLnZpZXdlci5tb2RlbHMuZ2V0KGlkKSk7CmluZm8uZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdzZWxlY3RlZCcsIGlzU2VsZWN0ZWQpOwp9Cn0pOwp0aGlzLnVwZGF0ZU9iamVjdENvb3JkcygpOwp9CnBlcmZvcm1Cb3hTZWxlY3Rpb24oc3RhcnQsIGVuZCkgewpjb25zdCBtaW5YID0gTWF0aC5taW4oc3RhcnQueCwgZW5kLngpOwpjb25zdCBtYXhYID0gTWF0aC5tYXgoc3RhcnQueCwgZW5kLngpOwpjb25zdCBtaW5ZID0gTWF0aC5taW4oc3RhcnQueSwgZW5kLnkpOwpjb25zdCBtYXhZID0gTWF0aC5tYXgoc3RhcnQueSwgZW5kLnkpOwpjb25zdCBuZXdTZWxlY3Rpb24gPSBbXTsKY29uc3QgcmVjdCA9IHRoaXMudmlld2VyLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKdGhpcy52aWV3ZXIubW9kZWxzLmZvckVhY2gobW9kZWwgPT4gewpjb25zdCBib3ggPSBuZXcgVEhSRUUuQm94MygpLnNldEZyb21PYmplY3QobW9kZWwpOwpjb25zdCBjZW50ZXIgPSBib3guZ2V0Q2VudGVyKG5ldyBUSFJFRS5WZWN0b3IzKCkpOwpjZW50ZXIucHJvamVjdCh0aGlzLnZpZXdlci5jYW1lcmEpOwpjb25zdCBzY3JlZW5YID0gKGNlbnRlci54ICogMC41ICsgMC41KSAqIHJlY3Qud2lkdGggKyByZWN0LmxlZnQ7CmNvbnN0IHNjcmVlblkgPSAoLShjZW50ZXIueSAqIDAuNSkgKyAwLjUpICogcmVjdC5oZWlnaHQgKyByZWN0LnRvcDsKaWYgKHNjcmVlblggPj0gbWluWCAmJiBzY3JlZW5YIDw9IG1heFggJiYgc2NyZWVuWSA+PSBtaW5ZICYmIHNjcmVlblkgPD0gbWF4WSkgewpuZXdTZWxlY3Rpb24ucHVzaChtb2RlbCk7Cn0KfSk7CmNvbnN0IGN1cnJlbnRTZWxlY3Rpb24gPSB0aGlzLnZpZXdlci5zZWxlY3RlZE9iamVjdHMgfHwgW107CmNvbnN0IGNvbWJpbmVkID0gbmV3IFNldChbLi4uY3VycmVudFNlbGVjdGlvbiwgLi4ubmV3U2VsZWN0aW9uXSk7CnRoaXMudXBkYXRlU2VsZWN0aW9uVUkoQXJyYXkuZnJvbShjb21iaW5lZCkpOwp9CnB1c2hIaXN0b3J5KHN0YXRlKSB7CmlmICghc3RhdGUpIHJldHVybjsKdGhpcy5oaXN0b3J5LnB1c2goc3RhdGUpOwppZiAodGhpcy5oaXN0b3J5Lmxlbmd0aCA+IHRoaXMubWF4SGlzdG9yeSkgdGhpcy5oaXN0b3J5LnNoaWZ0KCk7CmxvZygnQWN0aW9uIHNhdmVkIHRvIGhpc3RvcnknLCAnZGVidWcnKTsKfQp1bmRvKCkgewppZiAodGhpcy5oaXN0b3J5Lmxlbmd0aCA9PT0gMCkgewpsb2coJ05vdGhpbmcgdG8gdW5kbycsICdpbmZvJyk7CnJldHVybjsKfQpjb25zdCBzdGF0ZSA9IHRoaXMuaGlzdG9yeS5wb3AoKTsKLy8gRmluZCBvYmplY3QgKHdlIG5lZWQgdG8gc2VhcmNoIGluIHZpZXdlcidzIG1vZGVscykKbGV0IGZvdW5kT2JqID0gbnVsbDsKdGhpcy52aWV3ZXIubW9kZWxzLmZvckVhY2gobW9kZWwgPT4gewppZiAobW9kZWwudXVpZCA9PT0gc3RhdGUuaWQpIGZvdW5kT2JqID0gbW9kZWw7Ci8vIEFsc28gY2hlY2sgY2hpbGRyZW4gaWYgbmVlZGVkLCBidXQgb3VyIElEIGxvZ2ljIHRpZXMgdG8gdGhlIGdyb3VwCn0pOwovLyBUaGUgc3RvcmVkIElEIGlzIGZyb20gdGhlIFRyYW5zZm9ybUNvbnRyb2wub2JqZWN0LCB3aGljaCBtYXRjaGVzIHdoYXQgd2Ugc2VsZWN0ZWQKLy8gSW4gb3VyIHNlbGVjdGlvbiBsb2dpYywgd2UgdHJhdmVyc2UgdXAgdG8gdGhlIEdyb3VwLCBzbyBVVUlEIHNob3VsZCBtYXRjaCB0aGUgR3JvdXAgVVVJRAovLyBVTkxFU1MgdGhlIHRyYW5zZm9ybSB3YXMgYXR0YWNoZWQgdG8gYSBtZXNoIGluc2lkZS4KLy8gTGV0J3MgdmVyaWZ5IHNlbGVjdGlvbiBsb2dpYzogaXQgYXR0YWNoZXMgdG8gJ3NlbGVjdGVkJywgd2hpY2ggaXMgdGhlIHBhcmVudCBncm91cCB1c3VhbGx5LgovLyBCdXQgdG8gYmUgc2FmZSwgd2UgY2FuIHRyeSB0byBmaW5kIG9iamVjdCBieSBVVUlEIGluIHRoZSBzY2VuZQppZiAoIWZvdW5kT2JqKSB7CmZvdW5kT2JqID0gdGhpcy52aWV3ZXIuc2NlbmUuZ2V0T2JqZWN0QnlQcm9wZXJ0eSgndXVpZCcsIHN0YXRlLmlkKTsKfQppZiAoZm91bmRPYmopIHsKZm91bmRPYmoucG9zaXRpb24uY29weShzdGF0ZS5wb3NpdGlvbik7CmZvdW5kT2JqLnJvdGF0aW9uLmNvcHkoc3RhdGUucm90YXRpb24pOwpmb3VuZE9iai5zY2FsZS5jb3B5KHN0YXRlLnNjYWxlKTsKLy8gSWYgY3VycmVudGx5IHNlbGVjdGVkLCB1cGRhdGUgZ2l6bW8gdmlzdWFsIGltbWVkaWF0ZWx5ICh0aG91Z2ggaXQgc2hvdWxkIGF1dG8tdXBkYXRlKQovLyBBbmQgdXBkYXRlIGNvb3JkcyBVSQppZiAodGhpcy52aWV3ZXIudHJhbnNmb3JtQ29udHJvbC5vYmplY3QgPT09IGZvdW5kT2JqKSB7CnRoaXMudXBkYXRlT2JqZWN0Q29vcmRzKCk7Cn0KbG9nKCdVbmRvIHBlcmZvcm1lZCcsICdpbmZvJyk7Cn0gZWxzZSB7CmxvZygnVW5kbyBmYWlsZWQ6IE9iamVjdCBub3QgZm91bmQnLCAnZXJyb3InKTsKfQp9CnVubG9hZE1vZGVsKGlkKSB7CnRoaXMudmlld2VyLnVubG9hZE1vZGVsKGlkKTsKdGhpcy5sb2FkZWRNb2RlbHMuZGVsZXRlKGlkKTsKdGhpcy51cGRhdGVNZXNoTGlzdCgpOwpsb2coaTE4biA/IGkxOG4uZ2V0KCdtb2RlbFVubG9hZGVkJywgeyBpZCB9KSA6IGBNb2RlbCB1bmxvYWRlZDogJHtpZH1gLCAnaW5mbycpOwp9Cn0KLy8gLS0tIExvY2FsaXphdGlvbiAtLS0KY29uc3QgdHJhbnNsYXRpb25zID0gewonZW4nOiB7CnN1YnRpdGxlOiAnQjNEICYgQ1NWIDNEIE1lc2ggUHJldmlldycsCmRyb3BUaXRsZTogJ0Ryb3AgLmIzZCAvIC5jc3YgZmlsZXMgaGVyZScsCmRyb3BTdWJ0aXRsZTogJ29yIGNsaWNrIHRvIGJyb3dzZSBmaWxlcycsCnNlbGVjdEZvbGRlcjogJ1NlbGVjdCBGb2xkZXInLApmb2xkZXJUb29sdGlwOiAnTG9hZCBlbnRpcmUgZm9sZGVyIChNZXNoICsgVGV4dHVyZXMpJywKbG9hZGVkTWVzaGVzOiAnTG9hZGVkIE1lc2hlcycsCnVubG9hZEFsbDogJ1VubG9hZCBBbGwnLApwYXJzaW5nOiAnUGFyc2luZyBNZXNoLi4uJywKbG9hZE1vcmU6ICdMb2FkIE1vcmUgRmlsZXMnLApyZXNldENhbWVyYTogJ1Jlc2V0IENhbWVyYScsCi8vIExvZyBNZXNzYWdlcwpyZWNlaXZlZEZpbGVzOiAnUmVjZWl2ZWQge259IGZpbGVzOiB7bGlzdH0nLApsb2FkaW5nOiAnTG9hZGluZzoge25hbWV9JywKd2FpdGluZ1RleHR1cmU6ICdXYWl0aW5nIGZvciB0ZXh0dXJlOiB7bmFtZX0gKERyYWcvRHJvcCB0aGlzIGZpbGUgdG8gbG9hZCknLAp0ZXh0dXJlTG9hZGVkOiAnVGV4dHVyZSBsb2FkZWQ6IHtuYW1lfScsCmxvYWRGYWlsZWQ6ICdGYWlsZWQgdG8gbG9hZCB0ZXh0dXJlIHtuYW1lfToge2Vycn0nLApwYXJzZWQ6ICdQYXJzZWQ6IHt2fSB2ZXJ0cywge3V2fSBVVnMnLAptb2RlbFVubG9hZGVkOiAnTW9kZWwgdW5sb2FkZWQ6IHtpZH0nLAplcnJvcjogJ0Vycm9yOiB7bXNnfScKfSwKJ2lkJzogewpzdWJ0aXRsZTogJ1ByYXRpbmphdSBNZXNoIDNEIEIzRCAmIENTVicsCmRyb3BUaXRsZTogJ1RhcmlrIGZpbGUgLmIzZCAvIC5jc3Yga2Ugc2luaScsCmRyb3BTdWJ0aXRsZTogJ2F0YXUga2xpayB1bnR1ayBqZWxhamFoaSBmaWxlJywKc2VsZWN0Rm9sZGVyOiAnUGlsaWggRm9sZGVyJywKZm9sZGVyVG9vbHRpcDogJ011YXQgc2VsdXJ1aCBmb2xkZXIgKE1lc2ggKyBUZWtzdHVyKScsCmxvYWRlZE1lc2hlczogJ01lc2ggRGltdWF0JywKdW5sb2FkQWxsOiAnQm9uZ2thciBTZW11YScsCnBhcnNpbmc6ICdNZW5ndXJhaSBNZXNoLi4uJywKbG9hZE1vcmU6ICdNdWF0IExlYmloIEJhbnlhayBGaWxlJywKcmVzZXRDYW1lcmE6ICdSZXNldCBLYW1lcmEnLAovLyBMb2cgTWVzc2FnZXMKcmVjZWl2ZWRGaWxlczogJ01lbmVyaW1hIHtufSBmaWxlOiB7bGlzdH0nLApsb2FkaW5nOiAnTWVtdWF0OiB7bmFtZX0nLAp3YWl0aW5nVGV4dHVyZTogJ01lbnVuZ2d1IHRla3N0dXI6IHtuYW1lfSAoVGFyaWsgZmlsZSBpbmkgdW50dWsgbWVtdWF0KScsCnRleHR1cmVMb2FkZWQ6ICdUZWtzdHVyIGRpbXVhdDoge25hbWV9JywKbG9hZEZhaWxlZDogJ0dhZ2FsIG1lbXVhdCB0ZWtzdHVyIHtuYW1lfToge2Vycn0nLApwYXJzZWQ6ICdEaXVyYWk6IHt2fSB2ZXJ0aWthbCwge3V2fSBVVicsCm1vZGVsVW5sb2FkZWQ6ICdNb2RlbCBkaWJvbmdrYXI6IHtpZH0nLAplcnJvcjogJ0tlc2FsYWhhbjoge21zZ30nCn0KfTsKY2xhc3MgSTE4biB7CmNvbnN0cnVjdG9yKCkgewovLyBEZXRlY3QgbGFuZ3VhZ2UgKGRlZmF1bHQgdG8gZW4pCmNvbnN0IHVzZXJMYW5nID0gbmF2aWdhdG9yLmxhbmd1YWdlIHx8IG5hdmlnYXRvci51c2VyTGFuZ3VhZ2U7CnRoaXMubGFuZyA9IHVzZXJMYW5nLnN0YXJ0c1dpdGgoJ2lkJykgPyAnaWQnIDogJ2VuJzsKdGhpcy50ID0gdHJhbnNsYXRpb25zW3RoaXMubGFuZ107CmxvZyhgTGFuZ3VhZ2UgZGV0ZWN0aW9uOiAke3VzZXJMYW5nfSAtPiB1c2luZyAke3RoaXMubGFuZ31gLCAnaW5mbycpOwp9CmFwcGx5KCkgewovLyBUZXh0IENvbnRlbnQKZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtaTE4bl0nKS5mb3JFYWNoKGVsID0+IHsKY29uc3Qga2V5ID0gZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWkxOG4nKTsKaWYgKHRoaXMudFtrZXldKSBlbC50ZXh0Q29udGVudCA9IHRoaXMudFtrZXldOwp9KTsKLy8gVG9vbHRpcHMKZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtaTE4bi10b29sdGlwXScpLmZvckVhY2goZWwgPT4gewpjb25zdCBrZXkgPSBlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaTE4bi10b29sdGlwJyk7CmlmICh0aGlzLnRba2V5XSkgZWwuc2V0QXR0cmlidXRlKCdkYXRhLXRvb2x0aXAnLCB0aGlzLnRba2V5XSk7Cn0pOwovLyBDU1MgVmFyaWFibGVzIChmb3IgcHNldWRvLWVsZW1lbnRzKQpkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tdGV4dC1sb2FkLW1vcmUnLCBgIiR7dGhpcy50LmxvYWRNb3JlfSJgKTsKfQpnZXQoa2V5LCByZXBsYWNlbWVudHMgPSB7fSkgewpsZXQgdGV4dCA9IHRoaXMudFtrZXldIHx8IGtleTsKZm9yIChjb25zdCBbaywgdl0gb2YgT2JqZWN0LmVudHJpZXMocmVwbGFjZW1lbnRzKSkgewp0ZXh0ID0gdGV4dC5yZXBsYWNlKGB7JHtrfX1gLCB2KTsKfQpyZXR1cm4gdGV4dDsKfQp9CmxldCBpMThuOwovLyAtLS0gSGVscGVyIEZ1bmN0aW9ucyAtLS0KdHJ5IHsKY29uc3QgYXBwID0gbmV3IEFwcCgpOwp3aW5kb3cuYXBwSW5zdGFuY2UgPSBhcHA7IC8vIEZvciBjb25zb2xlIGRlYnVnZ2luZwp9IGNhdGNoIChlKSB7CmNvbnNvbGUuZXJyb3IoIkNyaXRpY2FsIEFwcCBJbml0aWFsaXphdGlvbiBFcnJvcjoiLCBlKTsKLy8gVHJ5IHRvIGxvZyBpdCBpZiB0aGUgcGFyc2VyIGlzIGRlZmluZWQKaWYgKHR5cGVvZiBsb2cgPT09ICdmdW5jdGlvbicpIGxvZygiSW5pdGlhbGl6YXRpb24gRmFpbGVkOiAiICsgZS5tZXNzYWdlLCAnZXJyb3InKTsKfQ==");
        eval(scriptContent);
    })();
    </script>
</body>

</html>